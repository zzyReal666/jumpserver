(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-02bca322","chunk-52829884"],{"243c":function(e,t,a){"use strict";a("d3b7")},"3cc2":function(e,t,a){},"5ebc":function(e,t,a){"use strict";var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-form",{staticClass:"account-content",nativeOn:{submit:function(e){e.preventDefault()}}},[a("el-form-item",[a("el-radio-group",{on:{input:e.handleRadioChanged},model:{value:e.realRadioSelected,callback:function(t){e.realRadioSelected=t},expression:"realRadioSelected"}},e._l(e.realChoices,(function(t){return a("el-radio",{key:t.label,attrs:{disabled:t.disabled,label:t.value}},[e._v("\n        "+e._s(t.label)+"\n        "),t.tip?a("el-tooltip",{attrs:{content:t.tip,"open-delay":500,placement:"top"}},[a("i",{staticClass:"fa fa-question-circle-o"})]):e._e()],1)})),1),e._v(" "),e.showSpecZone?a("div",{staticClass:"spec-accounts spec-zone"},[a("div",{staticClass:"group-title"},[e._v(e._s(e.$t("SpecAccount")))]),e._v(" "),a("TagInput",{attrs:{autocomplete:e.autocomplete,"tag-type":e.getTagType},on:{change:e.handleTagChange},model:{value:e.specAccountsInput,callback:function(t){e.specAccountsInput=t},expression:"specAccountsInput"}}),e._v(" "),e.showAddTemplate?a("span",[a("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(t){e.showTemplateDialog=!0}}},[e._v("\n          "+e._s(e.$t("TemplateAdd"))+"\n        ")]),e._v(" "),a("span",{staticClass:"help-block"},[e._v("\n          "+e._s(e.addTemplateHelpText)+"\n        ")])],1):e._e()],1):e._e(),e._v(" "),e.enableVirtualAccount?a("div",{staticClass:"spec-zone virtual-choices"},[a("el-checkbox",{on:{change:e.handleVirtualChecked},model:{value:e.virtualChecked,callback:function(t){e.virtualChecked=t},expression:"virtualChecked"}},[e._v("\n        "+e._s(e.virtualAccount.label)+"\n      ")]),e._v(" "),e.virtualChecked?a("el-select",{attrs:{multiple:!0,placeholder:e.$t("SelectVirtualAccount")},on:{change:e.handleVirtualChecked},model:{value:e.virtualSelected,callback:function(t){e.virtualSelected=t},expression:"virtualSelected"}},e._l(e.virtualAccounts,(function(t){return a("el-option",{key:t.label,attrs:{label:t.label,value:t.value}},[e._v("\n          "+e._s(t.label)+"\n          "),a("el-tooltip",{attrs:{content:t.tip,"open-delay":500,placement:"top"}},[a("i",{staticClass:"fa fa-question-circle-o"})])],1)})),1):e._e()],1):e._e()],1),e._v(" "),e.showTemplateDialog?a("Dialog",{attrs:{title:e.$tc("AccountTemplate"),visible:e.showTemplateDialog},on:{"update:visible":function(t){e.showTemplateDialog=t},cancel:e.handleAccountTemplateCancel,confirm:e.handleAccountTemplateConfirm}},[a("ListTable",e._b({ref:"templateTable"},"ListTable",e.accountTemplateTable,!1))],1):e._e()],1)},s=[],i=a("75fc"),r=(a("f559"),a("6762"),a("2fdb"),a("57e7"),a("7618")),l=(a("6d67"),a("d25f"),a("f823")),o=a("992f"),c=a("af7d"),u=a("9039"),d={components:{TagInput:l["k"],ListTable:c["a"],Dialog:u["a"]},props:{value:{type:[Array,String],default:function(){return[]}},assets:{type:[Array],default:function(){return[]}},nodes:{type:[Array],default:function(){return[]}},oid:{type:String,default:""},showAddTemplate:{type:Boolean,default:!0},enableVirtualAccount:{type:Boolean,default:!0},addTemplateHelpText:{type:String,default:function(){return this.$t("TemplateHelpText")}}},data:function(){var e=this,t=this,a="@VIRTUAL";return{ALL:o["b"],SPEC:o["j"],VIRTUAL:a,EXCLUDE:o["h"],showTemplateDialog:!1,realRadioSelected:this.ALL,realChoices:o["m"],virtualChecked:!1,virtualSelected:[],output:[],excludeAccountsInput:[],virtualAccounts:o["o"],virtualAccountsNames:[o["f"],o["i"],o["c"]],specAccountsInput:[],specAccountsTemplate:[],showSpecZone:!1,getTagType:function(e){return t.specAccountsTemplate.filter((function(t){return t.username===e})).length>0?"primary":"info"},showExcludeZone:!1,accountTemplateTable:o["l"],autocomplete:function(a,n){var s={username:a,assets:e.assets.slice(0,20),nodes:e.nodes.slice(0,20).map((function(e){return"object"===Object(r["a"])(e)?e.pk:e}))};e.$axios.post("/api/v1/accounts/accounts/username-suggestions/",s,{params:{oid:e.oid}}).then((function(e){e||(e=[]);var a=e.filter((function(e){return-1===t.value.indexOf(e)})).map((function(e){return{value:e,label:e}}));n(a)}))}}},computed:{virtualAccount:function(){return o["n"]}},watch:{realRadioSelected:{handler:function(e){this.showSpecZone=e===this.SPEC,this.showExcludeZone=e===this.EXCLUDE},sync:!0}},mounted:function(){this.initDefaultChoice()},methods:{getVirtualChoices:function(e){return this.virtualAccounts.filter((function(t){return e.includes(t.value)})).map((function(e){return e.value}))},getExcludeChoices:function(e){return e.filter((function(e){return e.startsWith("!")})).map((function(e){return e.substring(1)}))},getSpecValues:function(e){return e.filter((function(e){return!e.startsWith("@")&&!e.startsWith("!")}))},initDefaultChoice:function(){var e=this.value||[],t=this.getSpecValues(e),a=e.includes(this.ALL);a?this.realRadioSelected=this.ALL:t.length>0||e.includes(this.SPEC)?(this.realRadioSelected=this.SPEC,this.specAccountsInput=t):this.realRadioSelected=o["g"];var n=this.getVirtualChoices(this.value);n.length>0&&(this.virtualChecked=!0,this.virtualSelected=n)},handleAccountTemplateCancel:function(){this.showTemplateDialog=!1},handleAccountTemplateConfirm:function(){var e=this;this.specAccountsTemplate=this.$refs.templateTable.selectedRows;var t=this.specAccountsTemplate.map((function(e){return e.username}));this.specAccountsInput=this.specAccountsInput.filter((function(e){return!t.includes(e)})).concat(t),this.outputValue(),setTimeout((function(){e.showTemplateDialog=!1,e.outputValue()}),100)},handleVirtualChecked:function(e,t){this.outputValue()},handleRadioChanged:function(e){this.outputValue()},handleTagChange:function(){this.outputValue()},outputValue:function(){var e=[];if(this.realRadioSelected===this.ALL)e=[this.ALL];else if(this.realRadioSelected===this.SPEC&&this.showSpecZone){var t=this.specAccountsTemplate.map((function(e){return"%".concat(e.id)}));e=[this.realRadioSelected].concat(Object(i["a"])(this.specAccountsInput),Object(i["a"])(t))}else this.realRadioSelected===o["g"]&&(e=[]);this.virtualChecked&&(e=[].concat(Object(i["a"])(e),Object(i["a"])(this.virtualSelected))),this.$log.debug("choicesSelected",e),this.$emit("input",e),this.$emit("change",e)}}},p=d,f=(a("243c"),a("2877")),h=Object(f["a"])(p,n,s,!1,null,"202e51b6",null);t["a"]=h.exports},"680d":function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("Page",e._b({attrs:{"help-tip":e.helpMsg}},"Page",e.$attrs,!1),[a("AssetTreeTable",{ref:"AssetTreeTable",attrs:{"header-actions":e.headerActions,"table-config":e.tableConfig,"tree-setting":e.treeSetting,"quick-filters":e.quickFilter,"create-drawer":e.createDrawer}}),e._v(" "),a("PermBulkUpdateDialog",e._b({attrs:{visible:e.updateSelectedDialogSetting.visible},on:{"update:visible":function(t){return e.$set(e.updateSelectedDialogSetting,"visible",t)},update:e.handlePermBulkUpdate}},"PermBulkUpdateDialog",e.updateSelectedDialogSetting,!1))],1)},s=[],i=(a("1c01"),a("58b2"),a("8e6e"),a("f3e2"),a("d25f"),a("ac6a"),a("456d"),a("bd86")),r=a("83b2"),l=a("ad09"),o=function(){var e=this,t=e.$createElement,a=e._self._c||t;return e.visible?a("GenericUpdateFormDialog",e._g({attrs:{"form-setting":e.formSetting,"selected-rows":e.selectedRows,visible:e.visible}},e.$listeners)):e._e()},c=[],u=(a("d92a"),a("cd4a")),d=(a("7f7f"),a("1307")),p=a("5ebc");function f(){var e={label:this.$t("Users"),hidden:function(){return!1},el:{value:[],ajax:{url:"/api/v1/users/users/?fields_size=mini",transformOption:function(e){return{label:e.name+"("+e.username+")",value:e.id}}}}},t={label:this.$t("UserGroups"),hidden:function(){return!1},el:{value:[],url:"/api/v1/users/groups/"}},a={type:"assetSelect",hidden:function(){return!1},component:d["a"],label:this.$t("Asset"),rules:[{required:!1}],el:{value:[]}},n={label:this.$t("Node"),hidden:function(){return!1},el:{value:[],ajax:{url:"/api/v1/assets/nodes/",transformOption:function(e){return{label:e.full_value,value:e.id}}}}},s={type:"input",label:this.$t("Account"),component:p["a"]},i={label:this.$t("DateStart"),hidden:function(){return!1}},r={label:this.$t("DateExpired"),hidden:function(){return!1}},l={label:this.$t("IsActive"),type:"checkbox"},o={label:this.$t("Applications"),hidden:function(){return!1},el:{value:[],ajax:{url:"/api/v1/applications/applications/",transformOption:function(e){return{label:e.name+" ("+e.type_display+")",value:e.id}}}}};return{users:e,user_groups:t,assets:a,applications:o,nodes:n,accounts:s,is_active:l,date_start:i,date_expired:r}}var h=f,m={name:"PermBulkUpdateDialog",components:{GenericUpdateFormDialog:u["h"]},props:{permType:{type:String,default:"asset"},visible:{type:Boolean,default:!1},selectedRows:{type:Array,default:function(){return[]}}},data:function(){return{formSetting:{url:"",hasSaveContinue:!1,initial:{},fields:[],fieldsMeta:{}}}},created:function(){this.init()},methods:{init:function(){var e,t=h.bind(this)(),a=["users","user_groups","accounts","actions","is_active","date_start","date_expired"],n={users:t.users,user_groups:t.user_groups,accounts:t.accounts,date_start:t.date_start,date_expired:t.date_expired,is_active:t.is_active,actions:{label:this.$t("Action")}};"asset"!==this.permType?(e="/api/v1/perms/application-permissions/",a.splice(2,0,"applications"),Object.assign(n,{applications:t.applications})):(e="/api/v1/perms/asset-permissions/",a.splice.apply(a,[2,0].concat(["assets","nodes"])),Object.assign(n,{assets:t.assets,nodes:t.nodes})),this.$data.formSetting.url=e,this.$data.formSetting.fields=a,this.$data.formSetting.fieldsMeta=n}}},b=m,v=a("2877"),g=Object(v["a"])(b,o,c,!1,null,"263d7d34",null),A=g.exports,_=a("2f62"),S=a("992f");function T(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function w(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?T(Object(a),!0).forEach((function(t){Object(i["a"])(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):T(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var y={components:{Page:r["a"],AssetTreeTable:l["a"],PermBulkUpdateDialog:A},data:function(){var e=this;return{createDrawer:function(){return a.e("chunk-22096c5e").then(a.bind(null,"2792"))},helpMsg:this.$t("AssetPermissionHelpMsg"),quickFilter:[{label:this.$t("QuickFilter"),options:[{label:this.$t("Invalid"),filter:{is_valid:!1}},{label:this.$t("Valid"),filter:{is_valid:!0}},{label:this.$t("Expired"),filter:{is_expired:!0}},{label:this.$t("Disabled"),filter:{is_active:!1}},{label:this.$t("NoResource"),filter:{is_no_resource:!0}}]}],treeSetting:{showMenu:!1,showAssets:!0,notShowBuiltinTree:!0,url:"/api/v1/perms/asset-permissions/",nodeUrl:"/api/v1/perms/asset-permissions/",treeUrl:"/api/v1/assets/nodes/children/tree/?assets=1&asset_amount=0",edit:{drag:{isMove:!1}}},tableConfig:{url:"/api/v1/perms/asset-permissions/",hasTree:!0,columnsExtra:["action"],columns:["name","users_amount","user_groups_amount","assets_amount","nodes_amount","accounts","labels","is_valid","is_expired","from_ticket","is_active","actions"],columnsShow:{min:["name","actions"],default:["name","users_amount","user_groups_amount","assets_amount","nodes_amount","accounts","is_valid","actions"]},columnsMeta:w(w({},S["e"]),{},{actions:{formatterArgs:{updateRoute:"AssetPermissionUpdate",performDelete:function(t){var a=t.row,n=(t.col,a.id),s="/api/v1/perms/asset-permissions/".concat(n,"/");return e.$axios.delete(s)}}}})},headerActions:{hasLabelSearch:!0,hasBulkDelete:!0,searchConfig:{url:"",options:S["d"]},hasBulkUpdate:!0,handleBulkUpdate:function(t){var a=t.selectedRows;e.updateSelectedDialogSetting.selectedRows=a,e.updateSelectedDialogSetting.visible=!0}},updateSelectedDialogSetting:{visible:!1,selectedRows:[]}}},computed:w({},Object(_["b"])(["currentOrgIsRoot"])),activated:function(){var e=this;setTimeout((function(){e.$refs.AssetTreeTable.$refs.TreeList.reloadTable()}),500)},methods:{handlePermBulkUpdate:function(){var e,t;this.updateSelectedDialogSetting.visible=!1,null===(e=this.$refs.AssetTreeTable.$refs.TreeList.$refs)||void 0===e||null===(t=e.ListTable)||void 0===t||t.reloadTable()}}},C=y,k=Object(v["a"])(C,n,s,!1,null,null,null);t["default"]=k.exports},7:function(e,t){},"992f":function(e,t,a){"use strict";a.d(t,"k",(function(){return l})),a.d(t,"e",(function(){return o})),a.d(t,"d",(function(){return c})),a.d(t,"b",(function(){return u})),a.d(t,"j",(function(){return d})),a.d(t,"h",(function(){return p})),a.d(t,"i",(function(){return f})),a.d(t,"f",(function(){return h})),a.d(t,"c",(function(){return m})),a.d(t,"g",(function(){return b})),a.d(t,"a",(function(){return v})),a.d(t,"n",(function(){return g})),a.d(t,"m",(function(){return A})),a.d(t,"o",(function(){return _})),a.d(t,"l",(function(){return S}));var n=a("bd86"),s=(a("a481"),a("6d67"),a("0692")),i=a("b318"),r=a("62f3"),l=[{label:s["a"].t("Name"),value:"name"},{label:s["a"].t("Username"),value:"username"},{label:s["a"].t("UserGroups"),value:"user_group"},{label:s["a"].t("AssetName"),value:"asset_name"},{label:s["a"].t("AssetAddress"),value:"address"},{label:s["a"].t("Account"),value:"accounts"},{label:s["a"].t("Valid"),value:"is_valid",children:[{value:"1",label:s["a"].t("Yes")},{value:"0",label:s["a"].t("No")}]},{label:s["a"].t("Effective"),value:"is_effective",children:[{value:"1",label:s["a"].t("Yes")},{value:"0",label:s["a"].t("No")}]},{label:s["a"].t("FromTicket"),value:"from_ticket",children:[{value:"1",label:s["a"].t("Yes")},{value:"0",label:s["a"].t("No")}]}],o={name:{formatter:r["a"],minWidth:"120px",formatterArgs:{route:"AssetPermissionDetail",drawer:!0,routeQuery:{tab:"Basic"}}},action:{label:s["a"].t("Action"),formatter:function(e){return 6===e.actions.length?s["a"].t("All"):e.actions.map((function(e){return e.label.replace(/ \([^)]*\)/,"")})).join(",")}},is_expired:{formatterArgs:{showFalse:!1}},from_ticket:{width:"130px",formatterArgs:{showFalse:!1}},users_amount:{width:80,formatter:i["a"],formatterArgs:{async:!0,route:"AssetPermissionDetail",drawer:!0,routeQuery:{tab:"AssetPermissionUser"}}},user_groups_amount:{width:80,formatter:i["a"],formatterArgs:{async:!0,drawer:!0,route:"AssetPermissionDetail",routeQuery:{tab:"AssetPermissionUser"}}},assets_amount:{width:80,formatter:i["a"],formatterArgs:{async:!0,drawer:!0,route:"AssetPermissionDetail",routeQuery:{tab:"AssetPermissionAsset"}}},nodes_amount:{width:80,formatter:i["a"],formatterArgs:{async:!0,drawer:!0,route:"AssetPermissionDetail",routeQuery:{tab:"AssetPermissionAsset"}}},accounts:{width:80,formatter:i["a"],formatterArgs:{cellValueToRemove:["@SPEC"],drawer:!0,getItem:function(e){if("@SPEC"!==e)return v[e]||e},route:"AssetPermissionDetail",routeQuery:{tab:"AssetPermissionAccount"}}},actions:{formatterArgs:{updateRoute:"AssetPermissionUpdate",cloneRoute:"AssetPermissionCreate",performDelete:function(e){var t=e.row,a=(e.col,t.id),n="/api/v1/perms/asset-permissions/".concat(a,"/");return this.$axios.delete(n)}}}},c=[].concat(l,[{label:s["a"].t("NodeSearchStrategy"),value:"all",children:[{value:"0",label:s["a"].t("OnlySearchCurrentNodePerm")},{value:"1",label:s["a"].t("SearchAncestorNodePerm")}]}]),u="@ALL",d="@SPEC",p="@NOT",f="@USER",h="@INPUT",m="@ANON",b="@NONE",v=Object(n["a"])(Object(n["a"])(Object(n["a"])(Object(n["a"])(Object(n["a"])(Object(n["a"])(Object(n["a"])({},u,s["a"].t("AllAccounts")),d,s["a"].t("SpecAccount")),p,s["a"].t("ExcludeAccount")),b,s["a"].t("None")),f,s["a"].t("SameAccount")),h,s["a"].t("ManualAccount")),m,s["a"].t("AnonymousAccount")),g={label:s["a"].t("VirtualAccounts"),value:"@VIRTUAL",tip:s["a"].t("VirtualAccountHelpMsg")},A=[{label:v[u],value:u,tip:s["a"].t("AllAccountTip")},{label:v[d],value:d,tip:s["a"].t("SpecAccountTip")},{label:v[b],value:b}],_=[{label:v[h],value:h,tip:s["a"].t("ManualAccountTip")},{label:v[f],value:f,tip:s["a"].t("SameAccountTip")},{label:v[m],value:m,tip:s["a"].t("AnonymousAccountTip")}],S={tableConfig:{url:"/api/v1/accounts/account-templates/",columns:["name","username","has_secret","comment","date_created","date_updated"],columnsMeta:{name:{formatterArgs:{openInNewPage:!0,getRoute:function(e){var t=e.row;e.col,e.cellValue;return{name:"AccountTemplateDetail",params:{id:t.id}}}}},has_secret:{formatterArgs:{showFalse:!1}},actions:{has:!1}}},headerActions:{hasLeftActions:!1,hasImport:!1,hasExport:!1}}},b708:function(e,t,a){},c0eb:function(e,t,a){"use strict";var n=a("c5ec"),s=a.n(n);window.$=s.a,window.jQuery=s.a,t["a"]=s.a},d3b7:function(e,t,a){}}]);