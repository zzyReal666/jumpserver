(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-62dd4c6e"],{"387d":function(e,t,a){"use strict";a.d(t,"c",(function(){return n})),a.d(t,"a",(function(){return s})),a.d(t,"b",(function(){return r}));a("7f7f");var l=a("f823"),n=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return{component:l["c"],el:{value:[],resource:e.$t("Users"),select2:{url:"/api/v1/users/users/",ajax:{transformOption:function(e){return{label:e.name+"("+e.username+")",value:e.id}}}},attrs:[{name:"name",label:e.$t("Name"),inTable:!0},{name:"username",label:e.$t("Username"),inTable:!0},{name:"email",label:e.$t("Email"),inTable:!0},{name:"comment",label:e.$t("Comment"),inTable:!0},{name:"is_active",label:e.$t("IsActive"),type:"bool"},{name:"is_first_login",label:e.$t("FirstLogin"),type:"bool"},{name:"system_roles",type:"m2m",label:e.$t("SystemRoles"),el:{url:"/api/v1/rbac/system-roles/?fields_size=mini",ajax:{transformOption:function(e){return{label:e.display_name,value:e.id}}},displayField:"display_name"}},{name:"org_roles",label:e.$t("OrgRoles"),type:"m2m",el:{url:"/api/v1/rbac/org-roles/",ajax:{transformOption:function(e){return{label:e.display_name,value:e.id}}},displayField:"display_name"},disabled:t},{name:"groups",label:e.$t("UserGroups"),type:"m2m",el:{url:"/api/v1/users/groups/?fields_size=mini"}},{name:"labels",label:e.$t("Tags"),type:"m2m",el:{multiple:!0,url:"/api/v1/assets/labels/",ajax:{transformOption:function(e){return{label:"".concat(e.name,":").concat(e.value),value:e.id}}}}}]}}},s={allUsers:3,onlyAdminUsers:4},r={notEnable:0,allUsers:1,onlyAdminUsers:2}},"4e46":function(e,t,a){"use strict";a.r(t);var l=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("GenericCreateUpdatePage",e._b({attrs:{initial:e.initial}},"GenericCreateUpdatePage",e.$data,!1))},n=[],s=a("cd4a"),r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",e._l(e.approveData,(function(t,l){return a("div",{key:l},[a("el-card",{staticClass:"box-card"},[a("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[a("span",[e._v(e._s(l+1+" "+e.$t("LevelApproval")))])]),e._v(" "),a("JSONManyToManySelect",{attrs:{value:t.users,resource:e.userComponentMeta.el.resource,select2:e.userComponentMeta.el.select2,attrs:e.userComponentMeta.el.attrs},on:{input:function(t){return e.handleInput(l,t)}}})],1)],1)})),0)},i=[],o=a("75fc"),u=(a("55dd"),a("c5f6"),a("f823")),c=a("387d"),p={components:{JSONManyToManySelect:u["c"]},props:{value:{type:[String,Array],default:function(){return[]}},level:{type:Number,default:1}},data:function(){return{userComponentMeta:Object(c["c"])(this),defaultRule:[{users:{type:"attrs",attrs:[{match:"m2m",name:"system_roles",value:["00000000-0000-0000-0000-000000000001"]}]}}],rules:[]}},computed:{approveData:function(){return this.getSortedRules()}},watch:{level:{handler:function(){this.updateApproveData()}}},mounted:function(){this.updateApproveData()},methods:{getSortedRules:function(){return Object(o["a"])(this.rules).sort((function(e,t){return e.level-t.level}))},updateApproveData:function(){var e=Object(o["a"])(this.value);2===this.value.length&&1===this.level?e=this.value.slice(0,this.level):1===this.value.length&&2===this.level&&(e=this.value.concat(this.defaultRule)),this.rules=e,this.$emit("input",this.rules)},handleInput:function(e,t){this.$set(this.rules,e,{users:t}),this.$emit("input",this.rules)}}},d=p,m=(a("c9ca"),a("2877")),f=Object(m["a"])(d,r,i,!1,null,"1f6bef08",null),v=f.exports,h={name:"FlowCreateUpdate",components:{GenericCreateUpdatePage:s["c"]},data:function(){var e=this;return{loading:!0,fields:[[this.$t("Basic"),["type"]],[this.$t("ApprovalLevel"),["approval_level","rules"]]],fieldsMeta:{type:{disabled:!0},rules:{label:this.$t("ApprovalProcess"),component:v,el:{level:1},hidden:function(t){e.fieldsMeta.rules.el.level=t["approval_level"]}}},getUrl:function(){var e=this.$route.params,t="/api/v1/tickets/flows/";return e.id&&(t="".concat(t).concat(e.id,"/")),"".concat(t)},cleanFormValue:function(e){return e["rules"]=e["rules"].slice(0,e["approval_level"]),e},onPerformError:function(){},updateSuccessNextRoute:{name:"TicketFlow"},createSuccessNextRoute:{name:"TicketFlow"}}},computed:{initial:function(){return this.$route.query}},mounted:function(){this.$store.getters.consoleOrgs&&(this.initial.org_id=this.$store.getters.consoleOrgs[0].id),this.loading=!1}},b=h,y=Object(m["a"])(b,l,n,!1,null,"585afa7e",null);t["default"]=y.exports},"501d":function(e,t,a){},7:function(e,t){},c9ca:function(e,t,a){"use strict";a("501d")}}]);