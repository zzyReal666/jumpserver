(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-ffa07718","chunk-ffa07718","chunk-61800e09"],{"09ba":function(t,e,a){},"0d6d":function(t,e,a){var n=a("d3f4"),r=a("67ab").onFreeze;a("5eda")("freeze",(function(t){return function(e){return t&&n(e)?t(r(e)):e}}))},"1ff5":function(t,e,a){"use strict";a("39d3")},"2dc2":function(t,e,a){"use strict";a.r(e);var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("GenericDetailPage",t._g(t._b({attrs:{"active-menu":t.config.activeMenu,object:t.asset},on:{"update:activeMenu":function(e){return t.$set(t.config,"activeMenu",e)},"update:active-menu":function(e){return t.$set(t.config,"activeMenu",e)},"update:object":function(e){t.asset=e}}},"GenericDetailPage",t.config,!1),t.$listeners),[a("keep-alive",[a(t.config.activeMenu,{tag:"component",attrs:{exclude:"Account",object:t.asset}})],1)],1)},r=[],i=a("cd4a"),s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("TwoCol",{scopedSlots:t._u([{key:"right",fn:function(){return[a("QuickActions",{attrs:{actions:t.quickActions,type:"primary"}}),t._v(" "),a("RelationCard",t._b({directives:[{name:"perms",rawName:"v-perms",value:"assets.change_asset",expression:"'assets.change_asset'"}],ref:"NodeRelation",staticStyle:{"margin-top":"15px"},attrs:{type:"info"}},"RelationCard",t.nodeRelationConfig,!1)),t._v(" "),a("RelationCard",t._b({directives:[{name:"perms",rawName:"v-perms",value:"assets.change_asset",expression:"'assets.change_asset'"}],ref:"LabelRelation",staticStyle:{"margin-top":"15px"},attrs:{type:"warning"}},"RelationCard",t.labelConfig,!1))]},proxy:!0}])},[[a("AutoDetailCard",t._b({},"AutoDetailCard",t.basicInfoConfig,!1)),t._v(" "),t.isShowSpecInfo?a("AutoDetailCard",t._b({},"AutoDetailCard",t.specInfoConfig,!1)):t._e(),t._v(" "),a("AutoDetailCard",t._b({},"AutoDetailCard",t.customInfoConfig,!1)),t._v(" "),a("AutoDetailCard",t._b({},"AutoDetailCard",t.gatheredInfoConfig,!1))]],2)},o=[],c=(a("ac6a"),a("456d"),a("f559"),a("d25f"),a("7f7f"),a("6d67"),a("d92a"),a("e3bc")),l=a("2af9"),u=a("ac6b"),d=a("52cc"),f={name:"Detail",components:{TwoCol:d["a"],AutoDetailCard:c["a"],QuickActions:l["o"],RelationCard:l["p"]},props:{object:{type:Object,default:function(){}}},data:function(){var t,e=this,a=this;return{quickActions:[{title:this.$t("IsActive"),type:"switch",attrs:{label:this.$t("Test"),model:this.object.is_active,disabled:!a.$hasPerm("assets.change_asset")},callbacks:{change:function(t){var e=this;this.$axios.patch("/api/v1/assets/assets/".concat(this.object.id,"/"),{is_active:t}).then((function(t){e.$message.success(e.$tc("UpdateSuccessMsg"))})).catch((function(t){e.$message.error(e.$tc("UpdateErrorMsg "+t))}))}.bind(this)}},{title:this.$t("RefreshHardware"),attrs:{type:"primary",label:this.$t("Refresh"),disabled:!a.$hasPerm("assets.refresh_assethardwareinfo")||!this.object["auto_config"].gather_facts_enabled||!this.object["auto_config"].ansible_enabled||this.$store.getters.currentOrgIsRoot},callbacks:{click:function(){this.$axios.post("/api/v1/assets/assets/".concat(this.object.id,"/tasks/"),{action:"refresh"}).then((function(t){Object(u["k"])(t["task"])}))}.bind(this)}},{title:this.$t("TestAssetsConnective"),attrs:{type:"primary",label:this.$t("Test"),disabled:!a.$hasPerm("assets.test_assetconnectivity")||!this.object["auto_config"].ansible_enabled||!this.object["auto_config"]["ping_enabled"]||this.$store.getters.currentOrgIsRoot},callbacks:{click:function(){this.$axios.post("/api/v1/assets/assets/".concat(this.object.id,"/tasks/"),{action:"test"}).then((function(t){Object(u["k"])(t["task"])}))}.bind(this)}}],nodeRelationConfig:{icon:"fa-info",title:this.$t("Node"),objectsAjax:{url:"/api/v1/assets/nodes/",transformOption:function(t){return{label:t.full_value,value:t.id}}},hasObjectsId:(null===(t=this.object.nodes)||void 0===t?void 0:t.map((function(t){return t.id})))||[],performAdd:function(t){var a=[],n=e.$refs.NodeRelation.iHasObjects;n.map((function(t){a.push(t.value)}));var r="/api/v1/assets/assets/".concat(e.object.id,"/");return t.map((function(t){a.push(t.value)})),e.$axios.patch(r,{nodes:a})},performDelete:function(t){var a=t.value,n=[],r=e.$refs.NodeRelation.iHasObjects;r.map((function(t){t.value!==a&&n.push(t.value)}));var i="/api/v1/assets/assets/".concat(e.object.id,"/");return e.$axios.patch(i,{nodes:n})}},labelConfig:{icon:"fa-info",title:this.$t("Tags"),allowCreate:!0,objectsAjax:{url:"/api/v1/labels/labels/",transformOption:function(t){var e="".concat(t.name,": ").concat(t.value);return{label:e,value:t.id}}},hasObjectsId:this.object.labels.map((function(t){return t.id})),performAdd:function(t){var a=[],n=e.$refs.LabelRelation.iHasObjects;n.map((function(t){return a.push(t.label)}));var r="/api/v1/assets/assets/".concat(e.object.id,"/");return t.map((function(t){return a.push(t.label)})),e.$axios.patch(r,{labels:a})},performDelete:function(t){var a=t.value,n=e.$refs.LabelRelation.iHasObjects,r=n.filter((function(t){return t.value!==a})).map((function(t){return t.value})),i="/api/v1/assets/assets/".concat(e.object.id,"/");return e.$axios.patch(i,{labels:r})}},basicInfoConfig:{url:"/api/v1/assets/assets/".concat(this.object.id,"/"),object:this.object,fields:["id","name","category","type","address","platform","protocols","zone","directory_services","is_active","date_created","date_updated","created_by","comment"],formatters:{protocols:function(){return a.object.protocols.map((function(t){return(e.object.address.startsWith("https://")?"https":t.name)+"/"+t.port})).join(", ")}}},specInfoConfig:{title:this.$t("SpecificInfo"),url:"/api/v1/assets/assets/".concat(this.object.id,"/"),object:this.object,nested:"spec_info",showUndefined:!0},customInfoConfig:{title:this.$t("CustomInfo"),url:"/api/v1/assets/assets/".concat(this.object.id,"/"),object:this.object,nested:"custom_info",showUndefined:!1},gatheredInfoConfig:{url:"/api/v1/assets/hosts/".concat(this.object.id,"/"),title:this.$t("HardwareInfo"),object:this.object,nested:"gathered_info",showUndefined:!1}}},computed:{isShowSpecInfo:function(){var t,e=this.object,a=e.type.value,n=null===(t=e.spec_info)||void 0===t?void 0:t.autofill;return!("website"===a&&"script"===n)&&Object.keys(e.spec_info||{}).length>0}},mounted:function(){},methods:{}},m=f,p=a("2877"),b=Object(p["a"])(m,s,o,!1,null,"44ad55b2",null),h=b.exports,g=a("75d2"),v=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("TwoCol",{scopedSlots:t._u([{key:"right",fn:function(){return[a("PermUserGroupCard",t._b({},"PermUserGroupCard",t.UserGroupCardConfig,!1))]},proxy:!0}])},[[a("ListTable",{ref:"ListTable",attrs:{"header-actions":t.headerActions,"table-config":t.tableConfig}})]],2),t._v(" "),a("GenericListTableDialog",t._b({attrs:{visible:t.GenericListTableDialogConfig.visible},on:{"update:visible":function(e){return t.$set(t.GenericListTableDialogConfig,"visible",e)}}},"GenericListTableDialog",t.GenericListTableDialogConfig,!1))],1)},y=[],w=(a("6762"),a("2fdb"),a("53f7")),j=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("IBox",t._b({attrs:{fa:t.icon,title:t.title,type:t.type}},"IBox",t.$attrs,!1),[a("table",{staticClass:"card-table"},[t.iObjects.length>0?a("div",{},t._l(t.iObjects,(function(e){return a("tr",{key:e.value,staticClass:"item"},[a("td",[a("el-tooltip",{staticStyle:{margin:"4px"},attrs:{content:e.label,"open-delay":500,effect:"dark",placement:"left"}},[a("el-link",{staticClass:"detail",on:{click:function(a){return t.goDetail(e)}}},[t._v("\n                "+t._s(e.label)+"\n              ")])],1)],1),t._v(" "),a("td",[a("el-button",{staticStyle:{float:"right"},attrs:{size:"mini",type:"primary"},on:{click:function(a){return t.buttonClickCallback(e)}}},[t._v("\n              "+t._s(t.buttonTitle)+"\n            ")])],1)])})),0):a("div",{staticStyle:{"text-align":"center"}},[t._v("\n        "+t._s(t.$t("NoData"))+"\n      ")])])]),t._v(" "),a("Drawer",{attrs:{component:t.detailDrawer,"has-footer":!1,title:t.title,visible:t.drawerVisible},on:{"update:visible":function(e){t.drawerVisible=e}}})],1)},$=[],A=(a("2caf"),a("ac4d"),a("8a81"),a("5df3"),a("1c4c"),a("6b54"),a("87b3"),a("96cf"),a("3b8d")),C=a("e9f9"),O=a("ca50");function x(t,e){var a="undefined"!==typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!a){if(Array.isArray(t)||(a=D(t))||e&&t&&"number"===typeof t.length){a&&(t=a);var n=0,r=function(){};return{s:r,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,s=!0,o=!1;return{s:function(){a=a.call(t)},n:function(){var t=a.next();return s=t.done,t},e:function(t){o=!0,i=t},f:function(){try{s||null==a.return||a.return()}finally{if(o)throw i}}}}function D(t,e){if(t){if("string"===typeof t)return k(t,e);var a=Object.prototype.toString.call(t).slice(8,-1);return"Object"===a&&t.constructor&&(a=t.constructor.name),"Map"===a||"Set"===a?Array.from(t):"Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a)?k(t,e):void 0}}function k(t,e){(null==e||e>t.length)&&(e=t.length);for(var a=0,n=new Array(e);a<e;a++)n[a]=t[a];return n}var S={name:"PermUserGroupCard",components:{IBox:C["a"],Drawer:O["a"]},props:{icon:{type:String,default:""},title:{type:String,required:!0},type:{type:String,default:"primary"},url:{type:String,required:!0},detailRoute:{type:[String,Function],default:""},buttonTitle:{type:String,required:!0},buttonClickCallback:{type:Function,default:function(t){}}},data:function(){return{detailDrawer:"",drawerVisible:!1,objects:[]}},computed:{iObjects:function(){return this.objects}},mounted:function(){this.loadObjects()},methods:{loadObjects:function(){var t=Object(A["a"])(regeneratorRuntime.mark((function t(){var e,a,n,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,this.$axios.get(this.url);case 2:e=t.sent,a=x(e);try{for(a.s();!(n=a.n()).done;)r=n.value,r["label"]=r["name"]}catch(i){a.e(i)}finally{a.f()}this.objects=e;case 6:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),goDetail:function(t){var e=this;this.detailDrawer=this.detailRoute,this.$store.dispatch("common/setDrawerActionMeta",{action:"create",row:{},id:t.id}).then((function(){e.drawerVisible=!0}))}}},T=S,P=(a("1ff5"),Object(p["a"])(T,j,$,!1,null,"d29e39e2",null)),L=P.exports,I={name:"PermUserList",components:{TwoCol:d["a"],ListTable:l["j"],GenericListTableDialog:i["g"],PermUserGroupCard:L},props:{object:{type:Object,default:function(){}}},data:function(){var t=this,e=this;return{tableConfig:{url:"/api/v1/assets/assets/".concat(this.object.id,"/perm-users/"),columns:["name","username","email","comment","created_by"],columnsShow:{min:["name","username"],default:["name","username"]},columnsMeta:{name:{formatter:w["i"],formatterArgs:{drawer:!0,can:e.$hasPerm("users.view_user"),getRoute:function(t){var e=t.row;return{name:"UserDetail",params:{id:e.id}}}}},source:{width:"120px"},system_roles:{width:"100px",label:this.$t("SystemRoles"),formatter:function(t){return t["system_roles"].map((function(t){return t["display_name"]})).join(", ")||"-"},filters:[],columnKey:"system_roles"},org_roles:{width:"100px",label:this.$t("OrgRoles"),formatter:function(t){return t["org_roles"].map((function(t){return t["display_name"]})).join(", ")||"-"},filters:[],columnKey:"org_roles",has:function(){return t.$store.getters.hasValidLicense&&!t.currentOrgIsRoot}},mfa_enabled:{label:"MFA",formatterArgs:{showFalse:!1}},mfa_force_enabled:{formatterArgs:{showFalse:!1}},is_expired:{formatterArgs:{showFalse:!1}},groups_display:{width:"200px"},actions:{formatterArgs:{hasUpdate:!1,hasDelete:!1,hasClone:!1,extraActions:[{title:e.$t("ViewPerm"),name:"view",type:"primary",callback:function(t){e.GenericListTableDialogConfig.visible=!0,e.GenericListTableDialogConfig.tableConfig.url="/api/v1/assets/assets/".concat(e.object.id,"/perm-users/").concat(t.row.id,"/permissions/")}}]}}}},headerActions:{hasImport:!1,hasExport:!1,hasLeftActions:!1},UserGroupCardConfig:{title:this.$t("UserGroups"),url:"/api/v1/assets/assets/".concat(e.object.id,"/perm-user-groups/"),detailRoute:function(){return a.e("chunk-6baf669b").then(a.bind(null,"d3b8"))},buttonTitle:this.$t("ViewPerm"),buttonClickCallback:function(t){e.GenericListTableDialogConfig.visible=!0,e.GenericListTableDialogConfig.tableConfig.url="/api/v1/assets/assets/".concat(e.object.id,"/perm-user-groups/").concat(t.id,"/permissions/")}},GenericListTableDialogConfig:{title:this.$t("Permissions"),visible:!1,width:"60%",tableConfig:{url:"",columns:["name","user_groups_amount","assets_amount","is_valid","is_active","date_expired","comment","org_name","created_by","date_created"],columnsShow:{min:["name"],default:["name","is_valid","created_by","date_created"]},columnsMeta:{name:{formatterArgs:{route:"AssetPermissionDetail"}},users_amount:{label:this.$t("User"),width:"60px",formatter:w["i"],formatterArgs:{route:"AssetPermissionDetail",routeQuery:{tab:"AssetPermissionUser"}}},user_groups_amount:{label:this.$t("UserGroups"),width:"100px",formatter:w["i"],formatterArgs:{route:"AssetPermissionDetail",routeQuery:{tab:"AssetPermissionUser"}}},assets_amount:{label:this.$t("Asset"),width:"60px",formatter:w["i"],formatterArgs:{route:"AssetPermissionDetail",routeQuery:{tab:"AssetPermissionAsset"}}}}},headerActions:{hasImport:!1,hasExport:!1,hasLeftActions:!1,hasColumnSetting:!1,searchConfig:{getUrlQuery:!1}}}}},watch:{$route:{handler:function(t){t.fullPath.includes("/console/perms/asset-permissions/")&&(this.GenericListTableDialogConfig.visible=!1)}}}},E=I,U=Object(p["a"])(E,v,y,!1,null,null,null),R=U.exports,M=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("TwoCol",[a("BaseList",{attrs:{"columns-show":t.columnsShow,"columns-meta":t.columnsMeta,url:t.url}})],1)},B=[],F=a("d106"),G={name:"AssetsSession",components:{TwoCol:d["a"],BaseList:F["a"]},props:{object:{type:Object,required:!0}},data:function(){return{url:"/api/v1/terminal/sessions/?asset_id=".concat(this.object.id,"&order=is_finished,-date_end"),columnsShow:{min:["id"],default:["id","user","asset","account","date_start","duration"]},columnsMeta:{id:{width:"80px"}}}}},N=G,V=Object(p["a"])(N,M,B,!1,null,null,null),q=V.exports,Q=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("BaseList",{attrs:{"asset-id":t.object.id,"is-page":!1}})},z=[],H=a("8c70"),Y={name:"AssetCommand",components:{BaseList:H["default"]},props:{object:{type:Object,required:!0}},data:function(){return{title:"",url:"/api/v1/terminal/command-storages/tree/?real=1&asset_id=".concat(this.object.id,"&order=-date_end&is_finished=1")}}},Z=Y,W=Object(p["a"])(Z,Q,z,!1,null,null,null),J=W.exports,K={name:"AssetListDetail",components:{GenericDetailPage:i["d"],TabPage:i["l"],Detail:h,Account:g["a"],PermUserList:R,AssetSession:q,AssetCommand:J},data:function(){var t=this;return{asset:{},config:{url:"/api/v1/assets/assets",activeMenu:"Detail",submenu:[{title:this.$t("Basic"),name:"Detail"},{title:this.$t("Accounts"),name:"Account",hidden:function(){return!t.$hasPerm("accounts.view_account")}},{title:this.$t("PermUserList"),name:"PermUserList",hidden:function(){return!t.$hasPerm("perms.view_assetpermission")}},{title:this.$t("SessionList"),name:"AssetSession",hidden:function(){return!t.$hasPerm("terminal.view_session")}},{title:this.$t("Commands"),name:"AssetCommand",hidden:function(){return!t.$hasPerm("terminal.view_command")}}],hasRightSide:!0,actions:{updateCallback:function(){var e=t.asset.category.value||"host",a=_.capitalize(e)+"Update";t.$router.push({name:a,params:{id:t.$route.params.id},query:{platform:t.asset.platform.id,type:t.asset.type.value}})}}}}}},X=K,tt=Object(p["a"])(X,n,r,!1,null,null,null);e["default"]=tt.exports},"39d3":function(t,e,a){},"59a1":function(t,e,a){"use strict";a("b29f")},"75d2":function(t,e,a){"use strict";var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("TwoCol",[[a("AccountListTable",t._b({ref:"ListTable",attrs:{asset:t.object,"columns-default":t.columnsDefault,"has-clone":!1,"has-import":!1,"has-left-actions":!0,"header-extra-actions":t.headerExtraActions,url:t.iUrl}},"AccountListTable",t.$attrs,!1)),t._v(" "),t.templateDialogVisible?a("AccountTemplateDialog",{attrs:{asset:t.object,"show-create":!1,visible:t.templateDialogVisible},on:{"update:visible":function(e){t.templateDialogVisible=e},onConfirm:t.onConfirm}}):t._e()]],2)],1)},r=[],i=(a("6d67"),a("0d6d"),a("57e7"),a("75fc")),s=(a("7f7f"),a("2af9")),o=a("260f"),c=a("ac6b"),l=a("52cc"),u={name:"Detail",components:{TwoCol:l["a"],AccountListTable:s["a"],AccountTemplateDialog:o["a"]},props:{object:{type:Object,default:function(){}},url:{type:String,default:""},extraQuickActions:{type:Array,default:function(){return[]}}},data:function(){var t=this;return{title:this.$t("Test"),templateDialogVisible:!1,columnsDefault:["name","username","connect"],headerExtraActions:[{name:this.$t("AccountTemplate"),title:this.$t("AccountTemplate"),has:this.$hasLicense()||"Applets"!==this.$route.name,can:function(){return t.$hasPerm("accounts.view_accounttemplate")&&!t.$store.getters.currentOrgIsRoot},callback:function(){t.templateDialogVisible=!0}}],quickActions:[{title:this.$t("BatchTest"),attrs:{type:"primary",label:this.$tc("Test"),disabled:-1!==["clickhouse","redis","website","chatgpt"].indexOf(this.object.type.value)||this.$store.getters.currentOrgIsRoot},callbacks:Object.freeze({click:function(){t.$axios.post("/api/v1/accounts/accounts/tasks/",{action:"verify",assets:[t.object.id]}).then((function(t){Object(c["k"])(t["task"])}))}})}].concat(Object(i["a"])(this.extraQuickActions))}},computed:{iUrl:function(){return this.url||"/api/v1/accounts/accounts/?asset=".concat(this.object.id)}},methods:{onConfirm:function(t){var e,a=this;t=null===(e=t)||void 0===e?void 0:e.map((function(t){return t.asset=a.object.id,t})),this.$axios.post("/api/v1/accounts/accounts/",t).then((function(){a.templateDialogVisible=!1,a.$refs.ListTable.addAccountSuccess(),a.$message.success(a.$tc("AddSuccessMsg"))}))}}},d=u,f=a("2877"),m=Object(f["a"])(d,n,r,!1,null,null,null);e["a"]=m.exports},8633:function(t,e,a){"use strict";a("09ba")},"8c70":function(t,e,a){"use strict";a.r(e);var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return t.isPage?a("Page",t._b({},"Page",t.$attrs,!1),[a("CommandList",t._b({},"CommandList",t.$attrs,!1))],1):a("div",[a("CommandList",t._b({},"CommandList",t.$attrs,!1))],1)},r=[],i=a("cd4a"),s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("TreeTable",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],ref:"CommandTreeTable",staticClass:"command-list-table",attrs:{"header-actions":t.headerActions,"table-config":t.tableConfig,"tree-setting":t.treeSetting},on:{TagDateChange:t.handleDateChange,TagFilter:t.handleFilterChange,TagSearch:t.handleTagChange,TreeInitFinish:t.checkFirstNode}})},o=[],c=(a("2caf"),a("ac4d"),a("8a81"),a("5df3"),a("1c4c"),a("7f7f"),a("1c01"),a("58b2"),a("8e6e"),a("f3e2"),a("6b54"),a("87b3"),a("4f37"),a("ac6a"),a("456d"),a("d25f"),a("0cd8"),a("57e7"),a("bd86")),l=(a("96cf"),a("3b8d")),u=(a("8ea5"),a("6557")),d=a("3f95"),f=a("d58a"),m=a("53f7"),p=a("6943"),b=a("3c4e"),h=a.n(b),g=a("c3eb"),v=a("2934"),y=a("dbfd");function _(t,e){var a="undefined"!==typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!a){if(Array.isArray(t)||(a=w(t))||e&&t&&"number"===typeof t.length){a&&(t=a);var n=0,r=function(){};return{s:r,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,s=!0,o=!1;return{s:function(){a=a.call(t)},n:function(){var t=a.next();return s=t.done,t},e:function(t){o=!0,i=t},f:function(){try{s||null==a.return||a.return()}finally{if(o)throw i}}}}function w(t,e){if(t){if("string"===typeof t)return j(t,e);var a=Object.prototype.toString.call(t).slice(8,-1);return"Object"===a&&t.constructor&&(a=t.constructor.name),"Map"===a||"Set"===a?Array.from(t):"Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a)?j(t,e):void 0}}function j(t,e){(null==e||e>t.length)&&(e=t.length);for(var a=0,n=new Array(e);a<e;a++)n[a]=t[a];return n}function $(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),a.push.apply(a,n)}return a}function A(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?$(Object(a),!0).forEach((function(e){Object(c["a"])(t,e,a[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):$(Object(a)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))}))}return t}var C={name:"CommandList",components:{TreeTable:u["a"]},props:{assetId:{type:String,default:function(){return""}}},data:function(){var t=this,e=this.$createElement,a=Object(d["e"])(7).toISOString(),n=this.$moment(Object(d["c"])()).add(1,"day").toISOString();return{loading:!0,tableConfig:{url:"/api/v1/terminal/commands/",tableAttrs:{rowClassName:function(t){var e=t.row;return 5===e.risk_level?"risk-command":"command"}},columns:["expandCol","input","risk_level","user","asset","account","session","timestamp"],extraQuery:{date_to:n,date_from:a},columnsMeta:{expandCol:{type:"expand",prop:"output",label:"",formatter:f["a"]},risk_level:{formatter:function(t,a,n){var r=t["risk_level"].label;return 0===(null===n||void 0===n?void 0:n.value)?r:e("span",{class:"text-danger"},[" ",r," "])}},actions:{has:!1},session:{formatter:m["i"],formatterArgs:{drawer:!0,can:this.$hasPerm("terminal.view_session"),getRoute:function(t){var e=t.cellValue;return{name:"SessionDetail",params:{id:e}}}}},timestamp:{label:this.$t("Datetime"),width:180,sortable:"custom",formatter:function(t){return Object(d["i"])(1e3*t.timestamp)}}}},headerActions:{hasLeftActions:!1,hasImport:!1,hasExport:this.$hasPerm("terminal.view_command"),hasDatePicker:!0,datePicker:{dateStart:a,dateEnd:n},canExportSelected:!0,exportOptions:{performExport:function(){var e=Object(l["a"])(regeneratorRuntime.mark((function e(a,n,r,i){var s,o,c,l,u,d,f,m;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(s=t.tableConfig.url,s="".concat(s),o=A({},r),"selected"!==n){e.next=11;break}c=[],l=_(a);try{for(l.s();!(u=l.n()).done;)d=u.value,c.push(d.id)}catch(p){l.e(p)}finally{l.f()}return e.next=9,Object(v["a"])(c);case 9:f=e.sent,o["spm"]=f.spm;case 11:o["format"]=i,m=(s.indexOf("?")>-1?"&":"?")+g["d"](o,"=","&"),s+=m,t.$log.debug("Export url: ",t.url,"=>",s),Object(y["e"])(s+m);case 16:case"end":return e.stop()}}),e)})));function a(t,a,n,r){return e.apply(this,arguments)}return a}()}},treeSetting:{showMenu:!1,showRefresh:!0,showAssets:!1,treeUrl:"/api/v1/terminal/command-storages/tree/?real=1&date_from=".concat(a,"&date_to=").concat(n,"&asset_id=").concat(this.assetId),view:{fontCss:function(t,e){return e.chkDisabled?{opacity:"0.4"}:{}}},callback:{onSelected:function(e,a){"root"!==a.id&&(a.valid?(t.tableConfig.url="/api/v1/terminal/commands/?command_storage_id=".concat(a.id,"&order=-timestamp"),t.assetId&&(t.tableConfig.url+="&asset_id=".concat(t.assetId))):t.$message.error(t.$tc("EsDisabled")))}}}}},computed:{treeTable:function(){return this.$refs.CommandTreeTable}},watch:{},methods:{checkFirstNode:function(t){var e=t,a=e.getNodes();a[0].children.length>0&&e.selectNode(a[0].children[0]),this.loading=!1},handleTagChange:function(t){var e=this.cleanUrl(t),a="/api/v1/terminal/command-storages/tree/?real=1&asset_id=".concat(this.assetId),n=(a.indexOf("?")>-1?"&":"?")+g["d"](e,"=","&"),r=a+n;this.$set(this.treeSetting,"treeUrl",r)},handleFilterChange:function(t){var e=this.cleanUrl(t),a="/api/v1/terminal/command-storages/tree/?real=1&asset_id=".concat(this.assetId),n=(a.indexOf("?")>-1?"&":"?")+g["d"](e,"=","&"),r=a+n;this.$set(this.treeSetting,"treeUrl",r)},handleDateChange:function(t){this.query={date_from:t[0].toISOString(),date_to:t[1].toISOString()};var e="/api/v1/terminal/command-storages/tree/?real=1&asset_id=".concat(this.assetId),a=(e.indexOf("?")>-1?"&":"?")+g["d"](this.query,"=","&"),n=e+a;this.$set(this.treeSetting,"treeUrl",n),this.treeTable.forceRerenderTree()},cleanUrl:function(t){return t=Object.keys(t).filter((function(e){return!Object(p["a"])(t[e])})).reduce((function(e,a){return e[a]=t[a].toString().trim(),e}),{}),t=h()(this.query,t),t}}},O=C,x=(a("59a1"),a("2877")),D=Object(x["a"])(O,s,o,!1,null,"1b463be6",null),k=D.exports,S={name:"BaseList",components:{Page:i["k"],CommandList:k},props:{isPage:{type:Boolean,default:function(){return!0}}}},T=S,P=Object(x["a"])(T,n,r,!1,null,null,null);e["default"]=P.exports},"94df":function(t,e,a){"use strict";const n=["B","kB","MB","GB","TB","PB","EB","ZB","YB"],r=["B","kiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"],i=["b","kbit","Mbit","Gbit","Tbit","Pbit","Ebit","Zbit","Ybit"],s=["b","kibit","Mibit","Gibit","Tibit","Pibit","Eibit","Zibit","Yibit"],o=(t,e,a)=>{let n=t;return"string"===typeof e||Array.isArray(e)?n=t.toLocaleString(e,a):!0!==e&&void 0===a||(n=t.toLocaleString(void 0,a)),n};t.exports=(t,e)=>{if(!Number.isFinite(t))throw new TypeError(`Expected a finite number, got ${typeof t}: ${t}`);e=Object.assign({bits:!1,binary:!1},e);const a=e.bits?e.binary?s:i:e.binary?r:n;if(e.signed&&0===t)return" 0 "+a[0];const c=t<0,l=c?"-":e.signed?"+":"";let u;if(c&&(t=-t),void 0!==e.minimumFractionDigits&&(u={minimumFractionDigits:e.minimumFractionDigits}),void 0!==e.maximumFractionDigits&&(u=Object.assign({maximumFractionDigits:e.maximumFractionDigits},u)),t<1){const n=o(t,e.locale,u);return l+n+" "+a[0]}const d=Math.min(Math.floor(e.binary?Math.log(t)/Math.log(1024):Math.log10(t)/3),a.length-1);t/=Math.pow(e.binary?1024:1e3,d),u||(t=t.toPrecision(3));const f=o(Number(t),e.locale,u),m=a[d];return l+f+" "+m}},b29f:function(t,e,a){},d106:function(t,e,a){"use strict";var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("ListTable",{attrs:{"detail-drawer":t.detailDrawer,"header-actions":t.headerActions,"table-config":t.tableConfig}})},r=[],i=(a("1c01"),a("58b2"),a("8e6e"),a("f3e2"),a("d25f"),a("ac6a"),a("456d"),a("c5f6"),a("bd86")),s=a("75fc"),o=a("94df"),c=a.n(o),l=a("2af9"),u=a("3f95"),d=a("53f7");function f(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),a.push.apply(a,n)}return a}function m(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?f(Object(a),!0).forEach((function(e){Object(i["a"])(t,e,a[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):f(Object(a)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))}))}return t}var p={name:"BaseList",components:{ListTable:l["j"]},props:{url:{type:String,default:function(){return"/api/v1/terminal/sessions/"}},extraActions:{type:Array,default:function(){return[]}},columnsShow:{type:Object,default:function(){return{min:["id","actions"],default:["id","user","asset","account","protocol","date_start","actions"]}}},columnsMeta:{type:Object,default:function(){}},columnsExclude:{type:Array,default:function(){return[]}}},data:function(){return{detailDrawer:function(){return a.e("chunk-58e2a36e").then(a.bind(null,"b662"))},tableConfig:{url:this.url,columnsExclude:["terminal"].concat(Object(s["a"])(this.columnsExclude)),columnsShow:this.columnsShow,columnsMeta:m({id:{prop:"id",label:this.$t("Number"),width:"80px",align:"center",formatter:d["i"],formatterArgs:{drawer:!0,can:this.$hasPerm("assets.view_asset"),getTitle:function(t){t.row,t.col,t.cellValue;var e=t.index;return e+1},getDrawerTitle:function(t){var e=t.row;return e.id},getRoute:function(t){var e=t.row;return{name:"SessionDetail",params:{id:e.id}}}}},user:{formatter:d["i"],formatterArgs:{drawer:!0,getTitle:function(t){var e=t.row;return e.user},getRoute:function(t){var e=t.row;return{name:"UserDetail",params:{id:e.user_id}}}}},can_join:{formatterArgs:{showFalse:!1}},can_replay:{formatterArgs:{showFalse:!1}},can_terminate:{formatterArgs:{showFalse:!1}},has_command:{formatterArgs:{showFalse:!1}},is_finished:{formatterArgs:{showFalse:!1}},has_replay:{formatterArgs:{showFalse:!1}},asset:{label:this.$t("Target"),formatter:d["i"],formatterArgs:{drawer:!0,can:this.$hasPerm("assets.view_asset"),getTitle:function(t){var e=t.row;return e.asset},getRoute:function(t){var e=t.row;return{name:"AssetDetail",params:{id:e.asset_id},query:{tab:"Basic"}}}}},protocol:{sortable:!1,formatter:null},duration:{label:this.$t("Duration"),formatter:function(t){return Object(u["h"])(t.date_start,t.date_end)}},is_locked:{label:this.$t("IsLocked"),formatter:d["e"],formatterArgs:{showFalse:!0}},replay_size:{width:"120px",formatter:function(t){return c()(Number(t.replay_size))}},actions:{prop:"actions",label:this.$t("Actions"),width:this.dynamicActionWidth,formatter:d["c"],formatterArgs:{hasEdit:!1,hasClone:!1,hasDelete:!1,hasUpdate:!1,extraActions:this.extraActions}}},this.columnsMeta)},headerActions:{hasLeftActions:!1,hasImport:!1,hasDatePicker:!0,searchConfig:{getUrlQuery:!1,exclude:["is_finished"]}}}},computed:{dynamicActionWidth:function(){return"pt-br"===this.$i18n.locale?"160px":"130px"}}},b=p,h=(a("8633"),a("2877")),g=Object(h["a"])(b,n,r,!1,null,"0495f38f",null);e["a"]=g.exports},d58a:function(t,e,a){"use strict";var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("pre",{staticStyle:{border:"none",background:"none","white-space":"pre-wrap","word-wrap":"break-word",padding:"10px 20px"}},[t._v(t._s("$ "+t.row.input)+"\n"),a("br"),t._v("\n"+t._s(t.row.output)+"\n  ")])},r=[],i=a("73c8"),s={name:"OutputExpandFormatter",extends:i["a"]},o=s,c=a("2877"),l=Object(c["a"])(o,n,r,!1,null,"55cdfbb2",null),u=l.exports;a.d(e,"a",(function(){return u}))}}]);