(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-12059c5e"],{1576:function(t,e,s){},"27d3":function(t,e,s){"use strict";s("1576")},5423:function(t,e,s){"use strict";s.d(e,"a",(function(){return a}));s("a481");var i=s("b416"),a=function(){var t=document.documentElement.style,e=t.getPropertyValue("--color-primary"),s=e.replace(/#/g,""),a=Object(i["c"])(s,"ffffff",38),r=Object(i["c"])(s,"ffffff",20),o=Object(i["c"])(s,"ffffff",1);return{primary:e,TwoLevelColor:a,ThreeLevelColor:r,shadowColor:o}}},"54b3":function(t,e,s){"use strict";s.r(e);var i=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("BaseReport",t._b({attrs:{title:t.title,nav:t.nav,name:t.name}},"BaseReport",t.$attrs,!1),[s("div",{staticClass:"charts-grid"},[s("div",{staticClass:"chart-container full-width"},[s("div",{staticClass:"chart-container-title"},[s("div",{staticClass:"chart-container-title-text"},[t._v(t._s(t.$t("Overview")))]),t._v(" "),s("SummaryCountCard",{attrs:{items:t.totalData}})],1)]),t._v(" "),s("SwitchDate",{staticClass:"switch-date",attrs:{name:t.name},on:{change:t.onChange}}),t._v(" "),s("div",{staticClass:"chart-container full-width"},[s("div",{staticClass:"chart-container-title"},[s("div",{staticClass:"chart-container-title-text"},[t._v(t._s(t.$t("UserLoginTrends")))]),t._v(" "),s("div",{staticClass:"chart"},[s("echarts",{ref:"loginTrend",attrs:{options:t.loginTrendOptions,autoresize:!0}})],1)])]),t._v(" "),s("div",{staticClass:"chart-container"},[s("div",{staticClass:"chart-container-title"},[s("div",{staticClass:"chart-container-title-text"},[t._v(t._s(t.$t("LoginSource")))]),t._v(" "),s("div",{staticClass:"chart"},[s("echarts",{attrs:{options:t.LoginSourceOptions,autoresize:!0}})],1)])]),t._v(" "),s("div",{staticClass:"chart-container"},[s("div",{staticClass:"chart-container-title"},[s("div",{staticClass:"chart-container-title-text"},[t._v(t._s(t.$t("VisitTimeDistribution")))]),t._v(" "),s("div",{staticClass:"chart"},[s("echarts",{attrs:{options:t.VisitTimeOptions,autoresize:!0}})],1)])]),t._v(" "),s("div",{staticClass:"chart-container full-width"},[s("div",{staticClass:"chart-container-title"},[s("div",{staticClass:"chart-container-title-text"},[t._v(t._s(t.$t("LoginMethodStatistics")))]),t._v(" "),s("div",{staticClass:"chart"},[s("echarts",{attrs:{options:t.loginMethodOptions,autoresize:!0}})],1)])])],1)])],1)},a=[],r=(s("96cf"),s("3b8d")),o=(s("8615"),s("75fc")),n=(s("ac6a"),s("456d"),s("6d67"),s("7f7f"),s("d619")),c=s("280e"),l=s("313e"),_=s("5423"),d=s("5f2d"),u={components:{SummaryCountCard:d["a"],BaseReport:n["a"],SwitchDate:c["a"]},props:{nav:{type:Boolean,default:!0}},data:function(){return{title:this.$t("UserLoginReport"),name:"UserLoginReport",days:localStorage.getItem(this.name)||"7",user_stats:{total:0,not_enabled_mfa:0,valid:0,first_login:0,face_vector:0,need_update_password:0},pie:{user_by_source:[{name:this.$t("Nothing"),value:0}]},config:{user_login_failed_metrics:{dates_metrics_date:[],dates_metrics_total:[0]},user_login_log_metrics:{dates_metrics_date:[],dates_metrics_success_total:[0],dates_metrics_failure_total:[0]},user_login_method_metrics:{dates_metrics_date:[],dates_metrics_total:{}},user_login_time_metrics:{}}}},computed:{totalData:function(){return[{title:this.$t("Total"),body:{count:this.user_stats.total}},{title:this.$t("NotEnableMfa"),body:{count:this.user_stats.not_enabled_mfa}},{title:this.$t("FirstLogin"),body:{count:this.user_stats.first_login}},{title:this.$t("Valid"),body:{count:this.user_stats.valid}},{title:this.$t("FaceVector"),body:{count:this.user_stats.face_vector}},{title:this.$t("NeedUpdatePassword"),body:{count:this.user_stats.need_update_password}}]},LoginSourceOptions:function(){return{tooltip:{trigger:"item"},legend:{orient:"vertical",left:"left"},series:[{type:"pie",minAngle:5,radius:["40%","70%"],itemStyle:{borderRadius:10,borderColor:"#fff",borderWidth:2},label:{show:!1,position:"center"},emphasis:{label:{show:!0,fontSize:15,fontWeight:"bold"}},data:this.pie.user_by_source}]}},loginTrendOptions:function(){var t=Object(_["a"])(),e=t.primary,s=t.TwoLevelColor,i=t.ThreeLevelColor,a=t.shadowColor;return{title:{show:!1},tooltip:{trigger:"axis",axisPointer:{type:"cross",label:{backgroundColor:"#6a7985"}}},legend:{left:"auto",icon:"rect",itemWidth:10,itemHeight:10},grid:{left:"3%",right:"4%",bottom:"3%",containLabel:!0},color:[e,"#F3B44B"],xAxis:[{type:"category",boundaryGap:!1,axisLine:{lineStyle:{color:"#8F959E"}},axisLabel:{textStyle:{color:"#8F959E"}},axisTick:{show:!1},data:this.config.user_login_log_metrics.dates_metrics_date}],yAxis:[{type:"value",name:"",axisLine:{show:!1,lineStyle:{color:"#fff"}},axisLabel:{textStyle:{color:"#8F959E"}},axisTick:{show:!1},splitLine:{show:!0,lineStyle:{color:"#EFF0F1"}}}],animationDuration:500,series:[{name:this.$t("Success"),type:"line",smooth:!0,areaStyle:{normal:{color:new l["graphic"].LinearGradient(0,0,0,1,[{offset:0,color:e},{offset:.6,color:s},{offset:.8,color:i}],!1),shadowColor:a,shadowBlur:5}},data:this.config.user_login_log_metrics.dates_metrics_success_total},{name:this.$t("Failed"),type:"line",smooth:!0,areaStyle:{normal:{color:new l["graphic"].LinearGradient(0,0,0,1,[{offset:0,color:"rgba(249, 199, 79, 0.6)"},{offset:.6,color:"rgba(249, 199, 79, 0.2)"},{offset:.8,color:"rgba(249, 199, 79, 0.1)"}],!1),shadowColor:"rgba(249, 199, 79, 0.1)",shadowBlur:6}},data:this.config.user_login_log_metrics.dates_metrics_failure_total}]}},loginMethodOptions:function(){var t=this;return{tooltip:{trigger:"axis"},xAxis:{type:"category",data:this.config.user_login_method_metrics.dates_metrics_date,axisLabel:{rotate:45}},yAxis:{type:"value",name:""},barCategoryGap:"70%",series:Object.keys(this.config.user_login_method_metrics.dates_metrics_total).map((function(e){return{name:e,stack:"name",type:"bar",data:t.config.user_login_method_metrics.dates_metrics_total[e]}}))}},VisitTimeOptions:function(){var t=Math.max.apply(Math,Object(o["a"])(Object.values(this.config.user_login_time_metrics)));return{tooltip:{trigger:"item"},radar:{indicator:[{name:"00:00-06:00",max:t},{name:"06:00-12:00",max:t},{name:"12:00-18:00",max:t},{name:"18:00-24:00",max:t}]},series:[{name:this.$t("AccessDistribution"),type:"radar",data:[{value:Object.values(this.config.user_login_time_metrics),name:this.$t("Visits"),areaStyle:{opacity:.3}}]}]}}},watch:{days:function(){this.getData()}},mounted:function(){var t=Object(r["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,this.getData();case 2:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),methods:{onChange:function(t){this.days=t,localStorage.setItem("reportDays",t)},getData:function(){var t=Object(r["a"])(regeneratorRuntime.mark((function t(){var e,s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,this.$axios.get("/api/v1/reports/reports/users/?days=".concat(this.days));case 2:e=t.sent,this.$set(this.user_stats,"total",e.user_stats.total),this.$set(this.user_stats,"not_enabled_mfa",e.user_stats.not_enabled_mfa),this.$set(this.user_stats,"valid",e.user_stats.valid),this.$set(this.user_stats,"first_login",e.user_stats.first_login),this.$set(this.user_stats,"face_vector",e.user_stats.face_vector),this.$set(this.user_stats,"need_update_password",e.user_stats.need_update_password),this.$set(this.config.user_login_log_metrics,"dates_metrics_date",e.user_login_log_metrics.dates_metrics_date),this.$set(this.config.user_login_log_metrics,"dates_metrics_success_total",e.user_login_log_metrics.dates_metrics_success_total),this.$set(this.config.user_login_log_metrics,"dates_metrics_failure_total",e.user_login_log_metrics.dates_metrics_failure_total),this.$set(this.config.user_login_method_metrics,"dates_metrics_date",e.user_login_method_metrics.dates_metrics_date),this.$set(this.config.user_login_method_metrics,"dates_metrics_total",e.user_login_method_metrics.dates_metrics_total),this.$set(this.config,"user_login_time_metrics",e.user_login_time_metrics),s=e.user_by_source,0!==s.length?this.$set(this.pie,"user_by_source",s):this.$set(this.pie,"user_by_source",[{name:this.$t("Nothing"),value:0}]);case 17:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}()}},h=u,m=s("2877"),f=Object(m["a"])(h,i,a,!1,null,"e690cb90",null);e["default"]=f.exports},"68b4d":function(t,e,s){},cd5f:function(t,e,s){"use strict";s("68b4d")},d619:function(t,e,s){"use strict";var i=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{class:{"no-padding":t.onlyCharts,nav:t.nav}},[!t.onlyCharts&&t.nav?s("div",{staticClass:"header nav-bar"},[s("div",{staticClass:"nav-bar-logo"},[s("Logo")],1),t._v(" "),s("RightAction",{attrs:{name:t.name}})],1):t._e(),t._v(" "),s("div",{staticClass:"content"},[t.onlyCharts?t._e():s("div",{staticClass:"title-bar"},[s("div",{staticClass:"title"},[t._v("\n        "+t._s(t.title)+"\n\n        "),s("span",{staticClass:"datetime"},[t._v("\n          ["+t._s((new Date).toLocaleString())+"]\n        ")]),t._v(" "),!t.nav&&t.url?s("span",{staticStyle:{float:"right","line-height":"40px"}},[s("el-button",{attrs:{type:"text"},on:{click:t.openNewWindow}},[s("i",{staticClass:"fa fa-external-link",staticStyle:{"font-size":"15px"}}),t._v("\n            "+t._s(t.$t("Export"))+"\n          ")])],1):t._e()]),t._v(" "),t.isDescription?s("div",{staticClass:"description"},[t._v("\n        "+t._s(t.description)+"\n      ")]):t._e()]),t._v(" "),s("div",{staticClass:"charts-zone"},[t._t("default")],2)])])},a=[],r=(s("6762"),s("2fdb"),s("4f37"),s("62db")),o=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"nav-bar-right export-bar"},[s("el-button-group",[s("el-button",{staticClass:"export-btn",attrs:{loading:t.exportLoading,disabled:t.exportLoading,type:"text",icon:"el-icon-printer"},on:{click:t.exportPdf}},[t._v("\n      "+t._s(t.$t("ExportAsPDF"))+"\n\n    ")]),t._v(" "),s("el-button",{staticClass:"export-btn",attrs:{type:"text",icon:"el-icon-message"},on:{click:t.emailReport}},[t._v("\n\n      "+t._s(t.$t("EMailReport"))+"\n    ")]),t._v(" "),s("el-button",{staticClass:"export-btn",attrs:{type:"text",icon:"el-icon-printer"},on:{click:t.printReport}},[t._v("\n      "+t._s(t.$t("Print"))+"\n    ")])],1)],1)},n=[],c=(s("7f7f"),s("dbfd")),l={name:"RightAction",props:{name:{type:String,default:""}},data:function(){return{exportLoading:!1}},methods:{checkName:function(){return!!this.name||(this.$message.error("Please select a chart"),!1)},getDaysParam:function(){return this.$route.query.days||localStorage.getItem(this.name)||"7"},exportPdf:function(){if(this.checkName()){var t=this.getDaysParam(),e="/core/reports/export-pdf/?chart=".concat(this.name,"&days=").concat(t);this.$message.success(this.$t("Export")+"..."),Object(c["e"])(e)}},emailReport:function(){var t=this;if(this.checkName()){var e=this.getDaysParam();this.$message.success(this.$t("EMailReport")+"..."),this.$axios.post("/core/reports/send-mail/?chart=".concat(this.name,"&days=").concat(e)).catch((function(e){t.$message.error(t.$t("Failed")+": "+e.message)}))}},printReport:function(){window.print()}}},_=l,d=(s("cd5f"),s("2877")),u=Object(d["a"])(_,o,n,!1,null,"04bfb9fd",null),h=u.exports,m={components:{Logo:r["a"],RightAction:h},props:{onlyCharts:{type:Boolean,default:!1},nav:{type:Boolean,default:!1},name:{type:String,default:""},title:{type:String,default:""},description:{type:String,default:""},url:{type:String,default:""}},data:function(){return{}},computed:{isDescription:function(){return this.description&&""!==this.description.trim()}},methods:{handleChangeChart:function(t){},openNewWindow:function(){try{if(!this.win||this.win.closed){var t=1048,e=800,s=(screen.width-t)/2,i=(screen.height-e)/2,a="width=".concat(t,",height=").concat(e,",left=").concat(s,",top=").concat(i,",scrollbars=yes,resizable=yes"),r=this.url;if(this.$route.query.days){var o=r.includes("?")?"&":"?";r="".concat(r).concat(o,"days=").concat(this.$route.query.days)}this.win=window.open(r,"_blank",a)}this.win.focus()}catch(n){console.error("打开新窗口失败:",n),window.location.href=this.url}},openSettings:function(){console.log("openSettings")}}},f=m,p=(s("27d3"),Object(d["a"])(f,i,a,!1,null,"5785de42",null));e["a"]=p.exports}}]);