(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-8103a186","chunk-52829884","chunk-22096c5e"],{"243c":function(e,t,a){"use strict";a("d3b7")},2792:function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("GenericCreateUpdatePage",e._b({attrs:{fields:e.fields,"fields-meta":e.fieldsMeta,initial:e.initial,url:e.url}},"GenericCreateUpdatePage",e.$data,!1))},s=[],l=(a("28a5"),a("2caf"),a("7f7f"),a("cd4a")),i=a("1307"),c=a("5ebc"),o=a("992f"),u=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-radio-group",{on:{input:e.handleTypeChange},model:{value:e.type,callback:function(t){e.type=t},expression:"type"}},e._l(e.types,(function(t){return a("el-radio",{key:t.name,attrs:{label:t.name}},[e._v("\n      "+e._s(t.label)+"\n    ")])})),1),e._v(" "),"spec"===e.type?a("Select2",e._b({on:{change:e.onChangeEmit},model:{value:e.selected,callback:function(t){e.selected=t},expression:"selected"}},"Select2",e.select2,!1)):e._e()],1)},r=[],d=(a("57e7"),a("49bd")),p={name:"AllOrSpec",components:{Select2:d["a"]},props:{value:{type:[Array],default:function(){return[]}},select2:{type:Object,default:function(){return{}}},resource:{type:String,default:""}},data:function(){var e=this.$t("WordSep")+this.resource.toLowerCase();return{type:"all",types:[{name:"all",label:this.$t("All")+e},{name:"spec",label:this.$t("Spec")+e}],selected:[]}},computed:{iValue:function(){return"all"===this.type?["all"]:this.selected}},mounted:function(){this.value&&0!==this.value.length&&(this.value.indexOf("all")>-1?this.type="all":(this.type="spec",this.selected=this.value))},methods:{onChangeEmit:function(){this.$emit("input",this.iValue)},handleTypeChange:function(){this.$emit("input",this.iValue)}}},h=p,f=a("2877"),m=Object(f["a"])(h,u,r,!1,null,"5295f667",null),v=m.exports,b={name:"AccountFormatter",components:{GenericCreateUpdatePage:l["c"]},data:function(){var e=this,t=[];this.$route.query["node_id"]&&t.push(this.$route.query.node_id);var a=[];return this.$route.query["asset_id"]&&a.push(this.$route.query.asset_id),{initial:{nodes:t,assets:a,accounts:[o["b"]]},fields:[[this.$t("Basic"),["name"]],[this.$t("User"),["users","user_groups"]],[this.$t("Asset"),["assets","nodes"]],[this.$t("Account"),["accounts"]],[this.$t("Protocol"),["protocols"]],[this.$t("Action"),["actions"]],[this.$t("Other"),["is_active","date_start","date_expired","comment"]]],url:"/api/v1/perms/asset-permissions/",createSuccessNextRoute:{name:"AssetPermissionDetail"},fieldsMeta:{users:{el:{value:[],ajax:{url:"/api/v1/users/users/?fields_size=mini",transformOption:function(e){return{label:e.name+"("+e.username+")",value:e.id}}}}},user_groups:{el:{value:[],url:"/api/v1/users/groups/"}},assets:{type:"assetSelect",component:i["a"],rules:[{required:!1}],el:{value:[],defaultPageSize:300,baseUrl:"/api/v1/assets/assets/?fields_size=mini",treeSetting:{showSearch:!1,showRefresh:!1}}},nodes:{el:{value:[],ajax:{url:"/api/v1/assets/nodes/",transformOption:function(e){return{label:e.full_value,value:e.id}}}}},protocols:{component:v,el:{resource:this.$t("Protocol"),select2:{url:"/api/v1/assets/protocols/",ajax:{transformOption:function(e){return{label:e.label,value:e.value}}}}}},accounts:{type:"input",component:c["a"],el:{assets:[],nodes:[]},hidden:function(t){e.fieldsMeta.accounts.el.assets=t.assets,e.fieldsMeta.accounts.el.nodes=t.nodes}},actions:{label:this.$t("Action"),helpText:this.$t("ActionsTips")},date_start:{},date_expired:{},comment:{},is_active:{type:"checkbox"}},cleanFormValue:function(e){return Array.isArray(e.accounts)||(e.accounts=e.accounts?e.accounts.split(","):[]),e}}}},A=b,g=(a("78bd"),Object(f["a"])(A,n,s,!1,null,"55d0b00c",null));t["default"]=g.exports},"3cc2":function(e,t,a){},"5ebc":function(e,t,a){"use strict";var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-form",{staticClass:"account-content",nativeOn:{submit:function(e){e.preventDefault()}}},[a("el-form-item",[a("el-radio-group",{on:{input:e.handleRadioChanged},model:{value:e.realRadioSelected,callback:function(t){e.realRadioSelected=t},expression:"realRadioSelected"}},e._l(e.realChoices,(function(t){return a("el-radio",{key:t.label,attrs:{disabled:t.disabled,label:t.value}},[e._v("\n        "+e._s(t.label)+"\n        "),t.tip?a("el-tooltip",{attrs:{content:t.tip,"open-delay":500,placement:"top"}},[a("i",{staticClass:"fa fa-question-circle-o"})]):e._e()],1)})),1),e._v(" "),e.showSpecZone?a("div",{staticClass:"spec-accounts spec-zone"},[a("div",{staticClass:"group-title"},[e._v(e._s(e.$t("SpecAccount")))]),e._v(" "),a("TagInput",{attrs:{autocomplete:e.autocomplete,"tag-type":e.getTagType},on:{change:e.handleTagChange},model:{value:e.specAccountsInput,callback:function(t){e.specAccountsInput=t},expression:"specAccountsInput"}}),e._v(" "),e.showAddTemplate?a("span",[a("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(t){e.showTemplateDialog=!0}}},[e._v("\n          "+e._s(e.$t("TemplateAdd"))+"\n        ")]),e._v(" "),a("span",{staticClass:"help-block"},[e._v("\n          "+e._s(e.addTemplateHelpText)+"\n        ")])],1):e._e()],1):e._e(),e._v(" "),e.enableVirtualAccount?a("div",{staticClass:"spec-zone virtual-choices"},[a("el-checkbox",{on:{change:e.handleVirtualChecked},model:{value:e.virtualChecked,callback:function(t){e.virtualChecked=t},expression:"virtualChecked"}},[e._v("\n        "+e._s(e.virtualAccount.label)+"\n      ")]),e._v(" "),e.virtualChecked?a("el-select",{attrs:{multiple:!0,placeholder:e.$t("SelectVirtualAccount")},on:{change:e.handleVirtualChecked},model:{value:e.virtualSelected,callback:function(t){e.virtualSelected=t},expression:"virtualSelected"}},e._l(e.virtualAccounts,(function(t){return a("el-option",{key:t.label,attrs:{label:t.label,value:t.value}},[e._v("\n          "+e._s(t.label)+"\n          "),a("el-tooltip",{attrs:{content:t.tip,"open-delay":500,placement:"top"}},[a("i",{staticClass:"fa fa-question-circle-o"})])],1)})),1):e._e()],1):e._e()],1),e._v(" "),e.showTemplateDialog?a("Dialog",{attrs:{title:e.$tc("AccountTemplate"),visible:e.showTemplateDialog},on:{"update:visible":function(t){e.showTemplateDialog=t},cancel:e.handleAccountTemplateCancel,confirm:e.handleAccountTemplateConfirm}},[a("ListTable",e._b({ref:"templateTable"},"ListTable",e.accountTemplateTable,!1))],1):e._e()],1)},s=[],l=a("75fc"),i=(a("f559"),a("6762"),a("2fdb"),a("57e7"),a("7618")),c=(a("6d67"),a("d25f"),a("f823")),o=a("992f"),u=a("af7d"),r=a("9039"),d={components:{TagInput:c["k"],ListTable:u["a"],Dialog:r["a"]},props:{value:{type:[Array,String],default:function(){return[]}},assets:{type:[Array],default:function(){return[]}},nodes:{type:[Array],default:function(){return[]}},oid:{type:String,default:""},showAddTemplate:{type:Boolean,default:!0},enableVirtualAccount:{type:Boolean,default:!0},addTemplateHelpText:{type:String,default:function(){return this.$t("TemplateHelpText")}}},data:function(){var e=this,t=this,a="@VIRTUAL";return{ALL:o["b"],SPEC:o["j"],VIRTUAL:a,EXCLUDE:o["h"],showTemplateDialog:!1,realRadioSelected:this.ALL,realChoices:o["m"],virtualChecked:!1,virtualSelected:[],output:[],excludeAccountsInput:[],virtualAccounts:o["o"],virtualAccountsNames:[o["f"],o["i"],o["c"]],specAccountsInput:[],specAccountsTemplate:[],showSpecZone:!1,getTagType:function(e){return t.specAccountsTemplate.filter((function(t){return t.username===e})).length>0?"primary":"info"},showExcludeZone:!1,accountTemplateTable:o["l"],autocomplete:function(a,n){var s={username:a,assets:e.assets.slice(0,20),nodes:e.nodes.slice(0,20).map((function(e){return"object"===Object(i["a"])(e)?e.pk:e}))};e.$axios.post("/api/v1/accounts/accounts/username-suggestions/",s,{params:{oid:e.oid}}).then((function(e){e||(e=[]);var a=e.filter((function(e){return-1===t.value.indexOf(e)})).map((function(e){return{value:e,label:e}}));n(a)}))}}},computed:{virtualAccount:function(){return o["n"]}},watch:{realRadioSelected:{handler:function(e){this.showSpecZone=e===this.SPEC,this.showExcludeZone=e===this.EXCLUDE},sync:!0}},mounted:function(){this.initDefaultChoice()},methods:{getVirtualChoices:function(e){return this.virtualAccounts.filter((function(t){return e.includes(t.value)})).map((function(e){return e.value}))},getExcludeChoices:function(e){return e.filter((function(e){return e.startsWith("!")})).map((function(e){return e.substring(1)}))},getSpecValues:function(e){return e.filter((function(e){return!e.startsWith("@")&&!e.startsWith("!")}))},initDefaultChoice:function(){var e=this.value||[],t=this.getSpecValues(e),a=e.includes(this.ALL);a?this.realRadioSelected=this.ALL:t.length>0||e.includes(this.SPEC)?(this.realRadioSelected=this.SPEC,this.specAccountsInput=t):this.realRadioSelected=o["g"];var n=this.getVirtualChoices(this.value);n.length>0&&(this.virtualChecked=!0,this.virtualSelected=n)},handleAccountTemplateCancel:function(){this.showTemplateDialog=!1},handleAccountTemplateConfirm:function(){var e=this;this.specAccountsTemplate=this.$refs.templateTable.selectedRows;var t=this.specAccountsTemplate.map((function(e){return e.username}));this.specAccountsInput=this.specAccountsInput.filter((function(e){return!t.includes(e)})).concat(t),this.outputValue(),setTimeout((function(){e.showTemplateDialog=!1,e.outputValue()}),100)},handleVirtualChecked:function(e,t){this.outputValue()},handleRadioChanged:function(e){this.outputValue()},handleTagChange:function(){this.outputValue()},outputValue:function(){var e=[];if(this.realRadioSelected===this.ALL)e=[this.ALL];else if(this.realRadioSelected===this.SPEC&&this.showSpecZone){var t=this.specAccountsTemplate.map((function(e){return"%".concat(e.id)}));e=[this.realRadioSelected].concat(Object(l["a"])(this.specAccountsInput),Object(l["a"])(t))}else this.realRadioSelected===o["g"]&&(e=[]);this.virtualChecked&&(e=[].concat(Object(l["a"])(e),Object(l["a"])(this.virtualSelected))),this.$log.debug("choicesSelected",e),this.$emit("input",e),this.$emit("change",e)}}},p=d,h=(a("243c"),a("2877")),f=Object(h["a"])(p,n,s,!1,null,"202e51b6",null);t["a"]=f.exports},7:function(e,t){},"78bd":function(e,t,a){"use strict";a("db80")},"992f":function(e,t,a){"use strict";a.d(t,"k",(function(){return c})),a.d(t,"e",(function(){return o})),a.d(t,"d",(function(){return u})),a.d(t,"b",(function(){return r})),a.d(t,"j",(function(){return d})),a.d(t,"h",(function(){return p})),a.d(t,"i",(function(){return h})),a.d(t,"f",(function(){return f})),a.d(t,"c",(function(){return m})),a.d(t,"g",(function(){return v})),a.d(t,"a",(function(){return b})),a.d(t,"n",(function(){return A})),a.d(t,"m",(function(){return g})),a.d(t,"o",(function(){return _})),a.d(t,"l",(function(){return y}));var n=a("bd86"),s=(a("a481"),a("6d67"),a("0692")),l=a("b318"),i=a("62f3"),c=[{label:s["a"].t("Name"),value:"name"},{label:s["a"].t("Username"),value:"username"},{label:s["a"].t("UserGroups"),value:"user_group"},{label:s["a"].t("AssetName"),value:"asset_name"},{label:s["a"].t("AssetAddress"),value:"address"},{label:s["a"].t("Account"),value:"accounts"},{label:s["a"].t("Valid"),value:"is_valid",children:[{value:"1",label:s["a"].t("Yes")},{value:"0",label:s["a"].t("No")}]},{label:s["a"].t("Effective"),value:"is_effective",children:[{value:"1",label:s["a"].t("Yes")},{value:"0",label:s["a"].t("No")}]},{label:s["a"].t("FromTicket"),value:"from_ticket",children:[{value:"1",label:s["a"].t("Yes")},{value:"0",label:s["a"].t("No")}]}],o={name:{formatter:i["a"],minWidth:"120px",formatterArgs:{route:"AssetPermissionDetail",drawer:!0,routeQuery:{tab:"Basic"}}},action:{label:s["a"].t("Action"),formatter:function(e){return 6===e.actions.length?s["a"].t("All"):e.actions.map((function(e){return e.label.replace(/ \([^)]*\)/,"")})).join(",")}},is_expired:{formatterArgs:{showFalse:!1}},from_ticket:{width:"130px",formatterArgs:{showFalse:!1}},users_amount:{width:80,formatter:l["a"],formatterArgs:{async:!0,route:"AssetPermissionDetail",drawer:!0,routeQuery:{tab:"AssetPermissionUser"}}},user_groups_amount:{width:80,formatter:l["a"],formatterArgs:{async:!0,drawer:!0,route:"AssetPermissionDetail",routeQuery:{tab:"AssetPermissionUser"}}},assets_amount:{width:80,formatter:l["a"],formatterArgs:{async:!0,drawer:!0,route:"AssetPermissionDetail",routeQuery:{tab:"AssetPermissionAsset"}}},nodes_amount:{width:80,formatter:l["a"],formatterArgs:{async:!0,drawer:!0,route:"AssetPermissionDetail",routeQuery:{tab:"AssetPermissionAsset"}}},accounts:{width:80,formatter:l["a"],formatterArgs:{cellValueToRemove:["@SPEC"],drawer:!0,getItem:function(e){if("@SPEC"!==e)return b[e]||e},route:"AssetPermissionDetail",routeQuery:{tab:"AssetPermissionAccount"}}},actions:{formatterArgs:{updateRoute:"AssetPermissionUpdate",cloneRoute:"AssetPermissionCreate",performDelete:function(e){var t=e.row,a=(e.col,t.id),n="/api/v1/perms/asset-permissions/".concat(a,"/");return this.$axios.delete(n)}}}},u=[].concat(c,[{label:s["a"].t("NodeSearchStrategy"),value:"all",children:[{value:"0",label:s["a"].t("OnlySearchCurrentNodePerm")},{value:"1",label:s["a"].t("SearchAncestorNodePerm")}]}]),r="@ALL",d="@SPEC",p="@NOT",h="@USER",f="@INPUT",m="@ANON",v="@NONE",b=Object(n["a"])(Object(n["a"])(Object(n["a"])(Object(n["a"])(Object(n["a"])(Object(n["a"])(Object(n["a"])({},r,s["a"].t("AllAccounts")),d,s["a"].t("SpecAccount")),p,s["a"].t("ExcludeAccount")),v,s["a"].t("None")),h,s["a"].t("SameAccount")),f,s["a"].t("ManualAccount")),m,s["a"].t("AnonymousAccount")),A={label:s["a"].t("VirtualAccounts"),value:"@VIRTUAL",tip:s["a"].t("VirtualAccountHelpMsg")},g=[{label:b[r],value:r,tip:s["a"].t("AllAccountTip")},{label:b[d],value:d,tip:s["a"].t("SpecAccountTip")},{label:b[v],value:v}],_=[{label:b[f],value:f,tip:s["a"].t("ManualAccountTip")},{label:b[h],value:h,tip:s["a"].t("SameAccountTip")},{label:b[m],value:m,tip:s["a"].t("AnonymousAccountTip")}],y={tableConfig:{url:"/api/v1/accounts/account-templates/",columns:["name","username","has_secret","comment","date_created","date_updated"],columnsMeta:{name:{formatterArgs:{openInNewPage:!0,getRoute:function(e){var t=e.row;e.col,e.cellValue;return{name:"AccountTemplateDetail",params:{id:t.id}}}}},has_secret:{formatterArgs:{showFalse:!1}},actions:{has:!1}}},headerActions:{hasLeftActions:!1,hasImport:!1,hasExport:!1}}},b708:function(e,t,a){},c0eb:function(e,t,a){"use strict";var n=a("c5ec"),s=a.n(n);window.$=s.a,window.jQuery=s.a,t["a"]=s.a},d3b7:function(e,t,a){},db80:function(e,t,a){}}]);