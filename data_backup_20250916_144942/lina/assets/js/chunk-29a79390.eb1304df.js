(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-29a79390","chunk-52829884","chunk-24fad8a0"],{"0482":function(e,t,r){},"273b":function(e,t,r){"use strict";r("0482")},"387d":function(e,t,r){"use strict";r.d(t,"c",(function(){return i})),r.d(t,"a",(function(){return a})),r.d(t,"b",(function(){return s}));r("7f7f");var n=r("f823"),i=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return{component:n["c"],el:{value:[],resource:e.$t("Users"),select2:{url:"/api/v1/users/users/",ajax:{transformOption:function(e){return{label:e.name+"("+e.username+")",value:e.id}}}},attrs:[{name:"name",label:e.$t("Name"),inTable:!0},{name:"username",label:e.$t("Username"),inTable:!0},{name:"email",label:e.$t("Email"),inTable:!0},{name:"comment",label:e.$t("Comment"),inTable:!0},{name:"is_active",label:e.$t("IsActive"),type:"bool"},{name:"is_first_login",label:e.$t("FirstLogin"),type:"bool"},{name:"system_roles",type:"m2m",label:e.$t("SystemRoles"),el:{url:"/api/v1/rbac/system-roles/?fields_size=mini",ajax:{transformOption:function(e){return{label:e.display_name,value:e.id}}},displayField:"display_name"}},{name:"org_roles",label:e.$t("OrgRoles"),type:"m2m",el:{url:"/api/v1/rbac/org-roles/",ajax:{transformOption:function(e){return{label:e.display_name,value:e.id}}},displayField:"display_name"},disabled:t},{name:"groups",label:e.$t("UserGroups"),type:"m2m",el:{url:"/api/v1/users/groups/?fields_size=mini"}},{name:"labels",label:e.$t("Tags"),type:"m2m",el:{multiple:!0,url:"/api/v1/assets/labels/",ajax:{transformOption:function(e){return{label:"".concat(e.name,":").concat(e.value),value:e.id}}}}}]}}},a={allUsers:3,onlyAdminUsers:4},s={notEnable:0,allUsers:1,onlyAdminUsers:2}},"3cc2":function(e,t,r){},6306:function(e,t,r){},7:function(e,t){},b708:function(e,t,r){},bd11:function(e,t){e.exports=b,e.exports.match=o,e.exports.regexpToFunction=l,e.exports.parse=i,e.exports.compile=s,e.exports.tokensToFunction=u,e.exports.tokensToRegExp=g;var r="/",n=new RegExp(["(\\\\.)","(?:\\:(\\w+)(?:\\(((?:\\\\.|[^\\\\()])+)\\))?|\\(((?:\\\\.|[^\\\\()])+)\\))([+*?])?"].join("|"),"g");function i(e,t){var i,s=[],o=0,l=0,u="",c=t&&t.delimiter||r,p=t&&t.whitelist||void 0,f=!1;while(null!==(i=n.exec(e))){var m=i[0],h=i[1],g=i.index;if(u+=e.slice(l,g),l=g+m.length,h)u+=h[1],f=!0;else{var b="",v=i[2],y=i[3],_=i[4],w=i[5];if(!f&&u.length){var O=u.length-1,x=u[O],$=!p||p.indexOf(x)>-1;$&&(b=x,u=u.slice(0,O))}u&&(s.push(u),u="",f=!1);var j="+"===w||"*"===w,U="?"===w||"*"===w,R=y||_,A=b||c,M=b||("string"===typeof s[s.length-1]?s[s.length-1]:"");s.push({name:v||o++,prefix:b,delimiter:A,optional:U,repeat:j,pattern:R?d(R):a(A,c,M)})}}return(u||l<e.length)&&s.push(u+e.substr(l)),s}function a(e,t,r){var n="[^"+c(e===t?e:e+t)+"]";return!r||r.indexOf(e)>-1||r.indexOf(t)>-1?n+"+?":c(r)+"|(?:(?!"+c(r)+")"+n+")+?"}function s(e,t){return u(i(e,t),t)}function o(e,t){var r=[],n=b(e,r,t);return l(n,r)}function l(e,t){return function(r,n){var i=e.exec(r);if(!i)return!1;for(var a=i[0],s=i.index,o={},l=n&&n.decode||decodeURIComponent,u=1;u<i.length;u++)if(void 0!==i[u]){var c=t[u-1];c.repeat?o[c.name]=i[u].split(c.delimiter).map((function(e){return l(e,c)})):o[c.name]=l(i[u],c)}return{path:a,index:s,params:o}}}function u(e,t){for(var r=new Array(e.length),n=0;n<e.length;n++)"object"===typeof e[n]&&(r[n]=new RegExp("^(?:"+e[n].pattern+")$",p(t)));return function(t,n){for(var i="",a=n&&n.encode||encodeURIComponent,s=!n||!1!==n.validate,o=0;o<e.length;o++){var l=e[o];if("string"!==typeof l){var u,c=t?t[l.name]:void 0;if(Array.isArray(c)){if(!l.repeat)throw new TypeError('Expected "'+l.name+'" to not repeat, but got array');if(0===c.length){if(l.optional)continue;throw new TypeError('Expected "'+l.name+'" to not be empty')}for(var d=0;d<c.length;d++){if(u=a(c[d],l),s&&!r[o].test(u))throw new TypeError('Expected all "'+l.name+'" to match "'+l.pattern+'"');i+=(0===d?l.prefix:l.delimiter)+u}}else if("string"!==typeof c&&"number"!==typeof c&&"boolean"!==typeof c){if(!l.optional)throw new TypeError('Expected "'+l.name+'" to be '+(l.repeat?"an array":"a string"))}else{if(u=a(String(c),l),s&&!r[o].test(u))throw new TypeError('Expected "'+l.name+'" to match "'+l.pattern+'", but got "'+u+'"');i+=l.prefix+u}}else i+=l}return i}}function c(e){return e.replace(/([.+*?=^!:${}()[\]|/\\])/g,"\\$1")}function d(e){return e.replace(/([=!:$/()])/g,"\\$1")}function p(e){return e&&e.sensitive?"":"i"}function f(e,t){if(!t)return e;var r=e.source.match(/\((?!\?)/g);if(r)for(var n=0;n<r.length;n++)t.push({name:n,prefix:null,delimiter:null,optional:!1,repeat:!1,pattern:null});return e}function m(e,t,r){for(var n=[],i=0;i<e.length;i++)n.push(b(e[i],t,r).source);return new RegExp("(?:"+n.join("|")+")",p(r))}function h(e,t,r){return g(i(e,r),t,r)}function g(e,t,n){n=n||{};for(var i=n.strict,a=!1!==n.start,s=!1!==n.end,o=n.delimiter||r,l=[].concat(n.endsWith||[]).map(c).concat("$").join("|"),u=a?"^":"",d=0;d<e.length;d++){var f=e[d];if("string"===typeof f)u+=c(f);else{var m=f.repeat?"(?:"+f.pattern+")(?:"+c(f.delimiter)+"(?:"+f.pattern+"))*":f.pattern;t&&t.push(f),f.optional?f.prefix?u+="(?:"+c(f.prefix)+"("+m+"))?":u+="("+m+")?":u+=c(f.prefix)+"("+m+")"}}if(s)i||(u+="(?:"+c(o)+")?"),u+="$"===l?"$":"(?="+l+")";else{var h=e[e.length-1],g="string"===typeof h?h[h.length-1]===o:void 0===h;i||(u+="(?:"+c(o)+"(?="+l+"))?"),g||(u+="(?="+c(o)+"|"+l+")")}return new RegExp(u,p(n))}function b(e,t,r){return e instanceof RegExp?f(e,t):Array.isArray(e)?m(e,t,r):h(e,t,r)}},c0eb:function(e,t,r){"use strict";var n=r("c5ec"),i=r.n(n);window.$=i.a,window.jQuery=i.a,t["a"]=i.a},c97f:function(e,t,r){"use strict";r("6306")},e323:function(e,t,r){"use strict";var n=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"content"},[e.hasButton?r("el-button",{staticClass:"proto-setting",attrs:{disabled:!e.canSetting,icon:e.icon,size:"small",type:"primary"},on:{click:e.onSetting}}):e._e(),e._v(" "),r("Dialog",{attrs:{"show-cancel":!1,"show-confirm":!1,title:e.title,visible:e.isVisible,width:"60%"},on:{"update:visible":function(t){e.isVisible=t},close:e.onDialogClose}},[r("AutoDataForm",e._g(e._b({ref:"autoDataForm",staticClass:"data-form",attrs:{form:e.form},on:{submit:e.onSubmit}},"AutoDataForm",e.config,!1),e.$listeners))],1)],1)},i=[],a=(r("1c01"),r("58b2"),r("8e6e"),r("f3e2"),r("d25f"),r("bd86")),s=r("768b"),o=(r("ffc1"),r("6762"),r("2fdb"),r("ac6a"),r("456d"),r("96cf"),r("3b8d")),l=r("9039"),u=r("c75f"),c=r("f823");function d(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function p(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?d(Object(r),!0).forEach((function(t){Object(a["a"])(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):d(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var f={components:{Dialog:l["a"],AutoDataForm:u["a"]},props:{value:{type:[String,Object],default:function(){return{}}},title:{type:String,default:function(){return this.$t("PushParams")}},btnText:{type:String,default:function(){return""}},icon:{type:String,default:"el-icon-setting"},url:{type:String,default:"/api/v1/assets/platform-automation-methods/"},method:{type:String,default:""},pushAccountParams:{type:Object,default:function(){return{}}},visible:{type:Boolean,default:!1},hasButton:{type:Boolean,default:!0}},data:function(){return{isVisible:this.visible,canSetting:!0,form:this.value,remoteMeta:{},config:{url:this.url,hasSaveContinue:!1,hasButtons:!0,hasReset:!1,fields:[],method:"get"},preFieldsMeta:{change_secret_by_ssh:{commands:{helpTextAsTip:!1}}}}},watch:{visible:function(e){this.isVisible=e},method:function(e,t){e!==t&&this.getUrlMeta()}},mounted:function(){this.getUrlMeta()},methods:{getUrlMeta:function(){var e=Object(o["a"])(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.$store.dispatch("common/getUrlMeta",{url:this.url});case 2:t=e.sent,this.remoteMeta=t.actions[this.config.method.toUpperCase()]||{},this.onCanSetting()&&this.setFormConfig();case 5:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),onCanSetting:function(){var e=Object.keys(this.remoteMeta);return this.canSetting=e.includes(this.method)&&this.$hasPerm("assets.change_platform"),this.$emit("canSetting",this.canSetting),this.canSetting},setFormConfig:function(){var e=[],t={},r=this.method,n=this.remoteMeta[r];e=[[n.label,[r]]],t[r]={fields:[],fieldsMeta:{}};var i=this.pushAccountParams[r];if(Object.keys((null===n||void 0===n?void 0:n.children)||{}).length>0)for(var a=0,o=Object.entries(n.children);a<o.length;a++){var l=Object(s["a"])(o[a],2),u=l[0],d=l[1],f="el-input",m={};switch(null===d||void 0===d?void 0:d.type){case"list":f=c["b"];break;case"boolean":f=c["j"];break;case"text":m["text"]="textarea";break}i&&(d.default=i[u]||d.default);var h=p(p({},d),{},{component:f,el:m});t[r].fields.push(u),t[r].fieldsMeta[u]=h}var g=this.preFieldsMeta[r];if(g)for(var b=0,v=Object.entries(g);b<v.length;b++)for(var y=Object(s["a"])(v[b],2),_=y[0],w=y[1],O=0,x=Object.entries(w);O<x.length;O++){var $=Object(s["a"])(x[O],2),j=$[0],U=$[1];t[r]["fieldsMeta"][_][j]=U}this.config.fields=e,this.config.fieldsMeta=t},onSetting:function(){this.isVisible=!0},onSubmit:function(e){this.$emit("input",e),this.isVisible=!1,this.$emit("update:visible",this.isVisible)},onDialogClose:function(){this.$emit("update:visible",this.isVisible)}}},m=f,h=(r("273b"),r("2877")),g=Object(h["a"])(m,n,i,!1,null,"2772642f",null);t["a"]=g.exports},eb82:function(e,t,r){"use strict";r.r(t);var n=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}]},[e.loading?e._e():r("GenericCreateUpdatePage",e._g(e._b({staticClass:"user-create-update",on:{getObjectDone:e.afterGetUser}},"GenericCreateUpdatePage",e.$data,!1),e.$listeners))],1)},i=[],a=(r("1c01"),r("58b2"),r("8e6e"),r("ac6a"),r("456d"),r("7f7f"),r("d25f"),r("f3e2"),r("96cf"),r("3b8d")),s=r("bd86"),o=(r("57e7"),r("6d67"),r("4360")),l=r("2f62"),u=r("2af9"),c=r("cd4a"),d=r("f823"),p=r("5cba"),f=r("387d");function m(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function h(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?m(Object(r),!0).forEach((function(t){Object(s["a"])(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):m(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var g={components:{GenericCreateUpdatePage:c["c"]},data:function(){var e=this,t=this.$createElement,r=this.$t("RoleManage");return{loading:!0,initial:{need_update_password:!0,system_roles:[],org_roles:[]},user:{can_public_key_auth:!1},fields:[[this.$t("Basic"),["name","username","email","groups"]],[this.$t("Authentication"),["password_strategy","update_password","password","need_update_password","mfa_level","source"]],[this.$t("Secure"),["system_roles","org_roles","is_active","date_expired"]],[this.$t("Other"),["phone","comment"]]],url:"/api/v1/users/users/",fieldsMeta:{name:{},username:{},password_strategy:{hidden:function(t){return e.$route.params.id||"local"!==t.source}},mfa_level:{disabled:!1},email:{rules:[p["f"].EmailCheck,p["f"].Required]},update_password:{label:this.$t("ChangePassword"),type:"checkbox",hidden:function(t){return!!t.update_password||("local"!==t.source||"update"!==e.$route.params.action)}},password:{component:d["o"],hidden:function(e){return"local"!==e.source||"custom"!==e.password_strategy&&!e.update_password},el:{required:!1,userIsOrgAdmin:!1}},need_update_password:{label:"",type:"checkbox-group",component:null,el:{style:"margin-bottom: -10px"},options:[{label:this.$t("ResetPasswordNextLogin"),value:!0}],hidden:function(e){return"local"!==e.source||"custom"!==e.password_strategy&&!e.update_password}},system_roles:{component:u["q"],rules:[p["f"].Required],el:{multiple:!0,ajax:{url:"/api/v1/rbac/system-roles/?id!=00000000-0000-0000-0000-000000000004",transformOption:function(e){return{label:e.display_name,value:e.id}}}},hidden:function(){return!e.$hasPerm("rbac.add_systemrolebinding")},value:[]},org_roles:{component:u["q"],label:this.$t("OrgRoles"),rules:this.$store.getters.currentOrgIsRoot?[]:[p["f"].RequiredChange],helpTextFormatter:function(){var n=function(){e.$router.push({name:"RoleList"})};return t("el-link",{on:{click:n}},[t("i",{class:"fa fa-external-link"})," ",r])},el:{multiple:!0,ajax:{url:"/api/v1/rbac/org-roles/",transformOption:function(e){return{label:e.display_name,value:e.id}}},disabled:this.$store.getters.currentOrgIsRoot,value:[]},hidden:function(){return!e.$store.getters.hasValidLicense||!e.$hasPerm("rbac.add_orgrolebinding")||e.$store.getters.currentOrgIsRoot}},groups:{helpTextAsPlaceholder:!0,el:{multiple:!0,disabled:this.$store.getters.currentOrgIsRoot,ajax:{url:"/api/v1/users/groups/"},value:[]}},phone:{component:d["h"]},is_active:{label:this.$t("IsActive"),el:{}}},submitMethod:function(){var e=this.$route.params;return e.id?"put":"post"},afterGetFormValue:function(e){var t,r;null!==e&&void 0!==e&&e.id&&(e.org_roles=null===(t=e.org_roles)||void 0===t?void 0:t.map((function(e){var t=e.id;return t})),e.system_roles=null===(r=e.system_roles)||void 0===r?void 0:r.map((function(e){var t=e.id;return t})),e.mfa_level.value=this.initial.mfa_level||e.mfa_level.value);return e},cleanFormValue:function(e){var t=this.submitMethod();return"post"===t&&"email"===e.password_strategy&&(delete e["password"],this.currentOrgIsRoot&&delete e["groups"]),void 0!==e.update_password&&delete e.update_password,"local"!==e.source&&delete e.need_update_password,[f["a"].allUsers,f["a"].onlyAdminUsers].indexOf(e.mfa_level)>-1&&delete e.mfa_level,e}}},computed:h({},Object(l["b"])(["currentOrgIsRoot","currentUser"])),mounted:function(){var e=Object(a["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return this.currentOrgIsRoot&&(this.fieldsMeta.groups.el.disabled=!0),e.next=3,this.setDefaultRoles();case 3:this.disableMFAFieldIfNeed(null),this.loading=!1;case 5:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),methods:{afterGetUser:function(e){var t=this;if(this.user=e,this.user.id===this.currentUser.id){var r=["system_roles","org_roles","is_active"];r.forEach((function(e){var r=t.$t("disallowSelfUpdateFields",{attr:t.fieldsMeta[e]["label"]});t.fieldsMeta[e].el.disabled=!0,t.fieldsMeta[e].helpTip=r}))}this.fieldsMeta.password.el.userIsOrgAdmin=e["is_org_admin"],this.$route.query.clone_from&&(this.user.groups=[]),this.disableMFAFieldIfNeed(e)},setDefaultRoles:function(){var e=Object(a["a"])(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.$axios.get("/api/v1/rbac/roles/");case 2:t=e.sent,this.initial.system_roles=t.filter((function(e){return"User"===e.name})).map((function(e){return e.id})),this.initial.org_roles=t.filter((function(e){return"OrgUser"===e.name})).map((function(e){return e.id}));case 5:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),disableMFAFieldIfNeed:function(e){var t=null,r=null,n=o["a"].getters.publicSettings["SECURITY_MFA_AUTH"],i=((null===e||void 0===e?void 0:e.is_superuser)||(null===e||void 0===e?void 0:e.is_org_admin))&&"update"===this.$route.meta.action&&n===f["b"].onlyAdminUsers;n===f["b"].allUsers&&(t=[{value:f["a"].allUsers,label:this.$t("MFAAllUsers")}],r=f["a"].allUsers),n===f["b"].onlyAdminUsers&&i&&(t=[{value:f["a"].onlyAdminUsers,label:this.$t("MFAOnlyAdminUsers")}],r=f["a"].onlyAdminUsers),null!==r&&null!==t&&(this.fieldsMeta["mfa_level"].options=t,this.initial.mfa_level=r)}}},b=g,v=(r("c97f"),r("2877")),y=Object(v["a"])(b,n,i,!1,null,"1e58fa4c",null);t["default"]=y.exports}}]);