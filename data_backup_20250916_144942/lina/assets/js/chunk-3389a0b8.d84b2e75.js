(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-3389a0b8","chunk-52829884"],{"0482":function(e,t,n){},"0e1d":function(e,t,n){"use strict";n("ac4d"),n("8a81"),n("5df3"),n("1c4c"),n("6b54"),n("87b3");var a=n("75fc"),s=(n("6d67"),n("0cd8"),n("2caf"),n("28a5"),n("768b")),r=(n("7f7f"),n("57e7"),n("ac6a"),n("f3e2"),n("0692")),o=n("1939"),i=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[e.isUpdate(this)?n("el-link",{attrs:{underline:!1,type:"default"},on:{click:function(t){return e.goToAssetAccountsPage()}}},[e._v("\n    "+e._s(e.$t("InAssetDetail"))+"\n  ")]):n("div",{staticClass:"accounts el-data-table"},[n("el-table",{staticClass:"el-table--fit el-table--border",attrs:{data:e.accounts}},[n("el-table-column",{attrs:{label:e.$tc("Name"),prop:"name"}}),e._v(" "),n("el-table-column",{attrs:{label:e.$tc("Username"),prop:"username"}}),e._v(" "),n("el-table-column",{attrs:{label:e.$tc("Privileged"),prop:"privileged"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row["privileged"]?n("i",{staticClass:"fa fa-check text-primary"}):n("span",[e._v("-")])]}}])}),e._v(" "),n("el-table-column",{attrs:{label:e.$tc("TemplateAdd"),prop:"template"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row["template"]?n("i",{staticClass:"fa fa-check text-primary"}):n("span",[e._v("-")])]}}])}),e._v(" "),n("el-table-column",{attrs:{label:e.$tc("Actions"),align:"center","class-name":"buttons",fixed:"right",width:"135"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("el-button",{attrs:{icon:"el-icon-minus",size:"mini",type:"danger"},on:{click:function(n){return e.removeAccount(t.row)}}}),e._v(" "),n("el-button",{attrs:{disabled:!!t.row.template,icon:"el-icon-edit",size:"mini",type:"primary"},on:{click:function(n){return e.onEditClick(t.row)}}})]}}])})],1),e._v(" "),n("div",{staticClass:"actions"},[n("el-button",{attrs:{size:"mini",type:"primary"},on:{click:e.onAddClick}},[e._v("\n        "+e._s(e.$t("Add"))+"\n      ")]),e._v(" "),e.$hasLicense()||"Applets"!==e.$route.name?n("el-button",{attrs:{disabled:!e.$hasPerm("accounts.view_accounttemplate"),size:"mini",type:"success"},on:{click:e.onAddFromTemplateClick}},[e._v("\n        "+e._s(e.$t("TemplateAdd"))+"\n      ")]):e._e()],1),e._v(" "),n("AddAccountDialog",{attrs:{account:e.account,accounts:e.accounts,platform:e.platform,visible:e.addAccountDialogVisible},on:{"update:visible":function(t){e.addAccountDialogVisible=t}}}),e._v(" "),e.templateDialogVisible?n("AccountTemplateDialog",{attrs:{accounts:e.accounts,visible:e.templateDialogVisible},on:{"update:visible":function(t){e.templateDialogVisible=t}}}):e._e()],1),e._v(" "),n("Drawer",{staticClass:"detail-drawer",attrs:{title:e.$t("Account"),component:e.drawerComponent,"has-footer":!1,visible:e.drawerVisible},on:{"update:visible":function(t){e.drawerVisible=t}}})],1)},c=[],l=(n("d25f"),function(){var e=this,t=e.$createElement,n=e._self._c||t;return e.iVisible?n("Dialog",{attrs:{"destroy-on-close":!0,model:!1,"show-cancel":!1,"show-confirm":!1,title:e.$tc("AddAccount"),visible:e.iVisible,width:"800px"},on:{"update:visible":function(t){e.iVisible=t}}},[n("AccountCreateForm",{attrs:{account:e.account,"encrypt-password":!1,"label-position":"right",platform:e.platform},on:{add:e.addAccount,edit:e.editAccount}})],1):e._e()}),u=[],d=(n("20d6"),n("9039")),f=n("f422"),p={name:"AddAccountDialog",components:{Dialog:d["a"],AccountCreateForm:f["a"]},props:{platform:{type:Object,default:function(){return null}},visible:{type:Boolean,default:!1},account:{type:Object,default:function(){return{}}},accounts:{type:Array,default:function(){return[]}}},data:function(){return{}},computed:{iVisible:{get:function(){return this.visible},set:function(e){this.$emit("update:visible",e)}}},methods:{addAccount:function(e){var t=this.accounts.findIndex((function(t){return t.username===e.username}));-1!==t&&this.accounts.splice(t,1),this.accounts.push(e),this.iVisible=!1},editAccount:function(e){var t=this,n=this.accounts.findIndex((function(e){return e.username===t.account.username}));this.accounts.splice(n,1,e),this.iVisible=!1}}},h=p,m=n("2877"),b=Object(m["a"])(h,l,u,!1,null,null,null),v=b.exports,g=n("ca50"),y=n("260f"),w={name:"AssetAccounts",components:{Drawer:g["a"],AddAccountDialog:v,AccountTemplateDialog:y["a"]},props:{platform:{type:Object,default:function(){return{}}},value:{type:[Array],default:function(){return[]}},isUpdate:{type:Function,default:function(e){return e.$route.params.id}}},data:function(){var e=this.value||[];return{accounts:e,drawerRefName:null,account:{},drawerVisible:!1,initial:!1,addAccountDialogVisible:!1,templateDialogVisible:!1,drawerComponent:function(){return Promise.all([n.e("chunk-commons"),n.e("chunk-ffa07718")]).then(n.bind(null,"2dc2"))}}},watch:{accounts:{handler:function(e){(e.length>0||this.initial)&&this.$emit("input",e),e&&(this.initial=!0)},immediate:!0,deep:!0}},methods:{removeAccount:function(e){this.accounts=this.accounts.filter((function(t){return e.id&&t.id?t.id!==e.id:e.username&&t.username?t.username!==e.username:e.name!==t.name}))},onEditClick:function(e){var t=this;this.account=e,setTimeout((function(){t.addAccountDialogVisible=!0}))},onAddClick:function(){var e=this;this.account=null,setTimeout((function(){e.addAccountDialogVisible=!0}))},onAddFromTemplateClick:function(){this.templateDialogVisible=!0},onSelectTemplate:function(){},goToAssetAccountsPage:function(){var e=this.$route.params.id;"AppletHostUpdate"!==this.$router.currentRoute.name?(this.$store.dispatch("common/setDrawerActionMeta",{action:"detail",row:{},col:{},id:e}),this.drawerVisible=!0):this.$router.push({name:"AppletHostDetail",params:{id:e},query:{tab:"Accounts"}})}}},O=w,A=(n("4d4e"),Object(m["a"])(O,i,c,!1,null,"a5c27758",null)),$=A.exports,j=n("5cba"),C=n("f823");n("7319");function x(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=S(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var a=0,s=function(){};return{s:s,n:function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}},e:function(e){throw e},f:s}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,o=!0,i=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){i=!0,r=e},f:function(){try{o||null==n.return||n.return()}finally{if(i)throw r}}}}function S(e,t){if(e){if("string"===typeof e)return D(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?D(e,t):void 0}}function D(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}n.d(t,"a",(function(){return P})),n.d(t,"b",(function(){return T}));function k(e,t,n){var a=arguments.length>3&&void 0!==arguments[3]&&arguments[3];setTimeout((function(){return e.init().then((function(){var s,r="create"===e.$route.query.action&&void 0===(null===e||void 0===e||null===(s=e.$route)||void 0===s?void 0:s.query.clone_from),o=r||a,i=e.platform.protocols;if(o){if("website"===t){var c=Array.isArray(i)?i[0].setting:i.setting;n({autofill:c.autofill?c.autofill:"basic",password_selector:c.password_selector,script:c.script,submit_selector:c.submit_selector,username_selector:c.username_selector})}e.iConfig.fieldsMeta.protocols.el.choices=i}}))}),100)}var P=function(e,t,n){var i=t||e.$route.query.category,c=n||e.$route.query.type,l=[],u=[],d={address:"https://jumpserver:330"};return{address:{rules:[j["f"].specialEmojiCheck,j["f"].RequiredChange],on:{change:function(e,t){var n=Object(s["a"])(e,1),a=n[0];d.address=a},input:function(e,t){var n=Object(s["a"])(e,1),a=n[0];d.address=a}}},protocols:{component:o["a"],el:{settingReadonly:!0,choices:l,instance:d},helpText:r["a"].t("AssetProtocolHelpText"),on:{input:function(e){var t=Object(s["a"])(e,1),n=t[0],r=l.reduce((function(e,t){return e[t.name]=t["secret_types"],e}),{}),o=n.map((function(e){return e.name})).reduce((function(e,t){return r[t]?e.concat(r[t]):e}),[]);u.splice.apply(u,[0,u.length].concat(Object(a["a"])(o)))}}},platform:{el:{multiple:!1,ajax:{url:"/api/v1/assets/platforms/?category=".concat(i,"&type=").concat(c),transformOption:function(e){return{label:e.name,value:e.id}}}},on:{change:_.debounce((function(t,n){var a=Object(s["a"])(t,1),r=a[0],o=r.pk;e.platformID=o,k(e,c,n,!0)}),200),input:_.debounce((function(t,n){var a=Object(s["a"])(t,1);a[0];k(e,c,n)}),200)}},zone:{component:C["i"],disabled:!1,el:{multiple:!1,clearable:!0,ajax:{url:"/api/v1/assets/zones/"}}},accounts:{component:$,el:{platform:{},default:[]}},directory_services:{el:{url:"/api/v1/assets/directories/",disabled:!1},hidden:function(){return!1===e.platform.ds_enabled}},nodes:{rules:[j["f"].RequiredChange],el:{ajax:{url:"/api/v1/assets/nodes/",transformOption:function(e){return{label:"".concat(e.full_value),value:e.id}}},clearable:!0}},labels:{name:"labels",type:"m2m",component:C["e"],el:{multiple:!0,url:"/api/v1/labels/labels/",ajax:{transformOption:function(e){return{label:"".concat(e.name,":").concat(e.value),value:"".concat(e.id)}}}}},is_active:{type:"checkbox"},cluster:{label:r["a"].t("Cluster")},url:{label:"url"},comment:{placeholder:r["a"].t("CommentHelpText")}}},T=function(e){var t=[],n=[],s=[];return e.$axios.get("/api/v1/assets/categories/").then((function(e){var r,o=[],i=[],c=x(e);try{for(c.s();!(r=c.n()).done;){var l=r.value;t.push({value:l.value,label:l.label}),o.push.apply(o,Object(a["a"])(l.types.map((function(e){return{value:e.value,label:e.label}}))));var u,d=x(l.types);try{for(d.s();!(u=d.n()).done;){var f,p=u.value;i.push.apply(i,Object(a["a"])(null===(f=p.constraints.protocols)||void 0===f?void 0:f.map((function(e){return{value:e.name,label:e.name.toUpperCase()}}))))}}catch(h){d.e(h)}finally{d.f()}}}catch(h){c.e(h)}finally{c.f()}n.push.apply(n,Object(a["a"])(_.uniqBy(o,"value"))),s.push.apply(s,Object(a["a"])(_.uniqBy(i,"value")))})),{component:C["c"],el:{value:[],resource:e.$t("Asset"),select2:{url:"/api/v1/assets/assets/",ajax:{transformOption:function(e){return{label:e.name+"("+e.address+")",value:e.id}}}},attrs:[{name:"name",label:e.$t("Name"),inTable:!0},{name:"address",label:e.$t("Address"),type:"ip",inTable:!0},{name:"nodes",label:e.$t("Node"),type:"m2m",el:{url:"/api/v1/assets/nodes/",ajax:{transformOption:function(e){return{label:e.full_value,value:e.id}}}}},{name:"platform",label:e.$t("Platform"),type:"m2m",el:{url:"/api/v1/assets/platforms/"}},{name:"category",label:e.$t("Category"),type:"select",inTable:!0,formatter:function(e,t,n){return n.label},el:{options:t}},{name:"type",label:e.$t("Type"),type:"select",inTable:!0,formatter:function(e,t,n){return n.label},el:{options:n}},{name:"protocols",label:e.$t("Protocols"),type:"select",el:{options:s}},{name:"labels",label:e.$t("Tags"),type:"m2m",el:{multiple:!0,url:"/api/v1/assets/labels/",ajax:{transformOption:function(e){return{label:"".concat(e.name,":").concat(e.value),value:e.id}}}}},{name:"comment",label:e.$t("Comment")}]}}}},"0f21":function(e,t,n){"use strict";n.d(t,"b",(function(){return o})),n.d(t,"a",(function(){return i}));n("6d67"),n("7f7f");var a=n("3f95"),s=n("53f7"),r={pending:"0",confirmed:"1",ignored:"2"},o=function(e,t){return t||(t="/api/v1/accounts/gathered-accounts/"),{url:t,hasTree:!0,columns:["asset","username","date_last_login","address_last_login","present","remote_present","status","date_updated"],columnsShow:{default:["username","asset","address_last_login","date_last_login","status"]},columnsMeta:{asset:{formatter:s["i"],formatterArgs:{drawer:!0,can:e.$hasPerm("assets.view_asset"),getTitle:function(e){var t=e.row;return t.asset.name},getDrawerTitle:function(e){var t=e.row;return t.asset.name},getRoute:function(e){var t=e.row;return{name:"AssetDetail",params:{id:t.asset.id}}}}},username:{label:e.$t("Account"),formatter:s["i"],formatterArgs:{can:!0,getRoute:function(e){var t=e.row;return{name:"DiscoverAccountDetail",params:{id:t.id}}},drawer:!0}},present:{width:"110px"},remote_present:{width:"120px"},date_updated:{formatter:function(e,t,n){return Object(a["i"])(e.date_updated)}},address_last_login:{width:"150px"},status:{formatter:s["j"],width:"100px",formatterArgs:{confirm:function(t){var n=t.row;e.$axios.put("/api/v1/accounts/gathered-accounts/status/",{status:r.confirmed,ids:[n.id]}).then((function(e){n.status=r.confirmed})).catch((function(){n.status=e.$t("Error")}))},ignore:function(t){var n=t.row;e.$axios.put("/api/v1/accounts/gathered-accounts/status/",{status:r.ignored,ids:[n.id]}).then((function(e){n.status=r.ignored})).catch((function(){n.status=e.$t("Error")}))},remove:function(t){var n=t.row;e.deleteDialog.visible=!0,e.deleteDialog.account=n}}},actions:{formatter:s["c"],formatterArgs:{hasClone:!1,hasUpdate:!1,moreActionsTitle:e.$t("More"),onDelete:function(t){var n=t.row;e.deleteDialog.visible=!0,e.deleteDialog.account=n}}}}}},i=function(e){return{hasCreate:!1,hasImport:!1,hasExport:!0,searchConfig:{exclude:["asset","id"],options:[{label:e.$t("AssetName"),value:"asset_name"}]},extraMoreActions:[{name:"SyncSelected",title:e.$t("SyncSelected"),type:"primary",icon:"fa fa-check",can:function(t){var n=t.selectedRows;return n.length>0&&e.$hasPerm("accounts.add_account")&&!e.$store.getters.currentOrgIsRoot},callback:function(t){var n=t.selectedRows,a=n.map((function(e){return e.id}));e.$axios.put("/api/v1/accounts/gathered-accounts/status/",{ids:a,status:r.confirmed}).then((function(){e.$message.success(e.$tc("SyncSuccessMsg"))})).catch((function(t){e.$message.error(e.$tc("SyncErrorMsg "+t))}))}},{name:"SyncDeleteSelected",title:e.$t("SyncDeleteSelected"),type:"primary",icon:"fa fa-exchange",can:function(t){var n=t.selectedRows;return n.length>0&&e.$hasPerm("accounts.remove_account")&&!e.$store.getters.currentOrgIsRoot},callback:function(t){var n=t.selectedRows;e.gatherAccounts=n,e.showDeleteAccountDialog=!1,setTimeout((function(){e.showDeleteAccountDialog=!0}))}}]}}},1816:function(e,t,n){"use strict";(function(t){var a=n("440d"),s=n("9c59"),r=/^[\x00-\x20\u00a0\u1680\u2000-\u200a\u2028\u2029\u202f\u205f\u3000\ufeff]+/,o=/[\n\r\t]/g,i=/^[A-Za-z][A-Za-z0-9+-.]*:\/\//,c=/:\d+$/,l=/^([a-z][a-z0-9.+-]*:)?(\/\/)?([\\/]+)?([\S\s]*)/i,u=/^[a-zA-Z]:/;function d(e){return(e||"").toString().replace(r,"")}var f=[["#","hash"],["?","query"],function(e,t){return m(t.protocol)?e.replace(/\\/g,"/"):e},["/","pathname"],["@","auth",1],[NaN,"host",void 0,1,1],[/:(\d*)$/,"port",void 0,1],[NaN,"hostname",void 0,1,1]],p={hash:1,query:1};function h(e){var n;n="undefined"!==typeof window?window:"undefined"!==typeof t?t:"undefined"!==typeof self?self:{};var a=n.location||{};e=e||a;var s,r={},o=typeof e;if("blob:"===e.protocol)r=new g(unescape(e.pathname),{});else if("string"===o)for(s in r=new g(e,{}),p)delete r[s];else if("object"===o){for(s in e)s in p||(r[s]=e[s]);void 0===r.slashes&&(r.slashes=i.test(e.href))}return r}function m(e){return"file:"===e||"ftp:"===e||"http:"===e||"https:"===e||"ws:"===e||"wss:"===e}function b(e,t){e=d(e),e=e.replace(o,""),t=t||{};var n,a=l.exec(e),s=a[1]?a[1].toLowerCase():"",r=!!a[2],i=!!a[3],c=0;return r?i?(n=a[2]+a[3]+a[4],c=a[2].length+a[3].length):(n=a[2]+a[4],c=a[2].length):i?(n=a[3]+a[4],c=a[3].length):n=a[4],"file:"===s?c>=2&&(n=n.slice(2)):m(s)?n=a[4]:s?r&&(n=n.slice(2)):c>=2&&m(t.protocol)&&(n=a[4]),{protocol:s,slashes:r||m(s),slashesCount:c,rest:n}}function v(e,t){if(""===e)return t;var n=(t||"/").split("/").slice(0,-1).concat(e.split("/")),a=n.length,s=n[a-1],r=!1,o=0;while(a--)"."===n[a]?n.splice(a,1):".."===n[a]?(n.splice(a,1),o++):o&&(0===a&&(r=!0),n.splice(a,1),o--);return r&&n.unshift(""),"."!==s&&".."!==s||n.push(""),n.join("/")}function g(e,t,n){if(e=d(e),e=e.replace(o,""),!(this instanceof g))return new g(e,t,n);var r,i,c,l,p,y,w=f.slice(),_=typeof t,O=this,A=0;for("object"!==_&&"string"!==_&&(n=t,t=null),n&&"function"!==typeof n&&(n=s.parse),t=h(t),i=b(e||"",t),r=!i.protocol&&!i.slashes,O.slashes=i.slashes||r&&t.slashes,O.protocol=i.protocol||t.protocol||"",e=i.rest,("file:"===i.protocol&&(2!==i.slashesCount||u.test(e))||!i.slashes&&(i.protocol||i.slashesCount<2||!m(O.protocol)))&&(w[3]=[/(.*)/,"pathname"]);A<w.length;A++)l=w[A],"function"!==typeof l?(c=l[0],y=l[1],c!==c?O[y]=e:"string"===typeof c?(p="@"===c?e.lastIndexOf(c):e.indexOf(c),~p&&("number"===typeof l[2]?(O[y]=e.slice(0,p),e=e.slice(p+l[2])):(O[y]=e.slice(p),e=e.slice(0,p)))):(p=c.exec(e))&&(O[y]=p[1],e=e.slice(0,p.index)),O[y]=O[y]||r&&l[3]&&t[y]||"",l[4]&&(O[y]=O[y].toLowerCase())):e=l(e,O);n&&(O.query=n(O.query)),r&&t.slashes&&"/"!==O.pathname.charAt(0)&&(""!==O.pathname||""!==t.pathname)&&(O.pathname=v(O.pathname,t.pathname)),"/"!==O.pathname.charAt(0)&&m(O.protocol)&&(O.pathname="/"+O.pathname),a(O.port,O.protocol)||(O.host=O.hostname,O.port=""),O.username=O.password="",O.auth&&(p=O.auth.indexOf(":"),~p?(O.username=O.auth.slice(0,p),O.username=encodeURIComponent(decodeURIComponent(O.username)),O.password=O.auth.slice(p+1),O.password=encodeURIComponent(decodeURIComponent(O.password))):O.username=encodeURIComponent(decodeURIComponent(O.auth)),O.auth=O.password?O.username+":"+O.password:O.username),O.origin="file:"!==O.protocol&&m(O.protocol)&&O.host?O.protocol+"//"+O.host:"null",O.href=O.toString()}function y(e,t,n){var r=this;switch(e){case"query":"string"===typeof t&&t.length&&(t=(n||s.parse)(t)),r[e]=t;break;case"port":r[e]=t,a(t,r.protocol)?t&&(r.host=r.hostname+":"+t):(r.host=r.hostname,r[e]="");break;case"hostname":r[e]=t,r.port&&(t+=":"+r.port),r.host=t;break;case"host":r[e]=t,c.test(t)?(t=t.split(":"),r.port=t.pop(),r.hostname=t.join(":")):(r.hostname=t,r.port="");break;case"protocol":r.protocol=t.toLowerCase(),r.slashes=!n;break;case"pathname":case"hash":if(t){var o="pathname"===e?"/":"#";r[e]=t.charAt(0)!==o?o+t:t}else r[e]=t;break;case"username":case"password":r[e]=encodeURIComponent(t);break;case"auth":var i=t.indexOf(":");~i?(r.username=t.slice(0,i),r.username=encodeURIComponent(decodeURIComponent(r.username)),r.password=t.slice(i+1),r.password=encodeURIComponent(decodeURIComponent(r.password))):r.username=encodeURIComponent(decodeURIComponent(t))}for(var l=0;l<f.length;l++){var u=f[l];u[4]&&(r[u[1]]=r[u[1]].toLowerCase())}return r.auth=r.password?r.username+":"+r.password:r.username,r.origin="file:"!==r.protocol&&m(r.protocol)&&r.host?r.protocol+"//"+r.host:"null",r.href=r.toString(),r}function w(e){e&&"function"===typeof e||(e=s.stringify);var t,n=this,a=n.host,r=n.protocol;r&&":"!==r.charAt(r.length-1)&&(r+=":");var o=r+(n.protocol&&n.slashes||m(n.protocol)?"//":"");return n.username?(o+=n.username,n.password&&(o+=":"+n.password),o+="@"):n.password?(o+=":"+n.password,o+="@"):"file:"!==n.protocol&&m(n.protocol)&&!a&&"/"!==n.pathname&&(o+="@"),(":"===a[a.length-1]||c.test(n.hostname)&&!n.port)&&(a+=":"),o+=a+n.pathname,t="object"===typeof n.query?e(n.query):n.query,t&&(o+="?"!==t.charAt(0)?"?"+t:t),n.hash&&(o+=n.hash),o}g.prototype={set:y,toString:w},g.extractProtocol=b,g.location=h,g.trimLeft=d,g.qs=s,e.exports=g}).call(this,n("c8ba"))},2512:function(e,t,n){},"260f":function(e,t,n){"use strict";var a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[e.iVisible?n("Dialog",e._g(e._b({attrs:{"close-on-click-modal":!1,"confirm-title":e.$tc("Add"),"destroy-on-close":!0,model:!1,title:e.$tc("SelectTemplate"),visible:e.iVisible,width:"800px"},on:{"update:visible":function(t){e.iVisible=t},cancel:e.handleCancel,confirm:e.handleConfirm}},"Dialog",e.$attrs,!1),e.$listeners),[[n("ListTable",{ref:"listTable",attrs:{"header-actions":e.headerActions,"table-config":e.tableConfig}})]],2):e._e(),e._v(" "),e.isShowCreate?n("CreateAccountTemplateDialog",e._g({attrs:{"create-visible":e.isShowCreate},on:{"update:createVisible":function(t){e.isShowCreate=t},"update:create-visible":function(t){e.isShowCreate=t},onPerform:e.onCreateTemplatePerform}},e.$listeners)):e._e()],1)},s=[],r=(n("20d6"),n("75fc")),o=(n("57e7"),n("d25f"),n("759f"),n("7f7f"),n("6d67"),n("6b54"),n("87b3"),n("9039")),i=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[e.isVisible?n("Dialog",{attrs:{"show-cancel":!1,"show-confirm":!1,title:e.$tc("TemplateCreate"),visible:e.isVisible,width:"70%"},on:{"update:visible":function(t){e.isVisible=t}}},[n("GenericCreateUpdateForm",e._b({},"GenericCreateUpdateForm",e.formConfig,!1))],1):e._e()],1)},c=[],l=(n("1c01"),n("58b2"),n("8e6e"),n("6762"),n("2fdb"),n("456d"),n("ac6a"),n("f3e2"),n("bd86")),u=n("2af9"),d=n("d0aa"),f=n("5225");function p(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function h(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?p(Object(n),!0).forEach((function(t){Object(l["a"])(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):p(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var m={name:"EmailContent",components:{GenericCreateUpdateForm:d["a"],Dialog:u["i"]},props:{createVisible:{type:Boolean,default:!1},category:{type:String,default:"all"}},data:function(){var e=this;return{formConfig:{initial:{secret_type:"password"},url:"/api/v1/accounts/account-templates/",getUrl:function(){return"/api/v1/accounts/account-templates/"},needGetObjectDetail:!1,hasDetailInMsg:!1,fields:Object(r["a"])(Object(f["a"])(this)),fieldsMeta:h({},Object(f["b"])(this)),hasSaveContinue:!1,cleanFormValue:function(e){return Object.keys(e).forEach((function(t,n,a){["ssh_key","token","access_key"].includes(t)&&(e["secret"]=e[t],delete e[t])})),e},createSuccessNextRoute:{name:""},onPerformSuccess:function(t){e.isVisible=!1,e.$emit("onPerform")}}}},computed:{isVisible:{set:function(e){this.$emit("update:create-visible",e)},get:function(){return this.createVisible}}},methods:{}},b=m,v=n("2877"),g=Object(v["a"])(b,i,c,!1,null,null,null),y=g.exports,w={name:"AccountTemplateDialog",components:{Dialog:o["a"],ListTable:u["j"],CreateAccountTemplateDialog:y},props:{visible:{type:Boolean,default:!1},asset:{type:Object,default:function(){}},accounts:{type:Array,default:function(){return[]}},showCreate:{type:Boolean,default:!0}},data:function(){var e,t,n=this,a=this.$createElement,s=(null===(e=this.asset)||void 0===e||null===(t=e.protocols)||void 0===t?void 0:t.map((function(e){return e.name})).toString())||"";return{isShowCreate:!1,accountsSelected:[],tableConfig:{url:"/api/v1/accounts/account-templates/?protocols=".concat(s),columns:["name","username","secret_type","privileged"],columnsMeta:{name:{formatter:function(e){return a("span",[e.name])}},privileged:{width:"120px"},actions:{has:!1}},listeners:{"toggle-row-selection":function(e,t){e?n.addRowToSelect(t):n.removeRowToSelect(t)}},theRowDefaultIsSelected:function(e){return n.accounts.some((function(t){return t.id===e.id}))}},headerActions:{onCreate:function(){n.isShowCreate=!0},hasCreate:this.showCreate,hasMoreActions:!1,hasColumnSetting:!1,hasImport:!1,hasExport:!1}}},computed:{refTable:function(){return this.$refs.listTable.$refs.ListTable.$refs.dataTable.$refs.dataTable},iVisible:{get:function(){return this.visible},set:function(e){this.$emit("update:visible",e)}}},methods:{onCreateTemplatePerform:function(){this.refTable.getList()},handleConfirm:function(){var e;this.iVisible=!1;var t=this.accounts.filter((function(e){return null===e||void 0===e?void 0:e.template})).map((function(e){return e.template})),n=this.accountsSelected.filter((function(e){return-1===t.indexOf(e.id)})).map((function(e){return{template:e.id,name:e.name,username:e.username,secret_type:e.secret_type.value,privileged:e.privileged}}));(e=this.accounts).push.apply(e,Object(r["a"])(n)),this.$emit("onConfirm",this.accounts)},handleCancel:function(){this.iVisible=!1},onAddClick:function(){this.isShowCreate=!0},hasSelectValue:function(e){return this.accountsSelected.some((function(t){return t.id===e.id}))},hasSameTypeAccount:function(e){var t=this.accounts.filter((function(e){return!(null!==e&&void 0!==e&&e.id)})),n=[].concat(Object(r["a"])(t),Object(r["a"])(this.accountsSelected)),a=n.some((function(t){return e.username===t.username&&(e.secret_type.value===t.secret_type||e.secret_type.value===t.secret_type.value)}));return a&&(this.refTable.toggleRowSelection(e,!1),this.$message.error(this.$tc("SameTypeAccountTip"))),a},addRowToSelect:function(e){var t=this.hasSelectValue(e),n=this.hasSameTypeAccount(e);t||n||this.accountsSelected.push(e)},removeRowToSelect:function(e){var t=this.hasSelectValue(e);if(t){var n=this.accountsSelected.findIndex((function(t){return(null===t||void 0===t?void 0:t.id)===e.id}));this.accountsSelected.splice(n,1)}}}},_=w,O=(n("64bc"),Object(v["a"])(_,a,s,!1,null,"3e72af18",null));t["a"]=O.exports},"273b":function(e,t,n){"use strict";n("0482")},"3a10":function(e,t,n){"use strict";n("4f95")},"3cc2":function(e,t,n){},"440d":function(e,t,n){"use strict";e.exports=function(e,t){if(t=t.split(":")[0],e=+e,!e)return!1;switch(t){case"http":case"ws":return 80!==e;case"https":case"wss":return 443!==e;case"ftp":return 21!==e;case"gopher":return 70!==e;case"file":return!1}return 0!==e}},"4af8":function(e,t,n){"use strict";var a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("Dialog",{attrs:{"destroy-on-close":!0,"show-cancel":!1,"show-confirm":!1,title:e.$tc("AccountDiscover"),visible:e.iVisible,top:"35vh",width:"80%"},on:{"update:visible":function(t){e.iVisible=t},close:function(t){e.loading=!0}}},[n("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}]},[n("iframe",{staticStyle:{border:"none"},attrs:{src:e.url,title:"dialog"},on:{load:e.onIframeLoad}})])])],1)},s=[],r=n("9039"),o=n("0f21"),i={name:"AccountDiscoverDialog",components:{Dialog:r["a"]},props:{visible:{type:Boolean,default:!1},asset:{type:String,default:""}},data:function(){return{showDeleteAccountDialog:!1,loading:!0,showLoading:!0,gatherAccounts:[],config:{tableConfig:Object(o["b"])(this,"/api/v1/accounts/gathered-accounts/discover/?asset_id=".concat(this.asset)),headerActions:Object(o["a"])(this)}}},computed:{iVisible:{get:function(){return this.visible},set:function(e){this.$emit("update:visible",e)}},url:{get:function(){return"/api/v1/accounts/gather-account-executions/adhoc/?asset_id=".concat(this.asset)}}},watch:{asset:{handler:function(e){this.config.tableConfig.url="/api/v1/accounts/gathered-accounts/discover/?asset_id=".concat(e)},immediate:!0}},mounted:function(){},beforeMount:function(){},methods:{onIframeLoad:function(){this.loading=!1}}},c=i,l=(n("3a10"),n("2877")),u=Object(l["a"])(c,a,s,!1,null,"5444e475",null);t["a"]=u.exports},"4d1c":function(e,t,n){"use strict";n("2512")},"4d4e":function(e,t,n){"use strict";n("9d83")},"4f95":function(e,t,n){},5225:function(e,t,n){"use strict";n.d(t,"a",(function(){return u})),n.d(t,"b",(function(){return d}));var a=n("75fc"),s=(n("6762"),n("768b")),r=(n("7f7f"),n("dbfd")),o=n("f823"),i=n("49bd"),c=n("863c"),l=n("0692"),u=function(e){return[[e.$t("Basic"),["name","username","privileged","su_from"]],[e.$t("Secret"),["secret_type","secret_strategy","password_rules","secret","ssh_key","token","access_key","passphrase","api_key"]],[e.$t("AutoPush"),["auto_push","platforms","push_params"]],[e.$t("Other"),["comment"]]]},d=function(e){var t=Object(r["m"])(e.$route.path),n=[],u=["password","ssh_key"],d={disabled:!1};return{su_from:{component:i["a"],el:{multiple:!1,clearable:!0,ajax:{url:"/api/v1/accounts/account-templates/su-from-account-templates/?".concat(t?"template_id="+t:""),transformOption:function(e){return{label:"".concat(e.name,"(").concat(e.username,")"),value:e.id}}}}},secret_type:{type:"radio-group",on:{change:function(e,t){var n=Object(s["a"])(e,1),a=n[0];u.includes(a)?d.disabled=!1:(t({secret_strategy:"specific"}),t({auto_push:!1}),d.disabled=!0)}}},secret_strategy:{hidden:function(e){return!u.includes(e.secret_type)}},secret:{label:e.$t("Password"),component:o["m"],hidden:function(e){return"password"!==e.secret_type||"random"===e.secret_strategy}},ssh_key:{label:e.$t("PrivateKey"),el:{type:"textarea",rows:4},component:o["n"],hidden:function(e){return"ssh_key"!==e.secret_type||"random"===e.secret_strategy}},passphrase:{label:e.$t("Passphrase"),component:o["m"],hidden:function(e){return"ssh_key"!==e.secret_type||"random"===e.secret_strategy}},token:{label:e.$t("Token"),el:{type:"textarea",rows:4},hidden:function(e){return"token"!==e.secret_type||"random"===e.secret_strategy}},access_key:{label:e.$t("AccessKey"),el:{type:"textarea",rows:4},hidden:function(e){return"access_key"!==e.secret_type||"random"===e.secret_strategy}},api_key:{label:e.$t("ApiKey"),el:{type:"textarea",rows:4},hidden:function(e){return"api_key"!==e.secret_type||"random"===e.secret_strategy}},password_rules:{component:o["g"],label:l["a"].t("PasswordRule"),hidden:function(e){var t=e.secret_strategy,n=e.secret_type;return"specific"===t||"password"!==n}},platforms:{el:{multiple:!0,ajax:{url:"/api/v1/assets/platforms/",transformOption:function(e){return{label:e.name,value:e.id}}}},on:{input:function(e,t){var r=Object(s["a"])(e,1),o=r[0];n.splice(0,n.length),n.push.apply(n,Object(a["a"])(o))}},hidden:function(e){return!e["auto_push"]}},auto_push:{el:d},push_params:{component:c["a"],el:{platforms:n,method:"push_account_method"},hidden:function(e){return!e["auto_push"]}}}}},"625e5":function(e,t,n){},"64bc":function(e,t,n){"use strict";n("a9d3")},"66af6":function(e,t,n){"use strict";n.r(t);var a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("AssetTreeTable",{ref:"AssetTreeTable",attrs:{"help-tip":e.helpMessage,"table-config":e.tableConfig,"tree-setting":e.treeSetting}},[n("TreeMenu",{attrs:{slot:"rMenu",tree:e.treeRef},on:{showAll:e.showAll},slot:"rMenu"}),e._v(" "),n("BaseList",e._b({ref:"baseList",attrs:{slot:"table","add-extra-more-actions":e.addExtraMoreActions,"header-actions":e.headerActions},slot:"table"},"BaseList",e.tableConfig,!1))],1)],1)},s=[],r=(n("1c01"),n("58b2"),n("8e6e"),n("f3e2"),n("d25f"),n("ac6a"),n("456d"),n("bd86")),o=n("2af9"),i=n("2f62"),c=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("li",{staticClass:"divider"}),e._v(" "),n("li",{directives:[{name:"perms",rawName:"v-perms",value:"assets.change_assetnodes",expression:"'assets.change_assetnodes'"}],staticClass:"rmenu",attrs:{id:"m_add_asset_to_node",tabindex:"-1"},on:{click:e.rMenuAddAssetToNode}},[n("i",{staticClass:"fa fa-clone"}),e._v("  "+e._s(this.$t("AddAssetToNode"))+"\n  ")]),e._v(" "),n("li",{directives:[{name:"perms",rawName:"v-perms",value:"assets.change_assetnodes",expression:"'assets.change_assetnodes'"}],staticClass:"rmenu",attrs:{id:"m_move_asset_to_node",tabindex:"-1"},on:{click:e.rMenuMoveAssetToNode}},[n("i",{staticClass:"fa fa-scissors"}),e._v("  "+e._s(this.$t("MoveAssetToNode"))+"\n  ")]),e._v(" "),n("li",{directives:[{name:"perms",rawName:"v-perms",value:"assets.change_assetnodes",expression:"'assets.change_assetnodes'"}],staticClass:"rmenu",attrs:{id:"m_remove_asset_from_node",tabindex:"-1"},on:{click:e.rMenuRemoveAssetFromNode}},[n("i",{staticClass:"fa fa-minus-square-o"}),e._v("  "+e._s(this.$t("RemoveAssetFromNode"))+"\n  ")]),e._v(" "),e.$hasPerm("assets.change_assetnodes")?n("li",{staticClass:"divider"}):e._e(),e._v(" "),n("li",{directives:[{name:"perms",rawName:"v-perms",value:"assets.refresh_assethardwareinfo",expression:"'assets.refresh_assethardwareinfo'"}],staticClass:"rmenu",attrs:{id:"m_update_node_asset_hardware_info",tabindex:"-1"},on:{click:e.rMenuUpdateNodeAssetHardwareInfo}},[n("i",{staticClass:"fa fa-refresh"}),e._v("  "+e._s(this.$t("UpdateNodeAssetHardwareInfo"))+"\n  ")]),e._v(" "),n("li",{directives:[{name:"perms",rawName:"v-perms",value:"assets.test_assetconnectivity",expression:"'assets.test_assetconnectivity'"}],staticClass:"rmenu",attrs:{id:"m_test_node_asset_connectivity",tabindex:"-1"},on:{click:e.rMenuTestNodeAssetConnectivity}},[n("i",{staticClass:"fa fa-link"}),e._v("  "+e._s(this.$t("TestNodeAssetConnectivity"))+"\n  ")]),e._v(" "),e.$hasPerm("assets.change_assetnodes | assets.test_assetconnectivity")?n("li",{staticClass:"divider"}):e._e(),e._v(" "),n("li",{staticClass:"rmenu",attrs:{id:"m_show_asset_only_current_node",tabindex:"-1"},on:{click:e.rMenuShowAssetOnlyCurrentNode}},[n("i",{staticClass:"fa fa-indent"}),e._v("  "+e._s(this.$t("ShowAssetOnlyCurrentNode"))+"\n  ")]),e._v(" "),n("li",{staticClass:"rmenu",attrs:{id:"m_show_asset_all_children_node",tabindex:"-1"},on:{click:e.rMenuShowAssetAllChildrenNode}},[n("i",{staticClass:"fa fa-align-justify"}),e._v("  "+e._s(this.$t("ShowAssetAllChildrenNode"))+"\n  ")]),e._v(" "),n("li",{staticClass:"divider"}),e._v(" "),n("li",{directives:[{name:"perms",rawName:"v-perms",value:"assets.change_node",expression:"'assets.change_node'"}],staticClass:"rmenu",attrs:{id:"m_check_assets_amount",tabindex:"-1"},on:{click:e.rCheckAssetsAmount}},[n("i",{staticClass:"fa fa-clone"}),e._v("  "+e._s(this.$t("CheckAssetsAmount"))+"\n  ")]),e._v(" "),n("li",{staticClass:"rmenu",attrs:{id:"m_show_node_info",tabindex:"-1"},on:{click:e.rMenuShowNodeInfo}},[n("i",{staticClass:"fa fa-info-circle"}),e._v("  "+e._s(this.$t("ShowNodeInfo"))+"\n  ")]),e._v(" "),e.nodeAssetsUpdateDialog.visible?n("NodeAssetsUpdateDialog",e._b({attrs:{visible:e.nodeAssetsUpdateDialog.visible},on:{"update:visible":function(t){return e.$set(e.nodeAssetsUpdateDialog,"visible",t)}}},"NodeAssetsUpdateDialog",e.nodeAssetsUpdateDialog,!1)):e._e(),e._v(" "),n("Dialog",{attrs:{"show-cancel":!1,"show-confirm":!1,title:e.$tc("NodeInformation"),visible:e.nodeInfoDialogSetting.dialogVisible,width:"50%"},on:{"update:visible":function(t){return e.$set(e.nodeInfoDialogSetting,"dialogVisible",t)}}},e._l(e.nodeInfoDialogSetting.items,(function(t){return n("el-row",{key:"card-"+t.key,staticClass:"item",attrs:{gutter:10}},[n("el-col",{attrs:{md:6,sm:24}},[n("div",{staticClass:"item-label"},[n("label",[e._v(e._s(t.label)+": ")])])]),e._v(" "),n("el-col",{attrs:{md:18,sm:24}},[n("div",{staticClass:"item-text"},[e._v(e._s(t.value))])])],1)})),1)],1)},l=[],u=(n("7f7f"),n("96cf"),n("3b8d")),d=n("ac6b"),f=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"asset-select-dialog"},[e.iVisible?n("AssetDialog",{attrs:{"base-url":e.assetsUrl,title:e.$tc("Assets"),visible:e.iVisible},on:{"update:visible":function(t){e.iVisible=t},cancel:e.assetTreeTableDialogHandleCancel,confirm:e.assetTreeTableDialogHandleConfirm}}):e._e()],1)},p=[],h=n("2af4"),m=n("c0eb"),b={name:"NodeAssetsUpdate",components:{AssetDialog:h["a"]},props:{visible:{type:Boolean,default:!1},action:{type:String,default:"add"},selectNode:{type:Object,default:null}},data:function(){return{dialogVisible:!1}},computed:{iVisible:{set:function(e){var t;null===(t=this.$parent)||void 0===t||t.hideMenu(),this.$emit("update:visible",e)},get:function(){return this.visible}},assetsUrl:function(){return"remove"===this.action?"/api/v1/assets/assets/?node_id="+this.selectNode.meta.data.id:"/api/v1/assets/assets/"}},methods:{assetTreeTableDialogHandleConfirm:function(e){var t=this;if(e){var n=this.selectNode;if(n&&0!==e.length){var a;switch(this.action){case"add":a="/api/v1/assets/nodes/".concat(n.meta.data.id,"/assets/add/");break;case"move":a="/api/v1/assets/nodes/".concat(n.meta.data.id,"/assets/replace/");break;case"remove":a="/api/v1/assets/nodes/".concat(n.meta.data.id,"/assets/remove/");break;default:return}this.$axios.put(a,{assets:e}).then((function(e){t.iVisible=!1,t.assetsSelected=[],Object(m["a"])("#tree-refresh").trigger("click"),t.$message.success(t.$tc("UpdateSuccessMsg"))})).catch((function(e){var n;null===(n=t.$parent)||void 0===n||n.hideMenu(),t.$message.error(t.$tc("UpdateErrorMsg "+e))}))}}},assetTreeTableDialogHandleCancel:function(){this.iVisible=!1}}},v=b,g=n("2877"),y=Object(g["a"])(v,f,p,!1,null,"eb5d4d42",null),w=y.exports,_=n("9039"),O={name:"TreeMenu",components:{NodeAssetsUpdateDialog:w,Dialog:_["a"]},props:{tree:{type:Object,require:!0,default:function(){return{}}}},data:function(){return{nodeAssetsUpdateDialog:{visible:!1,action:"add",selectNode:null},nodeInfoDialogSetting:{dialogVisible:!1,items:[]}}},methods:{rMenuAddAssetToNode:function(){this.nodeAssetsUpdateDialog.visible=!0,this.nodeAssetsUpdateDialog.action="add",this.nodeAssetsUpdateDialog.selectNode=this.getSelectedNodes()[0]},rMenuMoveAssetToNode:function(){this.nodeAssetsUpdateDialog.visible=!0,this.nodeAssetsUpdateDialog.action="move",this.nodeAssetsUpdateDialog.selectNode=this.getSelectedNodes()[0]},rMenuRemoveAssetFromNode:function(){this.nodeAssetsUpdateDialog.visible=!0,this.nodeAssetsUpdateDialog.action="remove",this.nodeAssetsUpdateDialog.selectNode=this.getSelectedNodes()[0]},rMenuUpdateNodeAssetHardwareInfo:function(){var e=this;this.hideMenu();var t=this.getSelectedNodes()[0];t&&this.$axios.post("/api/v1/assets/nodes/".concat(t.meta.data.id,"/tasks/"),{action:"refresh"}).then((function(e){Object(d["k"])(e["task"])})).catch((function(t){e.$message.error(e.$tc("UpdateErrorMsg "+t))}))},rMenuTestNodeAssetConnectivity:function(){var e=this;this.hideMenu();var t=this.getSelectedNodes()[0];t&&this.$axios.post("/api/v1/assets/nodes/".concat(t.meta.data.id,"/tasks/"),{action:"test"}).then((function(e){Object(d["k"])(e["task"])})).catch((function(t){e.$message.error(e.$tc("UpdateErrorMsg "+t))}))},rMenuShowAssetOnlyCurrentNode:function(){this.hideMenu();var e=this.getSelectedNodes()[0];e&&this.$emit("showAll",{node:e,showCurrentAsset:1})},rMenuShowAssetAllChildrenNode:function(){this.hideMenu();var e=this.getSelectedNodes()[0];e&&this.$emit("showAll",{node:e,showCurrentAsset:0})},rMenuShowNodeInfo:function(){var e=Object(u["a"])(regeneratorRuntime.mark((function e(){var t,n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t=this.getSelectedNodes()[0],t){e.next=3;break}return e.abrupt("return");case 3:return e.prev=3,e.next=6,this.$axios.get("/api/v1/assets/nodes/".concat(t.meta.data.id,"/"));case 6:n=e.sent,this.nodeInfoDialogSetting.dialogVisible=!0,this.nodeInfoDialogSetting.items=[{key:"id",label:"ID",value:n.id},{key:"key",label:"KEY",value:n.key},{key:"name",label:this.$t("Name"),value:n.name},{key:"fullName",label:this.$t("FullName"),value:n.full_value}],e.next=14;break;case 11:e.prev=11,e.t0=e["catch"](3),this.$message.error(this.$tc("ErrorMsg "+e.t0));case 14:case"end":return e.stop()}}),e,this,[[3,11]])})));function t(){return e.apply(this,arguments)}return t}(),rCheckAssetsAmount:function(){var e=this;this.$axios.post("/api/v1/assets/nodes/check_assets_amount_task/").then((function(e){Object(d["k"])(e["task"])})).catch((function(t){e.$message.error(e.$tc("UpdateErrorMsg "+t))}))},hideMenu:function(){this.tree.hideRMenu()},getSelectedNodes:function(){return this.tree.getSelectedNodes()}}},A=O,$=(n("4d1c"),Object(g["a"])(A,c,l,!1,null,"39acb4f3",null)),j=$.exports,C=n("e264"),x=n("dbfd");function S(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function D(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?S(Object(n),!0).forEach((function(t){Object(r["a"])(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):S(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var k={components:{AssetTreeTable:o["d"],TreeMenu:j,BaseList:C["a"]},data:function(){var e=this,t="/api/v1/assets/assets/";return{treeRef:null,showPlatform:!1,category:"all",treeSetting:{url:"/api/v1/assets/assets/",showMenu:!this.$store.getters.currentOrgIsRoot,showDefaultMenu:!0,menu:[]},tableConfig:{url:t,category:"all",extraQuery:{order:"-date_updated"}},headerActions:{handleImportClick:function(t){t.selectedRows;e.$message.warning({message:e.$t("ImportMessage")})}},addExtraMoreActions:[],helpMessage:this.$t("AssetListHelpMessage")}},computed:D({},Object(i["b"])(["currentOrgIsRoot"])),mounted:function(){this.treeRef=this.$refs.AssetTreeTable.$refs.TreeList},methods:{decorateRMenu:function(){var e=this.$cookie.get("show_current_asset")||"0";"1"===e?(Object(m["a"])("#m_show_asset_all_children_node").css("color","#606266"),Object(m["a"])("#m_show_asset_only_current_node").css("color","green")):(Object(m["a"])("#m_show_asset_all_children_node").css("color","green"),Object(m["a"])("#m_show_asset_only_current_node").css("color","#606266"))},showAll:function(e){var t=e.node,n=e.showCurrentAsset;this.$cookie.set("show_current_asset",n,1),this.decorateRMenu();var a="".concat(this.treeSetting.url,"?node_id=").concat(t.meta.data.id,"&show_current_asset=").concat(n);this.$refs.AssetTreeTable.$refs.TreeList.handleUrlChange(a)},getAssetsUrl:function(e){var t="/api/v1/assets/assets/";if("node"===e.meta.type){var n=e.meta.data.id;t=Object(x["w"])(t,"node",n),t=Object(x["w"])(t,"asset","")}else if("asset"===e.meta.type){var a,s=(null===(a=e.meta.data)||void 0===a?void 0:a.id)||e.id;t=Object(x["w"])(t,"node",""),t=Object(x["w"])(t,"asset",s)}else"category"===e.meta.type?t=Object(x["w"])(t,"category",e.meta.category):"type"===e.meta.type?(t=Object(x["w"])(t,"category",e.meta.category),t=Object(x["w"])(t,"type",e.meta._type)):"platform"===e.meta.type&&(t=Object(x["w"])(t,"platform",e.id));this.$set(this.tableConfig,"url",t),Object(x["u"])(this,t)}}},P=k,T=(n("8889"),Object(g["a"])(P,a,s,!1,null,"614008fe",null));t["default"]=T.exports},7:function(e,t){},8889:function(e,t,n){"use strict";n("af13")},"9c59":function(e,t,n){"use strict";var a,s=Object.prototype.hasOwnProperty;function r(e){try{return decodeURIComponent(e.replace(/\+/g," "))}catch(t){return null}}function o(e){try{return encodeURIComponent(e)}catch(t){return null}}function i(e){var t,n=/([^=?#&]+)=?([^&]*)/g,a={};while(t=n.exec(e)){var s=r(t[1]),o=r(t[2]);null===s||null===o||s in a||(a[s]=o)}return a}function c(e,t){t=t||"";var n,r,i=[];for(r in"string"!==typeof t&&(t="?"),e)if(s.call(e,r)){if(n=e[r],n||null!==n&&n!==a&&!isNaN(n)||(n=""),r=o(r),n=o(n),null===r||null===n)continue;i.push(r+"="+n)}return i.length?t+i.join("&"):""}t.stringify=c,t.parse=i},"9d83":function(e,t,n){},a19f:function(e,t,n){"use strict";n("625e5")},a9d3:function(e,t,n){},af13:function(e,t,n){},b708:function(e,t,n){},bd11:function(e,t){e.exports=v,e.exports.match=i,e.exports.regexpToFunction=c,e.exports.parse=s,e.exports.compile=o,e.exports.tokensToFunction=l,e.exports.tokensToRegExp=b;var n="/",a=new RegExp(["(\\\\.)","(?:\\:(\\w+)(?:\\(((?:\\\\.|[^\\\\()])+)\\))?|\\(((?:\\\\.|[^\\\\()])+)\\))([+*?])?"].join("|"),"g");function s(e,t){var s,o=[],i=0,c=0,l="",u=t&&t.delimiter||n,f=t&&t.whitelist||void 0,p=!1;while(null!==(s=a.exec(e))){var h=s[0],m=s[1],b=s.index;if(l+=e.slice(c,b),c=b+h.length,m)l+=m[1],p=!0;else{var v="",g=s[2],y=s[3],w=s[4],_=s[5];if(!p&&l.length){var O=l.length-1,A=l[O],$=!f||f.indexOf(A)>-1;$&&(v=A,l=l.slice(0,O))}l&&(o.push(l),l="",p=!1);var j="+"===_||"*"===_,C="?"===_||"*"===_,x=y||w,S=v||u,D=v||("string"===typeof o[o.length-1]?o[o.length-1]:"");o.push({name:g||i++,prefix:v,delimiter:S,optional:C,repeat:j,pattern:x?d(x):r(S,u,D)})}}return(l||c<e.length)&&o.push(l+e.substr(c)),o}function r(e,t,n){var a="[^"+u(e===t?e:e+t)+"]";return!n||n.indexOf(e)>-1||n.indexOf(t)>-1?a+"+?":u(n)+"|(?:(?!"+u(n)+")"+a+")+?"}function o(e,t){return l(s(e,t),t)}function i(e,t){var n=[],a=v(e,n,t);return c(a,n)}function c(e,t){return function(n,a){var s=e.exec(n);if(!s)return!1;for(var r=s[0],o=s.index,i={},c=a&&a.decode||decodeURIComponent,l=1;l<s.length;l++)if(void 0!==s[l]){var u=t[l-1];u.repeat?i[u.name]=s[l].split(u.delimiter).map((function(e){return c(e,u)})):i[u.name]=c(s[l],u)}return{path:r,index:o,params:i}}}function l(e,t){for(var n=new Array(e.length),a=0;a<e.length;a++)"object"===typeof e[a]&&(n[a]=new RegExp("^(?:"+e[a].pattern+")$",f(t)));return function(t,a){for(var s="",r=a&&a.encode||encodeURIComponent,o=!a||!1!==a.validate,i=0;i<e.length;i++){var c=e[i];if("string"!==typeof c){var l,u=t?t[c.name]:void 0;if(Array.isArray(u)){if(!c.repeat)throw new TypeError('Expected "'+c.name+'" to not repeat, but got array');if(0===u.length){if(c.optional)continue;throw new TypeError('Expected "'+c.name+'" to not be empty')}for(var d=0;d<u.length;d++){if(l=r(u[d],c),o&&!n[i].test(l))throw new TypeError('Expected all "'+c.name+'" to match "'+c.pattern+'"');s+=(0===d?c.prefix:c.delimiter)+l}}else if("string"!==typeof u&&"number"!==typeof u&&"boolean"!==typeof u){if(!c.optional)throw new TypeError('Expected "'+c.name+'" to be '+(c.repeat?"an array":"a string"))}else{if(l=r(String(u),c),o&&!n[i].test(l))throw new TypeError('Expected "'+c.name+'" to match "'+c.pattern+'", but got "'+l+'"');s+=c.prefix+l}}else s+=c}return s}}function u(e){return e.replace(/([.+*?=^!:${}()[\]|/\\])/g,"\\$1")}function d(e){return e.replace(/([=!:$/()])/g,"\\$1")}function f(e){return e&&e.sensitive?"":"i"}function p(e,t){if(!t)return e;var n=e.source.match(/\((?!\?)/g);if(n)for(var a=0;a<n.length;a++)t.push({name:a,prefix:null,delimiter:null,optional:!1,repeat:!1,pattern:null});return e}function h(e,t,n){for(var a=[],s=0;s<e.length;s++)a.push(v(e[s],t,n).source);return new RegExp("(?:"+a.join("|")+")",f(n))}function m(e,t,n){return b(s(e,n),t,n)}function b(e,t,a){a=a||{};for(var s=a.strict,r=!1!==a.start,o=!1!==a.end,i=a.delimiter||n,c=[].concat(a.endsWith||[]).map(u).concat("$").join("|"),l=r?"^":"",d=0;d<e.length;d++){var p=e[d];if("string"===typeof p)l+=u(p);else{var h=p.repeat?"(?:"+p.pattern+")(?:"+u(p.delimiter)+"(?:"+p.pattern+"))*":p.pattern;t&&t.push(p),p.optional?p.prefix?l+="(?:"+u(p.prefix)+"("+h+"))?":l+="("+h+")?":l+=u(p.prefix)+"("+h+")"}}if(o)s||(l+="(?:"+u(i)+")?"),l+="$"===c?"$":"(?="+c+")";else{var m=e[e.length-1],b="string"===typeof m?m[m.length-1]===i:void 0===m;s||(l+="(?:"+u(i)+"(?="+c+"))?"),b||(l+="(?="+u(i)+"|"+c+")")}return new RegExp(l,f(a))}function v(e,t,n){return e instanceof RegExp?p(e,t):Array.isArray(e)?h(e,t,n):m(e,t,n)}},c0eb:function(e,t,n){"use strict";var a=n("c5ec"),s=n.n(a);window.$=s.a,window.jQuery=s.a,t["a"]=s.a},e264:function(e,t,n){"use strict";var a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[e.helpMessage?n("el-alert",{attrs:{"show-icon":"",type:"info"}},[n("span",{directives:[{name:"sanitize",rawName:"v-sanitize",value:e.helpMessage,expression:"helpMessage"}],staticClass:"announcement-main"})]):e._e(),e._v(" "),n("ListTable",{ref:"ListTable",attrs:{"create-drawer":e.createDrawer,"detail-drawer":e.detailDrawer,"draw-props":e.createProps,"header-actions":e.iHeaderActions,resource:e.$tc("Asset"),"table-config":e.iTableConfig}}),e._v(" "),n("PlatformDialog",{attrs:{category:e.category,visible:e.showPlatform},on:{"update:visible":function(t){e.showPlatform=t},"select-platform":e.createAsset}}),e._v(" "),e.updateSelectedDialogSetting.visible?n("AssetBulkUpdateDialog",e._b({attrs:{category:e.category,visible:e.updateSelectedDialogSetting.visible},on:{"update:visible":function(t){return e.$set(e.updateSelectedDialogSetting,"visible",t)},update:e.handleAssetBulkUpdate}},"AssetBulkUpdateDialog",e.updateSelectedDialogSetting,!1)):e._e(),e._v(" "),n("GatewayDialog",{attrs:{cell:e.gatewayCell,port:e.gatewayPort,visible:e.gatewayVisible},on:{"update:visible":function(t){e.gatewayVisible=t}}}),e._v(" "),n("AccountDiscoverDialog",{attrs:{asset:e.discoveryDialog.asset,visible:e.discoveryDialog.visible},on:{"update:visible":function(t){return e.$set(e.discoveryDialog,"visible",t)}}}),e._v(" "),e.showAddDialog?n("AccountCreateUpdate",{attrs:{asset:e.asset,visible:e.showAddDialog},on:{"update:visible":function(t){e.showAddDialog=t},add:e.addAccountSuccess}}):e._e()],1)},s=[],r=(n("1c01"),n("58b2"),n("8e6e"),n("f3e2"),n("ac6a"),n("456d"),n("7f7f"),n("6762"),n("2fdb"),n("d25f"),n("96cf"),n("3b8d")),o=(n("6d67"),n("75fc")),i=n("bd86"),c=n("ae05"),l=function(){var e=this,t=e.$createElement,n=e._self._c||t;return e.visible?n("GenericUpdateFormDialog",e._g({attrs:{"form-setting":e.formSetting,"selected-rows":e.selectedRows,tips:e.tips,visible:e.visible}},e.$listeners)):e._e()},u=[],d=n("cd4a"),f=n("0e1d");function p(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function h(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?p(Object(n),!0).forEach((function(t){Object(i["a"])(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):p(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var m={name:"AssetBulkUpdateDialog",components:{GenericUpdateFormDialog:d["h"]},props:{visible:{type:Boolean,default:!1},selectedRows:{type:Array,default:function(){return[]}},category:{type:String,default:""}},data:function(){var e=Object(f["a"])(this),t=["device","cloud","web"],n="all"===this.category?"":this.category;return{tips:this.$t("AssetBulkUpdateTips"),formSetting:{url:"/api/v1/assets/assets/",hasSaveContinue:!1,fields:["platform","nodes","zone","labels","is_active","comment"],fieldsMeta:{platform:{el:{multiple:!1,ajax:{url:"/api/v1/assets/platforms/?category=".concat(n),transformOption:function(e){return{label:e.name,value:e.id}}}},rules:[{required:!1}],label:this.$t("Platform"),helpText:this.$t("UpdatePlatformHelpText")},nodes:h(h({},e.nodes),{},{label:this.$t("Node")}),zone:h(h({},e.zone),{},{label:this.$tc("Zone"),disabled:t.includes(this.category)}),labels:h(h({},e.labels),{},{label:this.$t("Tags")}),is_active:h(h({},e.is_active),{},{label:this.$t("Active")}),comment:{label:this.$t("Comment"),hidden:function(){return!1}}}}}}},b=m,v=n("2877"),g=Object(v["a"])(b,l,u,!1,null,"2e789de9",null),y=g.exports,w=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("el-drawer",{attrs:{modal:!1,"show-cancel":!1,"show-confirm":!1,title:e.$tc("SelectPlatform"),visible:e.iVisible,size:"700px",top:"1vh"},on:{"update:visible":function(t){e.iVisible=t}},scopedSlots:e._u([{key:"title",fn:function(){return[n("div",{staticClass:"drawer-title"},[n("span",[e._v(e._s(e.$tc("SelectPlatform")))]),e._v(" "),n("el-link",{attrs:{underline:!1,size:"small",type:"text"},on:{click:e.handleManagePlatform}},[n("i",{staticClass:"fa fa-external-link"}),e._v("\n        "+e._s(e.$tc("ManagePlatform"))+"\n      ")])],1)]},proxy:!0}])},[e._v(" "),n("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"platform-content"},[n("el-row",{attrs:{gutter:20}},[n("el-collapse",{attrs:{accordion:""},model:{value:e.activeType,callback:function(t){e.activeType=t},expression:"activeType"}},e._l(e.iPlatforms,(function(t,a){return n("el-collapse-item",{key:a,attrs:{name:a,title:a}},e._l(t,(function(t,a){return n("el-col",{key:t.id,attrs:{span:8}},[n("el-tooltip",{attrs:{content:t.name}},[n("el-card",{staticClass:"platform-item",style:{borderLeftColor:e.randomBorderColor(a)},attrs:{shadow:"hover"},nativeOn:{click:function(n){return e.handleSelect(t)}}},[n("div",{staticClass:"icon-zone"},[n("img",{staticClass:"asset-icon",attrs:{src:e.getPlatformLogo(t),alt:"icon"}})]),e._v(" "),n("span",{staticClass:"platform-name"},[e._v(e._s(t.name))])])],1)],1)})),1)})),1)],1)],1)])},O=[],A=n("ac6b");function $(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function j(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?$(Object(n),!0).forEach((function(t){Object(i["a"])(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):$(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var C={name:"PlatformDrawer",components:{},props:{visible:{type:Boolean,default:!1},category:{type:String,default:"all"}},data:function(){return{platforms:[],recentPlatformIds:[],loading:!0,activeType:[],recentUsedLabel:this.$t("RecentlyUsed"),typeIconMapper:{linux:"fa-linux",windows:"fa-windows",unix:"",macos:"fa-apple"},bottomColors:["#1c84c6","#23c6c8","#1ab394","#f8ac59","#783887","#fc6554"],allRecentPlatforms:[]}},computed:{iVisible:{set:function(e){this.$emit("update:visible",e)},get:function(){return this.visible}},iPlatforms:function(){var e={},t={};return"all"===this.category?(e[this.recentUsedLabel]=this.allRecentPlatforms,t=this.allSortedPlatforms):(e[this.recentUsedLabel]=this.typeRecentPlatforms,t=this.typeSortedPlatforms),0===e[this.recentUsedLabel].length&&(e={}),j(j({},e),t)},allSortedPlatforms:function(){return _.groupBy(this.platforms,(function(e){return e.category.label}))},typeSortedPlatforms:function(){var e=this,t=this.platforms.filter((function(t){return t.category.value===e.category}));return _.groupBy(t,(function(e){return e.type.label}))},typeRecentPlatforms:function(){var e=this;return this.allRecentPlatforms.filter((function(t){return t.category.value===e.category}))}},created:function(){var e=Object(r["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.$store.dispatch("assets/getPlatforms");case 2:return this.platforms=e.sent,e.next=5,this.$store.dispatch("assets/getRecentPlatforms");case 5:this.allRecentPlatforms=e.sent,this.activeType=Object.keys(this.iPlatforms)[0],this.loading=!1;case 8:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),methods:{getPlatformLogo:function(e){return Object(A["j"])(e.name,e.type.value)},onConfirm:function(){this.iVisible=!1},randomBorderColor:function(e){var t=this.bottomColors.length,n=e%t,a=this.bottomColors[n];return a},handleSelect:function(e){this.$store.dispatch("assets/addToRecentPlatforms",e),this.$emit("select-platform",e)},handleManagePlatform:function(){this.$router.push({name:"PlatformList"}),this.iVisible=!1}}},x=C,S=(n("a19f"),Object(v["a"])(x,w,O,!1,null,"4c7537f3",null)),D=S.exports,k=n("c14c"),P=n("4af8"),T=n("5838"),R=(n("7514"),n("53f7")),M=n("ce19"),U=n("b318"),E=n("a4d9");function I(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function N(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?I(Object(n),!0).forEach((function(t){Object(i["a"])(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):I(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function V(e){var t,n=function(){var t=Object(r["a"])(regeneratorRuntime.mark((function t(n,a){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.updateOrCloneAsset(n,a.toLowerCase());case 2:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}(),a=(null===(t=e.$route.params)||void 0===t?void 0:t.extraQuery)||{},s={onCreate:function(){e.showPlatform=!1,setTimeout((function(){e.showPlatform=!0}),100)},hasLabelSearch:!0,searchConfig:{getUrlQuery:!1},hasCreate:!1,extraMoreActions:[{name:"TestSelected",title:e.$t("TestSelected"),type:"primary",icon:"verify",can:function(t){var n,a,s=t.selectedRows;return e.$hasPerm("assets.test_assetconnectivity")&&!e.$store.getters.currentOrgIsRoot&&s.length>0&&(null===(n=s[0].auto_config)||void 0===n?void 0:n.ansible_enabled)&&(null===(a=s[0].auto_config)||void 0===a?void 0:a.ping_enabled)},callback:function(t){var n=t.selectedRows,a=n.map((function(e){return e.id}));e.$axios.post("/api/v1/assets/assets/tasks/",{action:"test",assets:a}).then((function(e){Object(A["k"])(e["task"])})).catch((function(t){e.$message.error(e.$tc("common.bulkVerifyErrorMsg "+t))}))}},{name:"DeactiveSelected",title:e.$t("DisableSelected"),type:"primary",icon:"disable",can:function(t){var n=t.selectedRows;return n.length>0&&e.$hasPerm("assets.change_asset")},callback:function(t){var n=t.selectedRows,a=n.map((function(e){return{pk:e.id,is_active:!1}}));e.$axios.patch("/api/v1/assets/assets/",a).then((function(t){e.$message.success(e.$tc("UpdateSuccessMsg")),e.$refs.ListTable.reloadTable()})).catch((function(t){e.$message.error(e.$tc("UpdateErrorMsg "+t))}))}},{name:"ActiveSelected",title:e.$t("ActivateSelected"),type:"primary",icon:"activate",can:function(t){var n=t.selectedRows;return n.length>0&&e.$hasPerm("assets.change_asset")},callback:function(t){var n=t.selectedRows,a=n.map((function(e){return{pk:e.id,is_active:!0}}));e.$axios.patch("/api/v1/assets/assets/",a).then((function(t){e.$message.success(e.$tc("UpdateSuccessMsg")),e.$refs.ListTable.reloadTable()})).catch((function(t){e.$message.error(e.$tc("UpdateErrorMsg "+t))}))}},{name:"actionUpdateSelected",title:e.$t("UpdateSelected"),icon:"batch-update",can:function(t){var n=t.selectedRows;return n.length>0&&!e.$store.getters.currentOrgIsRoot&&e.$hasPerm("assets.change_asset")},callback:function(t){var n=t.selectedRows;e.updateSelectedDialogSetting.selectedRows=n,e.updateSelectedDialogSetting.visible=!0}}]},i={url:"/api/v1/assets/hosts/",permissions:{app:"assets",resource:"asset"},extraQuery:N(N({},a),e.extraQuery),columnsExclude:["spec_info","auto_config"],columnsShow:{min:["name","address","actions"],default:e.defaultColumns||["name","address","accounts_amount","platform","connectivity","actions"]},columnsMeta:{type:{formatter:R["e"],sortable:!1},category:{formatter:R["e"],sortable:!1},name:{formatter:R["i"],formatterArgs:{route:"AssetDetail"},sortable:!0},platform:{width:"160px",sortable:!0,formatter:R["n"]},protocols:{showFullContent:!0,formatter:R["o"]},nodes_display:{formatter:R["d"]},address:{minWidth:"200px"},gathered_info:{label:e.$t("HardwareInfo"),formatter:M["a"],formatterArgs:{info:null===e||void 0===e?void 0:e.optionInfo,can:e.$hasPerm("assets.refresh_assethardwareinfo"),getRoute:function(e){var t=e.row;return{name:"AssetMoreInformationEdit",params:{id:t.id}}}}},accounts_amount:{label:e.$t("Accounts"),formatter:U["a"],width:"100px",formatterArgs:{async:!0,getItem:function(e){return"".concat(e.name,"(").concat(e.username,")")},getRoute:function(e){var t=e.row;return{name:"AssetDetail",params:{id:t.id},query:{tab:"Account"}}}}},connectivity:E["c"],actions:{formatter:R["c"],formatterArgs:{onUpdate:function(e){var t=e.row;return n(t,"Update")},onClone:function(e){var t=e.row;return n(t,"Clone")},performDelete:function(t){var n=t.row,a=n.id,s="/api/v1/assets/assets/".concat(a,"/");return e.$axios.delete(s)},extraActions:[{name:"Test",title:e.$t("Test"),can:function(t){var n,a,s=t.row;return e.$hasPerm("assets.test_assetconnectivity")&&!e.$store.getters.currentOrgIsRoot&&(null===s||void 0===s||null===(n=s.auto_config)||void 0===n?void 0:n.ansible_enabled)&&(null===s||void 0===s||null===(a=s.auto_config)||void 0===a?void 0:a.ping_enabled)},callback:function(t){var n=t.row;if("Gateway"===n.platform.name){e.gatewayVisible=!0;var a=n.protocols.find((function(e){return"ssh"===e.name})).port;if(!a)return e.$message.error(e.$tc("BadRequestErrorMsg"));e.gatewayPort=a,e.gatewayCell=n.id}else e.$axios.post("/api/v1/assets/assets/".concat(n.id,"/tasks/"),{action:"test"}).then((function(e){Object(A["k"])(e["task"])}))}},{name:"AddAccount",title:e.$t("AddAccount"),divided:!0,can:function(t){t.row;return!e.$store.getters.currentOrgIsRoot},callback:function(t){var n=t.row;e.asset=n,e.showAddDialog=!0}},{name:"DiscoverAccounts",title:e.$t("AccountDiscover"),can:function(t){t.row;return!e.$store.getters.currentOrgIsRoot},callback:function(t){var n=t.row;e.discoveryDialog.asset=n.id,setTimeout((function(){e.discoveryDialog.visible=!0}),200)}}].concat(Object(o["a"])(e.addExtraMoreColActions))}}}};return{tableConfig:i,defaultHeaderActions:s}}var L=n("2f62");function q(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function B(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?q(Object(n),!0).forEach((function(t){Object(i["a"])(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):q(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var F={components:{ListTable:c["a"],GatewayDialog:k["a"],PlatformDialog:D,AccountCreateUpdate:T["a"],AccountDiscoverDialog:P["a"],AssetBulkUpdateDialog:y},props:{url:{type:String,required:!0},category:{type:String,default:""},tableConfig:{type:Object,default:function(){return{}}},headerActions:{type:Object,default:function(){return{}}},addExtraMoreActions:{type:Array,default:function(){return[]}},addExtraMoreColActions:{type:Array,default:function(){return[]}},helpMessage:{type:String,default:""},optionInfo:{type:Object,default:function(){return{}}},extraQuery:{type:Object,default:function(){return{}}},defaultColumns:{type:Array,default:null}},data:function(){var e=this,t=this,a=V(t),s=[{name:"linux",title:"Linux",callback:function(){}},{name:"windows",title:"Windows",callback:function(){}}],r={name:"create",title:this.$t("Create"),type:"primary",icon:"",split:!0,has:this.headerActions.hasCreate,can:!this.$store.getters.currentOrgIsRoot,callback:function(){e.showPlatform=!1,setTimeout((function(){e.showPlatform=!0}),100)},dropdown:s};return{createDrawer:"",detailDrawer:function(){return Promise.all([n.e("chunk-commons"),n.e("chunk-ffa07718")]).then(n.bind(null,"2dc2"))},drawer:{host:function(){return n.e("chunk-2cddfe9c").then(n.bind(null,"1348"))},web:function(){return n.e("chunk-48aca3c5").then(n.bind(null,"363ef"))},custom:function(){return n.e("chunk-2cdd6bfc").then(n.bind(null,"0dbd"))},cloud:function(){return n.e("chunk-2caff2a2").then(n.bind(null,"bf76"))},device:function(){return n.e("chunk-2cdc3d26").then(n.bind(null,"3103"))},database:function(){return n.e("chunk-2cd6b8fa").then(n.bind(null,"9330"))},ds:function(){return n.e("chunk-2cda5e90").then(n.bind(null,"51f6"))}},createProps:{},showPlatform:!1,showAddDialog:!1,recentPlatforms:s,createAction:r,gatewayPort:0,asset:{},gatewayCell:"",gatewayVisible:!1,defaultConfig:a["tableConfig"],defaultHeaderActions:a["defaultHeaderActions"],updateSelectedDialogSetting:{visible:!1,category:this.category,selectedRows:[]},discoveryDialog:{visible:!1,asset:""}}},computed:B(B({},Object(L["c"])({recentPlatformIds:function(e){return e.assets.recentPlatformIds}})),{},{iTableConfig:function(){return _.merge(this.defaultConfig,this.tableConfig,B({url:this.url},this.category&&{category:this.category}))},iHeaderActions:function(){var e=this,t=_.merge({},this.defaultHeaderActions,this.headerActions);this.addExtraMoreActions&&(t.extraMoreActions=[].concat(Object(o["a"])(t.extraMoreActions),Object(o["a"])(this.addExtraMoreActions)));var n=this.createAction;n.dropdown=this.recentPlatforms,n.dropdown.map((function(t){return t.can=!e.$store.getters.currentOrgIsRoot,t}));var a=t.extraActions||[];return t.extraActions=[n].concat(Object(o["a"])(a)),t}}),watch:{optionInfo:function(e){this.$set(this.defaultConfig.columnsMeta.gathered_info.formatterArgs,"info",e)},$route:function(e,t){var n=e.query.tab,a=t.query.tab;n!==a&&"all"!==n&&(e.query.node_id="",this.$router.push(e))},recentPlatformIds:function(e,t){this.setRecentPlatforms()}},mounted:function(){this.setRecentPlatforms()},activated:function(){this.setRecentPlatforms()},methods:{updateOrCloneAsset:function(){var e=Object(r["a"])(regeneratorRuntime.mark((function e(t,n){var a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(this.createDrawer=this.drawer[t.category.value],a={platform:t.platform.id,type:t.type.value,category:t.category.value,action:n},"clone"!==n){e.next=4;break}return e.abrupt("return",this.$refs.ListTable.onClone({row:t,query:a}));case 4:this.$refs.ListTable.onUpdate({row:t,query:a});case 5:case"end":return e.stop()}}),e,this)})));function t(t,n){return e.apply(this,arguments)}return t}(),createAsset:function(e){var t,n;this.showPlatform=!1,this.createDrawer=this.drawer[e.category.value];var a={platform:e.id,type:e.type.value,category:e.category.value,node:(null===(t=this.$route.query)||void 0===t?void 0:t.node)||(null===(n=this.$route.query)||void 0===n?void 0:n.node_id)||""};this.$log.debug("createProps",a),this.$refs.ListTable.onCreate({query:a})},handleAssetBulkUpdate:function(){this.updateSelectedDialogSetting.visible=!1,this.$refs.ListTable.reloadTable()},setRecentPlatforms:function(){var e=Object(r["a"])(regeneratorRuntime.mark((function e(){var t,n,a,s,r,i=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.$store.dispatch("assets/getRecentPlatforms");case 2:return t=e.sent,e.next=5,this.$store.dispatch("assets/getPlatforms");case 5:n=e.sent,a=n.filter((function(e){return!i.recentPlatformIds.includes(e.id)})),s=[].concat(Object(o["a"])(t),Object(o["a"])(a)),"all"!==this.category&&(s=s.filter((function(e){return e.category.value===i.category}))),s=s.slice(0,6),r=this,s=s.map((function(e){return{name:e.name,title:e.name,callback:function(){r.createAsset(e)}}})),this.recentPlatforms=s;case 13:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),addAccountSuccess:function(){this.$refs.ListTable.reloadTable()}}},z=F,H=Object(v["a"])(z,a,s,!1,null,null,null);t["a"]=H.exports},e323:function(e,t,n){"use strict";var a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"content"},[e.hasButton?n("el-button",{staticClass:"proto-setting",attrs:{disabled:!e.canSetting,icon:e.icon,size:"small",type:"primary"},on:{click:e.onSetting}}):e._e(),e._v(" "),n("Dialog",{attrs:{"show-cancel":!1,"show-confirm":!1,title:e.title,visible:e.isVisible,width:"60%"},on:{"update:visible":function(t){e.isVisible=t},close:e.onDialogClose}},[n("AutoDataForm",e._g(e._b({ref:"autoDataForm",staticClass:"data-form",attrs:{form:e.form},on:{submit:e.onSubmit}},"AutoDataForm",e.config,!1),e.$listeners))],1)],1)},s=[],r=(n("1c01"),n("58b2"),n("8e6e"),n("f3e2"),n("d25f"),n("bd86")),o=n("768b"),i=(n("ffc1"),n("6762"),n("2fdb"),n("ac6a"),n("456d"),n("96cf"),n("3b8d")),c=n("9039"),l=n("c75f"),u=n("f823");function d(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function f(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?d(Object(n),!0).forEach((function(t){Object(r["a"])(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):d(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var p={components:{Dialog:c["a"],AutoDataForm:l["a"]},props:{value:{type:[String,Object],default:function(){return{}}},title:{type:String,default:function(){return this.$t("PushParams")}},btnText:{type:String,default:function(){return""}},icon:{type:String,default:"el-icon-setting"},url:{type:String,default:"/api/v1/assets/platform-automation-methods/"},method:{type:String,default:""},pushAccountParams:{type:Object,default:function(){return{}}},visible:{type:Boolean,default:!1},hasButton:{type:Boolean,default:!0}},data:function(){return{isVisible:this.visible,canSetting:!0,form:this.value,remoteMeta:{},config:{url:this.url,hasSaveContinue:!1,hasButtons:!0,hasReset:!1,fields:[],method:"get"},preFieldsMeta:{change_secret_by_ssh:{commands:{helpTextAsTip:!1}}}}},watch:{visible:function(e){this.isVisible=e},method:function(e,t){e!==t&&this.getUrlMeta()}},mounted:function(){this.getUrlMeta()},methods:{getUrlMeta:function(){var e=Object(i["a"])(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.$store.dispatch("common/getUrlMeta",{url:this.url});case 2:t=e.sent,this.remoteMeta=t.actions[this.config.method.toUpperCase()]||{},this.onCanSetting()&&this.setFormConfig();case 5:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),onCanSetting:function(){var e=Object.keys(this.remoteMeta);return this.canSetting=e.includes(this.method)&&this.$hasPerm("assets.change_platform"),this.$emit("canSetting",this.canSetting),this.canSetting},setFormConfig:function(){var e=[],t={},n=this.method,a=this.remoteMeta[n];e=[[a.label,[n]]],t[n]={fields:[],fieldsMeta:{}};var s=this.pushAccountParams[n];if(Object.keys((null===a||void 0===a?void 0:a.children)||{}).length>0)for(var r=0,i=Object.entries(a.children);r<i.length;r++){var c=Object(o["a"])(i[r],2),l=c[0],d=c[1],p="el-input",h={};switch(null===d||void 0===d?void 0:d.type){case"list":p=u["b"];break;case"boolean":p=u["j"];break;case"text":h["text"]="textarea";break}s&&(d.default=s[l]||d.default);var m=f(f({},d),{},{component:p,el:h});t[n].fields.push(l),t[n].fieldsMeta[l]=m}var b=this.preFieldsMeta[n];if(b)for(var v=0,g=Object.entries(b);v<g.length;v++)for(var y=Object(o["a"])(g[v],2),w=y[0],_=y[1],O=0,A=Object.entries(_);O<A.length;O++){var $=Object(o["a"])(A[O],2),j=$[0],C=$[1];t[n]["fieldsMeta"][w][j]=C}this.config.fields=e,this.config.fieldsMeta=t},onSetting:function(){this.isVisible=!0},onSubmit:function(e){this.$emit("input",e),this.isVisible=!1,this.$emit("update:visible",this.isVisible)},onDialogClose:function(){this.$emit("update:visible",this.isVisible)}}},h=p,m=(n("273b"),n("2877")),b=Object(m["a"])(h,a,s,!1,null,"2772642f",null);t["a"]=b.exports}}]);