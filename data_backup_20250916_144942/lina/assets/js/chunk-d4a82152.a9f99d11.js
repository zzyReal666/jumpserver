(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-d4a82152"],{"0218":function(e,t,a){"use strict";a.d(t,"c",(function(){return l})),a.d(t,"a",(function(){return r})),a.d(t,"d",(function(){return s})),a.d(t,"b",(function(){return o})),a.d(t,"f",(function(){return c})),a.d(t,"e",(function(){return u})),a.d(t,"g",(function(){return d}));var i=a("bd86"),n=a("0692"),l="pending",r="approved",s="rejected",o="closed",c=Object(i["a"])(Object(i["a"])(Object(i["a"])(Object(i["a"])({},l,{type:"success",title:n["a"].t("Pending")}),r,{type:"primary",title:n["a"].t("Approved")}),s,{type:"danger",title:n["a"].t("Rejected")}),o,{type:"info",title:n["a"].t("Closed")}),u=Object(i["a"])(Object(i["a"])(Object(i["a"])(Object(i["a"])({},l,{type:"success",title:n["a"].t("Pending")}),r,{type:"primary",title:n["a"].t("Approved")}),s,{type:"danger",title:n["a"].t("Rejected")}),o,{type:"warning",title:n["a"].t("StateClosed")}),d=[{value:"all",label:n["a"].t("All"),children:[{value:"connect",label:n["a"].t("Connect")},{value:"delete",label:n["a"].t("Delete")},{value:"share",label:n["a"].t("Share")},{value:"updownload",label:n["a"].t("UpDownload"),children:[{value:"upload",label:n["a"].t("Upload")},{value:"download",label:n["a"].t("Download")}]},{value:"copy_paste",label:n["a"].t("Clipboard"),children:[{value:"copy",label:n["a"].t("Copy")},{value:"paste",label:n["a"].t("Paste")}]}]}]},9595:function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("BaseTicketList",e._b({ref:"BaseTicketList",attrs:{url:e.url}},"BaseTicketList",e.$data,!1)),e._v(" "),e.isVisible?a("Dialog",{attrs:{"cancel-title":e.$tc("BatchReject"),"confirm-title":e.$tc("BatchConsent"),"destroy-on-close":!0,title:e.$tc("ApprovalSelected"),visible:e.isVisible,width:"70%"},on:{"update:visible":function(t){e.isVisible=t},cancel:e.onCancel,confirm:e.onConfirm}},e._l(e.ticketData,(function(t){return a("div",{key:t.id},[a("AutoDetailCard",{attrs:{fields:e.getDetailFields(t),object:t,title:t.title+"("+t.type.label+")",url:e.detailUrl}})],1)})),0):e._e()],1)},n=[],l=(a("1c01"),a("58b2"),a("8e6e"),a("f3e2"),a("d25f"),a("7f7f"),a("8615"),a("ac6a"),a("456d"),a("6d67"),a("bd86")),r=(a("d92a"),a("d75b")),s=a("2f62"),o=a("e3bc"),c=a("9039");function u(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,i)}return a}function d(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?u(Object(a),!0).forEach((function(t){Object(l["a"])(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):u(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var p={name:"AssignedTicketList",components:{Dialog:c["a"],AutoDetailCard:o["a"],BaseTicketList:r["a"]},data:function(){return{ticketData:[],detailUrl:"/api/v1/tickets/tickets/",isVisible:!1,extraTicketAction:{hasCreate:!1,hasMoreActions:!0,extraMoreActions:[{name:"ApproveSelected",title:this.$t("ApprovalSelected"),can:function(e){var t=e.selectedRows;return t.length>0},callback:function(e){var t=e.selectedRows;this.isVisible=!0,this.ticketData=t}.bind(this)}]}}},computed:d({url:function(){return"/api/v1/tickets/tickets/?assignees__id=".concat(this.currentUser.id,"&state=pending")}},Object(s["b"])(["currentUser"])),methods:{getAjaxData:function(){var e,t={};return this.ticketData.map((function(a){switch(a.type.value){case"apply_asset":e="apply-asset-tickets";break;case"login_confirm":e="apply-login-tickets";break;case"command_confirm":e="apply-command-tickets";break;case"login_asset_confirm":e="apply-login-asset-tickets";break}t.hasOwnProperty(e)||(t[e]=[]),t[e].push(a.id)})),t},onConfirm:function(){this.bulk("approve")},onCancel:function(){this.bulk("reject")},bulk:function(e){var t=this,a=0,i=this.getAjaxData(),n=Object.keys(i).length;for(var l in i)a+=1,this.$axios.put("/api/v1/tickets/".concat(l,"/bulk/?action=").concat(e),{tickets:i[l]}).then((function(e){t.$message.success(t.$tc("UpdateSuccessMsg")),a===n&&(t.$refs.BaseTicketList.reloadTable(),t.isVisible=!1)})).catch((function(e){var a=Object.values(e.response.data).join(", ");t.$message.error(t.$tc("UpdateErrorMsg")+" "+a)}))},getDetailFields:function(e){var t,a,i,n,l,r=null===e||void 0===e||null===(t=e.type)||void 0===t?void 0:t.value,s=[{key:this.$t("Applicant"),value:null===e||void 0===e||null===(a=e.applicant)||void 0===a?void 0:a.name}];if("command_confirm"===r)s=s.concat([{key:this.$t("ApplyFromCMDFilterRule"),value:null===e||void 0===e||null===(i=e.rel_snapshot)||void 0===i?void 0:i.apply_from_cmd_filter_acl},{key:this.$t("ApplyFromSession"),value:null===e||void 0===e||null===(n=e.rel_snapshot)||void 0===n?void 0:n.apply_from_session},{key:this.$t("ApplyRunUser"),value:null===e||void 0===e||null===(l=e.rel_snapshot)||void 0===l?void 0:l.apply_run_user}]);else if("apply_asset"===r){var o,c;s=s.concat([{key:this.$t("Asset"),value:null===e||void 0===e||null===(o=e.rel_snapshot)||void 0===o?void 0:o.apply_assets.join(", ")},{key:this.$t("Node"),value:null===e||void 0===e||null===(c=e.rel_snapshot)||void 0===c?void 0:c.apply_nodes.join(", ")}])}else if("login_asset_confirm"===r){var u,d;s=s.concat([{key:this.$t("ApplyLoginAsset"),value:null===e||void 0===e||null===(u=e.rel_snapshot)||void 0===u?void 0:u.apply_login_asset},{key:this.$t("ApplyLoginUser"),value:null===e||void 0===e||null===(d=e.rel_snapshot)||void 0===d?void 0:d.apply_login_user}])}return s}}},f=p,b=a("2877"),v=Object(b["a"])(f,i,n,!1,null,null,null);t["default"]=v.exports},d75b:function(e,t,a){"use strict";var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("GenericListPage",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:"ListPage",attrs:{"create-drawer":e.createDrawer,"detail-drawer":e.detailDrawer,"header-actions":e.iTicketAction,"table-config":e.ticketTableConfig}})},n=[],l=(a("7f7f"),a("bd86")),r=a("cd4a"),s=a("53f7"),o=a("3f95"),c=a("0218"),u={name:"TicketListTable",components:{GenericListPage:r["e"]},props:{url:{type:String,default:"/api/v1/tickets/tickets/"},extraTicketAction:{type:Object,default:function(){return{}}},extraQuery:{type:Object,default:function(){return{}}}},data:function(){var e=this,t=this;return{loading:!0,createDrawer:function(){return Promise.all([a.e("chunk-commons"),a.e("chunk-55b557da"),a.e("chunk-4367c372"),a.e("chunk-4f216562")]).then(a.bind(null,"3cae"))},detailDrawer:null,ticketTableConfig:{url:this.url,extraQuery:this.extraQuery,columnsExclude:["process_map","rel_snapshot"],columnsShow:{min:["title","serial_num","type","state","date_created"],default:["title","serial_num","type","state","date_created"]},columnsMeta:{serial_num:{label:this.$t("Number"),sortable:"custom"},title:{label:this.$t("Title"),formatter:s["i"],sortable:"custom",formatterArgs:{drawer:!0,getRoute:function(t){var a=t.row,i=a.type.value,n={apply_asset:"AssetsTicketDetail",login_asset_confirm:"LoginAssetTicketDetail",login_confirm:"LoginTicketDetail",command_confirm:"CommandConfirmDetail"};return e.$store.dispatch("common/setDrawerActionMeta",{action:"detail",row:{},col:{},id:a.id}),{name:n[i]||"TicketDetail",params:{id:a.id}}}}},applicant:{label:this.$t("Applicant"),sortable:"custom",formatter:function(e){return e["rel_snapshot"].applicant}},type:{label:this.$t("Type"),formatter:function(e){return e.type.label}},status:{align:"center",sortable:"custom",formatter:s["s"],formatterArgs:{getTagLabel:function(e){var t=e.row;return t.status.label},getTagType:function(e){var t=e.row;return"open"===t.status.value?"primary":"danger"}}},state:{label:this.$t("Action"),align:"center",sortable:"custom",formatter:s["s"],formatterArgs:{getTagType:function(e){var t=e.row,a=Object(l["a"])(Object(l["a"])(Object(l["a"])(Object(l["a"])({},c["c"],"success"),c["a"],"primary"),c["d"],"danger"),c["b"],"info");return a[t.state.value]||"warning"},getTagLabel:function(e){var a=e.row;return a.state.label||t.$t("Pending")}}},date_created:{label:this.$t("Date"),sortable:"custom",formatter:function(e){return Object(o["i"])(e.date_created)}},actions:{has:"AuditTicketList"!==this.$route.name}}},defaultTicketActions:{hasExport:!1,hasMoreActions:!1,hasLeftActions:!0,canCreate:this.$hasPerm("tickets.view_ticket"),hasBulkDelete:!1,searchConfig:{exclude:["id","title","type","applicant"],options:[{value:"id",label:"ID"},{value:"title",label:this.$t("Title")},{value:"type",label:this.$t("Type"),type:"choice",children:[{value:"apply_asset",label:this.$t("ApplyAsset")},{value:"login_confirm",label:this.$t("LoginConfirm")},{value:"command_confirm",label:this.$t("CommandConfirm")},{value:"login_asset_confirm",label:this.$t("LoginAssetConfirm")}]},{value:"applicant_username_name",label:this.$t("Applicant")},{value:"relevant_asset",label:this.$t("RelevantAsset")},{value:"relevant_system_user",label:this.$t("RelevantCommand")},{value:"relevant_command",label:this.$t("ApplyRunCommand")}]},moreCreates:{},createTitle:this.$t("RequestTickets")}}},computed:{iTicketAction:function(){return Object.assign({},this.defaultTicketActions,this.extraTicketAction)}},mounted:function(){var e=this;setTimeout((function(){e.loading=!1}),500)},methods:{reloadTable:function(){this.$refs.ListPage.$refs.ListTable.$refs.ListTable.reloadTable()}}},d=u,p=a("2877"),f=Object(p["a"])(d,i,n,!1,null,null,null);t["a"]=f.exports}}]);