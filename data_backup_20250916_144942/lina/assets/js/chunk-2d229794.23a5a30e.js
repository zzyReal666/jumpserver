(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d229794"],{de30:function(e,t,n){"use strict";n.r(t);var a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return e.loading?e._e():n("GenericCreateUpdatePage",e._b({attrs:{"after-get-form-value":e.afterGetFormValue}},"GenericCreateUpdatePage",e.$data,!1))},r=[],i=(n("96cf"),n("3b8d")),c=(n("6b54"),n("87b3"),n("7f7f"),n("5e04")),o=n("dbfd"),s={components:{GenericCreateUpdatePage:c["a"]},data:function(){var e=this,t=this;return{meta:{action:"create"},loading:!0,url:"/api/v1/authentication/ssh-key/",fields:["name","generate_key_type","current_public_key","public_key","is_active","comment"],fieldsMeta:{name:{},public_key:{label:this.$t("NewPublicKey"),el:{type:"textarea",placeholder:"ssh-rsa AAAA...",autosize:{minRows:3}},hidden:function(t){return"auto"===t.generate_key_type||!e.isCreateAction}},current_public_key:{hidden:function(){return e.isCreateAction},disabled:!0,label:this.$t("OldPublicKey")},generate_key_type:{helpTextAsTip:!1,hidden:function(){return!e.isCreateAction}}},onSubmit:function(e){var n,a=this,r=t.isCreateAction||"clone"===(null===(n=t.meta)||void 0===n?void 0:n.action);if("auto"===e["generate_key_type"]&&r){var i=e["name"],c=new URLSearchParams(e).toString();this.$axios.get("/core/auth/profile/pubkey/generate/?".concat(c)).then((function(e){t.createSuccessHandle(),Object(o["f"])(e,"".concat(i,".jumpserver.pem"))}))}else{var s=r?"post":"patch";delete e["generate_key_type"],this.$axios[s](this.iUrl,e).then((function(){t.createSuccessHandle()})).catch((function(e){return a.onPerformError(e,a.method,a)}))}}}},computed:{isCreateAction:function(){var e;return"create"===(null===(e=this.meta)||void 0===e?void 0:e.action)}},mounted:function(){var e=Object(i["a"])(regeneratorRuntime.mark((function e(){var t=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.$store.dispatch("common/getDrawerActionMeta");case 2:this.meta=e.sent,setTimeout((function(){t.loading=!1}));case 4:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),methods:{afterGetFormValue:function(e){var t=e["public_key_hash_md5"]?"".concat(e["public_key_comment"]," (").concat(e["public_key_hash_md5"],")"):" ";return e["current_public_key"]=t,e},createSuccessHandle:function(){this.$router.push({name:"SSHKeyList",query:{order:"-date_created",updated:(new Date).getTime()}}),this.$message.success(this.$tc("CreateSuccessMsg"))}}},u=s,l=n("2877"),d=Object(l["a"])(u,a,r,!1,null,null,null);t["default"]=d.exports}}]);