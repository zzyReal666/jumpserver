(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2bf609ba"],{1816:function(e,t,a){"use strict";(function(t){var o=a("440d"),n=a("9c59"),r=/^[\x00-\x20\u00a0\u1680\u2000-\u200a\u2028\u2029\u202f\u205f\u3000\ufeff]+/,s=/[\n\r\t]/g,l=/^[A-Za-z][A-Za-z0-9+-.]*:\/\//,i=/:\d+$/,c=/^([a-z][a-z0-9.+-]*:)?(\/\/)?([\\/]+)?([\S\s]*)/i,u=/^[a-zA-Z]:/;function p(e){return(e||"").toString().replace(r,"")}var f=[["#","hash"],["?","query"],function(e,t){return d(t.protocol)?e.replace(/\\/g,"/"):e},["/","pathname"],["@","auth",1],[NaN,"host",void 0,1,1],[/:(\d*)$/,"port",void 0,1],[NaN,"hostname",void 0,1,1]],h={hash:1,query:1};function m(e){var a;a="undefined"!==typeof window?window:"undefined"!==typeof t?t:"undefined"!==typeof self?self:{};var o=a.location||{};e=e||o;var n,r={},s=typeof e;if("blob:"===e.protocol)r=new g(unescape(e.pathname),{});else if("string"===s)for(n in r=new g(e,{}),h)delete r[n];else if("object"===s){for(n in e)n in h||(r[n]=e[n]);void 0===r.slashes&&(r.slashes=l.test(e.href))}return r}function d(e){return"file:"===e||"ftp:"===e||"http:"===e||"https:"===e||"ws:"===e||"wss:"===e}function v(e,t){e=p(e),e=e.replace(s,""),t=t||{};var a,o=c.exec(e),n=o[1]?o[1].toLowerCase():"",r=!!o[2],l=!!o[3],i=0;return r?l?(a=o[2]+o[3]+o[4],i=o[2].length+o[3].length):(a=o[2]+o[4],i=o[2].length):l?(a=o[3]+o[4],i=o[3].length):a=o[4],"file:"===n?i>=2&&(a=a.slice(2)):d(n)?a=o[4]:n?r&&(a=a.slice(2)):i>=2&&d(t.protocol)&&(a=o[4]),{protocol:n,slashes:r||d(n),slashesCount:i,rest:a}}function b(e,t){if(""===e)return t;var a=(t||"/").split("/").slice(0,-1).concat(e.split("/")),o=a.length,n=a[o-1],r=!1,s=0;while(o--)"."===a[o]?a.splice(o,1):".."===a[o]?(a.splice(o,1),s++):s&&(0===o&&(r=!0),a.splice(o,1),s--);return r&&a.unshift(""),"."!==n&&".."!==n||a.push(""),a.join("/")}function g(e,t,a){if(e=p(e),e=e.replace(s,""),!(this instanceof g))return new g(e,t,a);var r,l,i,c,h,y,C=f.slice(),w=typeof t,$=this,R=0;for("object"!==w&&"string"!==w&&(a=t,t=null),a&&"function"!==typeof a&&(a=n.parse),t=m(t),l=v(e||"",t),r=!l.protocol&&!l.slashes,$.slashes=l.slashes||r&&t.slashes,$.protocol=l.protocol||t.protocol||"",e=l.rest,("file:"===l.protocol&&(2!==l.slashesCount||u.test(e))||!l.slashes&&(l.protocol||l.slashesCount<2||!d($.protocol)))&&(C[3]=[/(.*)/,"pathname"]);R<C.length;R++)c=C[R],"function"!==typeof c?(i=c[0],y=c[1],i!==i?$[y]=e:"string"===typeof i?(h="@"===i?e.lastIndexOf(i):e.indexOf(i),~h&&("number"===typeof c[2]?($[y]=e.slice(0,h),e=e.slice(h+c[2])):($[y]=e.slice(h),e=e.slice(0,h)))):(h=i.exec(e))&&($[y]=h[1],e=e.slice(0,h.index)),$[y]=$[y]||r&&c[3]&&t[y]||"",c[4]&&($[y]=$[y].toLowerCase())):e=c(e,$);a&&($.query=a($.query)),r&&t.slashes&&"/"!==$.pathname.charAt(0)&&(""!==$.pathname||""!==t.pathname)&&($.pathname=b($.pathname,t.pathname)),"/"!==$.pathname.charAt(0)&&d($.protocol)&&($.pathname="/"+$.pathname),o($.port,$.protocol)||($.host=$.hostname,$.port=""),$.username=$.password="",$.auth&&(h=$.auth.indexOf(":"),~h?($.username=$.auth.slice(0,h),$.username=encodeURIComponent(decodeURIComponent($.username)),$.password=$.auth.slice(h+1),$.password=encodeURIComponent(decodeURIComponent($.password))):$.username=encodeURIComponent(decodeURIComponent($.auth)),$.auth=$.password?$.username+":"+$.password:$.username),$.origin="file:"!==$.protocol&&d($.protocol)&&$.host?$.protocol+"//"+$.host:"null",$.href=$.toString()}function y(e,t,a){var r=this;switch(e){case"query":"string"===typeof t&&t.length&&(t=(a||n.parse)(t)),r[e]=t;break;case"port":r[e]=t,o(t,r.protocol)?t&&(r.host=r.hostname+":"+t):(r.host=r.hostname,r[e]="");break;case"hostname":r[e]=t,r.port&&(t+=":"+r.port),r.host=t;break;case"host":r[e]=t,i.test(t)?(t=t.split(":"),r.port=t.pop(),r.hostname=t.join(":")):(r.hostname=t,r.port="");break;case"protocol":r.protocol=t.toLowerCase(),r.slashes=!a;break;case"pathname":case"hash":if(t){var s="pathname"===e?"/":"#";r[e]=t.charAt(0)!==s?s+t:t}else r[e]=t;break;case"username":case"password":r[e]=encodeURIComponent(t);break;case"auth":var l=t.indexOf(":");~l?(r.username=t.slice(0,l),r.username=encodeURIComponent(decodeURIComponent(r.username)),r.password=t.slice(l+1),r.password=encodeURIComponent(decodeURIComponent(r.password))):r.username=encodeURIComponent(decodeURIComponent(t))}for(var c=0;c<f.length;c++){var u=f[c];u[4]&&(r[u[1]]=r[u[1]].toLowerCase())}return r.auth=r.password?r.username+":"+r.password:r.username,r.origin="file:"!==r.protocol&&d(r.protocol)&&r.host?r.protocol+"//"+r.host:"null",r.href=r.toString(),r}function C(e){e&&"function"===typeof e||(e=n.stringify);var t,a=this,o=a.host,r=a.protocol;r&&":"!==r.charAt(r.length-1)&&(r+=":");var s=r+(a.protocol&&a.slashes||d(a.protocol)?"//":"");return a.username?(s+=a.username,a.password&&(s+=":"+a.password),s+="@"):a.password?(s+=":"+a.password,s+="@"):"file:"!==a.protocol&&d(a.protocol)&&!o&&"/"!==a.pathname&&(s+="@"),(":"===o[o.length-1]||i.test(a.hostname)&&!a.port)&&(o+=":"),s+=o+a.pathname,t="object"===typeof a.query?e(a.query):a.query,t&&(s+="?"!==t.charAt(0)?"?"+t:t),a.hash&&(s+=a.hash),s}g.prototype={set:y,toString:C},g.extractProtocol=v,g.location=m,g.trimLeft=p,g.qs=n,e.exports=g}).call(this,a("c8ba"))},"24b1":function(e,t,a){},"440d":function(e,t,a){"use strict";e.exports=function(e,t){if(t=t.split(":")[0],e=+e,!e)return!1;switch(t){case"http":case"ws":return 80!==e;case"https":case"wss":return 443!==e;case"ftp":return 21!==e;case"gopher":return 70!==e;case"file":return!1}return 0!==e}},"65a0":function(e,t,a){"use strict";a("24b1")},"9c59":function(e,t,a){"use strict";var o,n=Object.prototype.hasOwnProperty;function r(e){try{return decodeURIComponent(e.replace(/\+/g," "))}catch(t){return null}}function s(e){try{return encodeURIComponent(e)}catch(t){return null}}function l(e){var t,a=/([^=?#&]+)=?([^&]*)/g,o={};while(t=a.exec(e)){var n=r(t[1]),s=r(t[2]);null===n||null===s||n in o||(o[n]=s)}return o}function i(e,t){t=t||"";var a,r,l=[];for(r in"string"!==typeof t&&(t="?"),e)if(n.call(e,r)){if(a=e[r],a||null!==a&&a!==o&&!isNaN(a)||(a=""),r=s(r),a=s(a),null===r||null===a)continue;l.push(r+"="+a)}return l.length?t+l.join("&"):""}t.stringify=i,t.parse=l},a1ea:function(e,t,a){},ca8c:function(e,t,a){"use strict";a("a1ea")},fe8e:function(e,t,a){"use strict";a.r(t);var o=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("GenericCreateUpdatePage",e._b({},"GenericCreateUpdatePage",e.$data,!1))},n=[],r=a("cd4a"),s=a("5cba"),l=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("AttrInput",{staticClass:"attr-input",attrs:{"form-config":e.formConfig,"table-config":e.tableConfig},on:{submit:e.onSubmit}})},i=[],c=(a("57e7"),a("d25f"),a("f823")),u=(a("7f7f"),a("6d67"),a("2caf"),a("7514"),a("0692")),p=a("9a5c"),f=[{label:u["a"].t("Platform"),value:"platform"},{label:u["a"].t("Node"),value:"node"},{label:u["a"].t("Zone"),value:"zone"},{label:u["a"].t("AccountTemplate"),value:"account_template"},{label:u["a"].t("Tags"),value:"label"},{label:u["a"].t("Strategy"),value:"name_strategy"}],h=[{label:u["a"].t("InstanceName"),value:"instance_name"},{label:u["a"].t("InstancePlatformName"),value:"instance_platform"},{label:u["a"].t("InstanceAddress"),value:"instance_address"}],m=function(e,t){return function(a,o,n){var r,s,l={},i=n;if(null!==i&&void 0!==i&&i.label)return i.label;switch(e){case"attr":return(null===(r=h.find((function(e){return e.value===i})))||void 0===r?void 0:r.label)||i;case"resource_type":return(null===(s=f.find((function(e){return e.value===i})))||void 0===s?void 0:s.label)||i;case"match":return p["a"].find((function(e){return e.value===i})).label||i;case"value":return Array.isArray(i)?i.join(", "):i;case"resource":return"function"===typeof t&&Object.assign(l,t()),l[i]||i;case"protocols":return Array.isArray(i)?i.map((function(e){return"".concat(e.name,"/").concat(e.port)})).join(", "):"";case"count":return(null===i||void 0===i?void 0:i.length)||0;default:return i}}},d={name:"RuleInput",components:{AttrInput:c["a"]},props:{value:{type:Array,default:function(){return[]}}},data:function(){var e=this,t=this.$createElement;return{formConfig:{initial:{attr:"",match:"",value:""},inline:!0,hasSaveContinue:!1,submitBtnSize:"mini",submitBtnText:this.$t("Add"),hasReset:!1,onSubmit:function(){},submitMethod:function(){return"post"},getUrl:function(){return""},fields:[["",["attr","match","value"]]],fieldsMeta:{attr:{label:"",component:c["i"],rules:[s["d"]],el:{value:[],multiple:!1,clearable:!1,options:h}},match:{label:"",component:c["i"],rules:[s["d"]],el:{value:[],multiple:!1,clearable:!1,options:p["a"].filter((function(e){var t=p["f"].concat("exclude");if(-1!==t.indexOf(e.value)&&"in"!==e.value)return e}))}},value:{component:"el-input",rules:[s["d"]]}}},tableConfig:{columns:[{prop:"attr",label:this.$t("AttrName"),formatter:m("attr")},{prop:"match",label:this.$t("Match"),formatter:m("match")},{prop:"value",label:this.$t("AttrValue"),formatter:m("value")},{prop:"action",label:this.$t("Action"),align:"center",width:"100px",formatter:function(a,o,n,r){return t("div",{attrs:{className:"input-button"}},[t("el-button",{attrs:{icon:"el-icon-minus",size:"mini",type:"danger"},style:{flexShrink:0},on:{click:e.handleDelete(r)}})])}}],totalData:this.value||[],hasPagination:!1}}},methods:{onSubmit:function(){this.$emit("input",this.tableConfig.totalData)},handleDelete:function(e){var t=this;return function(){var a,o=t.tableConfig.totalData.splice(e,1);null!==(a=o[0])&&void 0!==a&&a.id&&t.$axios.delete("/api/v1/xpack/cloud/strategy-rules/".concat(o[0].id,"/")),t.$message.success(t.$tc("DeleteSuccessMsg"))}}}},v=d,b=(a("ca8c"),a("2877")),g=Object(b["a"])(v,l,i,!1,null,"b791a522",null),y=g.exports,C=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("AttrInput",{staticClass:"action-input",attrs:{"before-submit":e.beforeSubmit,"form-config":e.formConfig,"table-config":e.tableConfig},on:{submit:e.onSubmit}})},w=[],$=(a("ac6a"),a("456d"),a("768b")),R=a("1939"),x={name:"ActionInput",components:{AttrInput:c["a"]},props:{value:{type:Array,default:function(){return[]}}},data:function(){var e=this,t=this.$createElement;return{resourceType:"",globalResource:{},globalProtocols:{},nameOptions:[{label:this.$t("InstanceName"),value:"full_name"},{label:this.$t("InstanceNamePartIp"),value:"part_name"}],formConfig:{initial:{attr:"",value:""},inline:!0,hasSaveContinue:!1,submitBtnSize:"mini",submitBtnText:this.$t("Add"),hasReset:!1,onSubmit:function(){},submitMethod:function(){return"post"},getUrl:function(){return""},cleanFormValue:function(e){return"platform"!==(null===e||void 0===e?void 0:e.attr)&&delete e.protocols,e},fields:[["",["attr","value","protocols"]]],fieldsMeta:{attr:{label:"",component:c["i"],rules:[s["d"]],el:{url:"",clearable:!1,multiple:!1,options:f},on:{change:function(t,a){var o=Object($["a"])(t,1),n=o[0];a({value:""});var r="",s=[];switch(n){case"platform":var l=e.$route.query.category||"host";r="/api/v1/assets/platforms/?category=".concat(l);break;case"node":r="/api/v1/assets/nodes/";break;case"zone":r="/api/v1/assets/zones/";break;case"account_template":r="/api/v1/accounts/account-templates/";break;case"label":r="/api/v1/labels/labels/";break;case"name_strategy":s=e.nameOptions;break}"platform"!==n&&(e.formConfig.fieldsMeta.protocols.el.hidden=!0),e.resourceType=n,r?e.formConfig.fieldsMeta.value.el.ajax.url=r:e.formConfig.fieldsMeta.attr.el.remote=!1,e.formConfig.fieldsMeta.value.el.options=s}}},value:{label:"",component:c["i"],rules:[s["d"]],el:{options:[],value:[],ajax:{url:"/api/v1/assets/platforms/",transformOption:function(t){var a;switch(e.resourceType){case"platform":a=null===t||void 0===t?void 0:t.name,e.globalProtocols[t.id]=t.protocols,e.globalResource[t.id]=a;break;case"account_template":a="".concat(t.name,"(").concat(t.username,")"),e.globalResource[t.id]=a;break;case"node":a=null===t||void 0===t?void 0:t.full_value,e.globalResource[t.id]=a;break;case"label":a="".concat(t.name,":").concat(t.value),e.globalResource[t.id]=a;break;default:a=null===t||void 0===t?void 0:t.name,e.globalResource[t.id]=a}return{label:a,value:t.id}}},multiple:!1},on:{change:function(t,a){var o=Object($["a"])(t,1),n=o[0];"platform"===e.resourceType?(e.formConfig.fieldsMeta.protocols.el.choices=e.globalProtocols[n]||[],e.formConfig.fieldsMeta.protocols.el.hidden=!1):e.formConfig.fieldsMeta.protocols.el.hidden=!0}}},protocols:{label:"",component:R["a"],el:{hidden:!0,settingReadonly:!0,showSetting:function(){return!1},choices:[]}}}},tableConfig:{columns:[{prop:"attr",label:this.$t("ResourceType"),formatter:m("resource_type")},{prop:"value",label:this.$t("Resource"),formatter:m("resource",(function(){return e.globalResource}))},{prop:"protocols",label:this.$t("Other"),formatter:m("protocols")},{prop:"action",label:this.$t("Action"),align:"center",width:"100px",formatter:function(a,o,n,r){return t("div",{attrs:{className:"input-button"}},[t("el-button",{attrs:{icon:"el-icon-minus",size:"mini",type:"danger"},style:{flexShrink:0},on:{click:e.handleDelete(r)}})])}}],totalData:this.value||[],hasPagination:!1}}},created:function(){this.init()},methods:{init:function(){var e=this;this.nameOptions.map((function(t){e.globalResource[t.value]=t.label}))},onSubmit:function(){this.$emit("input",this.tableConfig.totalData)},beforeSubmit:function(e){var t=this,a=!0,o={platform:this.$tc("Platform"),zone:this.$tc("Zone"),name_strategy:this.$tc("Strategy")};return this.tableConfig.totalData.map((function(n){var r,s,l=(null===(r=n.value)||void 0===r?void 0:r.id)||n.value,i=(null===(s=n.attr)||void 0===s?void 0:s.value)||n.attr;l===e.value?(a=!1,t.$message.error("".concat(t.$tc("ExistError")))):-1!==Object.keys(o).indexOf(null===e||void 0===e?void 0:e.attr)&&i===e.attr&&(a=!1,t.$message.error("".concat(t.$tc("UniqueError"),": ").concat(o[e.attr])))})),a},handleDelete:function(e){var t=this;return function(){var a,o=t.tableConfig.totalData.splice(e,1);null!==(a=o[0])&&void 0!==a&&a.id&&t.$axios.delete("/api/v1/xpack/cloud/strategy-actions/".concat(o[0].id,"/")),t.$message.success(t.$tc("DeleteSuccessMsg"))}}}},A=x,S=(a("65a0"),Object(b["a"])(A,C,w,!1,null,"19ed2677",null)),k=S.exports,I={components:{GenericCreateUpdatePage:r["c"]},data:function(){var e=this;return{url:"/api/v1/xpack/cloud/strategies/",fields:[[this.$t("Basic"),["name","priority"]],[this.$t("RuleSetting"),["rule_relation","strategy_rules"]],[this.$t("ActionSetting"),["strategy_actions"]],[this.$t("Other"),["comment"]]],fieldsMeta:{name:{rules:[s["e"],s["g"]]},rule_relation:{label:this.$t("RuleRelation"),helpTip:this.$t("RuleRelationHelpTip")},strategy_rules:{component:y},strategy_actions:{component:k}},updateSuccessNextRoute:{name:"CloudAccountList",params:{activeMenu:"StrategyList"}},createSuccessNextRoute:{name:"CloudAccountList",params:{activeMenu:"StrategyList"}},cleanFormValue:function(t){return t["category"]=e.$route.query.category||"host",t},getUrl:function(){var e,t=null===(e=this.$route.params)||void 0===e?void 0:e.id;return t?"".concat(this.url).concat(t,"/"):this.url}}},methods:{}},_=I,U=Object(b["a"])(_,o,n,!1,null,"38efa95e",null);t["default"]=U.exports}}]);