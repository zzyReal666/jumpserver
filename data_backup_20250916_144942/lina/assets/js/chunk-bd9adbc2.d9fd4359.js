(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-bd9adbc2","chunk-52829884","chunk-58e2a36e"],{"0482":function(t,e,n){},"273b":function(t,e,n){"use strict";n("0482")},"3cc2":function(t,e,n){},7:function(t,e){},b662:function(t,e,n){"use strict";n.r(e);var i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("GenericDetailPage",t._b({attrs:{"active-menu":t.config.activeMenu,object:t.sessionData},on:{"update:activeMenu":function(e){return t.$set(t.config,"activeMenu",e)},"update:active-menu":function(e){return t.$set(t.config,"activeMenu",e)},"update:object":function(e){t.sessionData=e}}},"GenericDetailPage",t.config,!1),[n("keep-alive",[n(t.config.activeMenu,{tag:"component",attrs:{object:t.sessionData}})],1)],1)},s=[],a=n("cd4a"),o=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("ListTable",{attrs:{"header-actions":t.headerActions,"table-config":t.tableConfig}})},r=[],c=(n("96cf"),n("3b8d")),l=n("af7d"),u=n("d58a"),d=n("3f95"),f={name:"SessionCommands",components:{ListTable:l["a"]},data:function(){return{tableConfig:{hasSelection:!1,url:"/api/v1/terminal/commands/?session_id=".concat(this.$route.params.id),columns:["expandCol","index","input","timestamp"],columnsMeta:{expandCol:{type:"expand",formatter:u["a"]},index:{type:"index",label:"ID",sortable:"custom"},input:{label:this.$t("Command"),sortable:"custom"},timestamp:{width:"160px",sortable:"custom",formatter:function(t){return Object(d["i"])(1e3*t.timestamp)}},actions:{has:!1}}},headerActions:{hasExport:!1,hasImport:!1,hasRefresh:!1,hasCreate:!1,hasBulkDelete:!1,hasBulkUpdate:!1,hasLeftActions:!1,hasSearch:!1,hasRightActions:!1}}},mounted:function(){var t=Object(c["a"])(regeneratorRuntime.mark((function t(){var e;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,this.$store.dispatch("common/getDrawerActionMeta");case 2:e=t.sent,e&&e.id&&(this.tableConfig.url="/api/v1/terminal/commands/?session_id=".concat(e.id));case 4:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}()},p=f,h=n("2877"),m=Object(h["a"])(p,o,r,!1,null,null,null),b=m.exports,g=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("TwoCol",{scopedSlots:t._u([{key:"right",fn:function(){return[t.object?n("QuickActions",{attrs:{actions:t.quickActions,type:"primary"}}):t._e()]},proxy:!0}])},[[t.object?n("DetailCard",{attrs:{items:t.detailItems}}):t._e()]],2)},v=[],w=n("30f4"),y=n("2af9"),_=n("d952"),x=n("52cc"),j={name:"SessionDetailInfo",components:{TwoCol:x["a"],DetailCard:w["a"],QuickActions:y["o"]},props:{object:{type:Object,default:null}},data:function(){return{session:this.object}},computed:{onlineSessionActions:function(){var t=this;return[{title:this.$t("SessionTerminate"),attrs:{type:"danger",label:this.$t("Terminate"),disabled:!this.session["can_terminate"]||!t.$hasPerm("terminal.terminate_session")},callbacks:{click:function(){Object(_["g"])(t.session.id).then((function(e){var n=t.$t("TerminateTaskSendSuccessMsg");t.$message.success(n),window.setTimeout((function(){window.location.reload()}),5e4)}))}}},{title:this.$t("SessionMonitor"),attrs:{type:"primary",label:this.$t("Monitor"),disabled:!this.session["can_join"]||!t.$hasPerm("terminal.monitor_session")||"sftp"===t.session.type.value},callbacks:{click:function(){var e="/luna/monitor/"+t.session.id;window.open(e,"height=600, width=800, top=400, left=400, toolbar=no, menubar=no, scrollbars=no, location=no, status=no")}}}]},offlineSessionActions:function(){var t=this;return[{title:this.$t("ReplaySession"),attrs:{type:"primary",label:this.$t("Replay"),disabled:!this.session["can_replay"]||!t.$hasPerm("terminal.view_sessionreplay")},callbacks:{click:function(){var e="/luna/replay/"+t.session.id;window.open(e)}}},{title:this.$t("DownloadReplay"),attrs:{type:"primary",label:this.$t("Download"),disabled:!this.session["can_replay"]||!t.$hasPerm("terminal.download_sessionreplay")},callbacks:{click:function(){var e=t.session.org_id||"",n="/api/v1/terminal/sessions/".concat(t.session.id,"/replay/download/").concat(e?"?oid="+e:"");window.open(n)}}}]},detailItems:function(){var t;return[{key:this.$t("User"),value:this.session.user},{key:this.$t("Host"),value:this.session.asset},{key:this.$t("Account"),value:this.session.account},{key:this.$t("Protocol"),value:this.session.protocol},{key:this.$t("LoginFrom"),value:(null===(t=this.session.login_from)||void 0===t?void 0:t.label)||"-"},{key:this.$t("RemoteAddr"),value:this.session.remote_addr},{key:this.$t("DateStart"),value:Object(d["i"])(this.session.date_start)},{key:this.$t("DateEnd"),value:this.session.date_end?Object(d["i"])(this.session.date_end):""}]},quickActions:function(){var t=this;return t.session.is_finished?this.offlineSessionActions:this.onlineSessionActions}}},$=j,O=Object(h["a"])($,g,v,!1,null,"80d190de",null),S=O.exports,k=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("ListTable",{attrs:{"header-actions":t.headerActions,"table-config":t.tableConfig}})},D=[],A={name:"SessionJoinRecords",components:{ListTable:l["a"]},props:{object:{type:Object,required:!0}},data:function(){return{tableConfig:{url:"/api/v1/terminal/session-join-records/?session=".concat(this.object.id),columns:["joiner_display","reason","is_success","is_finished","date_joined","date_left","org_name","action_permission"],columnsShow:{min:["joiner_display","is_success","reason"],default:["joiner_display","verify_code","is_success","reason","is_finished","date_joined","date_left"]},columnsMeta:{is_success:{width:"150px"},is_finished:{width:"150px",formatterArgs:{showFalse:!1}}}},headerActions:{hasImport:!1,hasLeftActions:!1,searchConfig:{exclude:["date_joined","date_left"]}}}}},C=A,T=Object(h["a"])(C,k,D,!1,null,"9f7248f0",null),E=T.exports,M=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("ListTable",{attrs:{"header-actions":t.headerActions,"table-config":t.tableConfig}})},P=[],R=n("dbfd"),F={name:"SessionFTPLogs",components:{ListTable:l["a"]},data:function(){var t=this;return{tableConfig:{hasSelection:!1,url:"/api/v1/audits/ftp-logs/?session=".concat(this.$route.params.id),columnsShow:{default:["id","user","remote_addr","asset","account","operate","filename","date_start","is_success","actions"]},columnsMeta:{remote_addr:{width:"140px"},operate:{width:"100px"},is_success:{width:"100px"},actions:{width:"82px",formatterArgs:{hasUpdate:!1,hasDelete:!1,hasClone:!1,extraActions:[{name:"download",title:this.$t("Download"),type:"primary",can:function(t){var e=t.row;return e.has_file},tip:function(e){var n=e.row;return n.has_file?t.$t("Download"):t.$t(".DownloadFTPFileTip")},callback:function(t){var e=t.row;Object(R["e"])("/api/v1/audits/ftp-logs/".concat(e.id,"/file/download/"))}}]}}}},headerActions:{hasExport:!1,hasImport:!1,hasRefresh:!1,hasCreate:!1,hasBulkDelete:!1,hasBulkUpdate:!1,hasLeftActions:!1,hasSearch:!1,hasRightActions:!1}}},mounted:function(){var t=Object(c["a"])(regeneratorRuntime.mark((function t(){var e;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,this.$store.dispatch("common/getDrawerActionMeta");case 2:e=t.sent,e&&e.id&&(this.tableConfig.url="/api/v1/audits/ftp-logs/?session=".concat(e.id));case 4:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}()},L=F,I=Object(h["a"])(L,M,P,!1,null,null,null),U=I.exports,B={name:"SessionDetail",components:{GenericDetailPage:a["d"],SessionCommands:b,SessionDetailInfo:S,SessionJoinRecords:E,SessionFTPLogs:U},data:function(){var t=this;return{sessionData:{},config:{url:"/api/v1/terminal/sessions",activeMenu:"SessionDetailInfo",submenu:[{title:this.$t("Basic"),name:"SessionDetailInfo"},{title:this.$t("Command"),name:"SessionCommands",hidden:function(){return!t.$hasPerm("terminal.view_command")}},{title:this.$t("SessionJoinRecords"),name:"SessionJoinRecords",hidden:function(){return!t.$hasPerm("terminal.view_sessionjoinrecord")}},{title:this.$t("FileTransfer"),name:"SessionFTPLogs",hidden:function(){return!t.$hasPerm("audits.view_ftplog")}}],getObjectName:function(t){return t.id},hasActivity:!0,hasRightSide:!1}}},methods:{}},V=B,J=Object(h["a"])(V,i,s,!1,null,null,null);e["default"]=J.exports},b708:function(t,e,n){},bd11:function(t,e){t.exports=g,t.exports.match=r,t.exports.regexpToFunction=c,t.exports.parse=s,t.exports.compile=o,t.exports.tokensToFunction=l,t.exports.tokensToRegExp=b;var n="/",i=new RegExp(["(\\\\.)","(?:\\:(\\w+)(?:\\(((?:\\\\.|[^\\\\()])+)\\))?|\\(((?:\\\\.|[^\\\\()])+)\\))([+*?])?"].join("|"),"g");function s(t,e){var s,o=[],r=0,c=0,l="",u=e&&e.delimiter||n,f=e&&e.whitelist||void 0,p=!1;while(null!==(s=i.exec(t))){var h=s[0],m=s[1],b=s.index;if(l+=t.slice(c,b),c=b+h.length,m)l+=m[1],p=!0;else{var g="",v=s[2],w=s[3],y=s[4],_=s[5];if(!p&&l.length){var x=l.length-1,j=l[x],$=!f||f.indexOf(j)>-1;$&&(g=j,l=l.slice(0,x))}l&&(o.push(l),l="",p=!1);var O="+"===_||"*"===_,S="?"===_||"*"===_,k=w||y,D=g||u,A=g||("string"===typeof o[o.length-1]?o[o.length-1]:"");o.push({name:v||r++,prefix:g,delimiter:D,optional:S,repeat:O,pattern:k?d(k):a(D,u,A)})}}return(l||c<t.length)&&o.push(l+t.substr(c)),o}function a(t,e,n){var i="[^"+u(t===e?t:t+e)+"]";return!n||n.indexOf(t)>-1||n.indexOf(e)>-1?i+"+?":u(n)+"|(?:(?!"+u(n)+")"+i+")+?"}function o(t,e){return l(s(t,e),e)}function r(t,e){var n=[],i=g(t,n,e);return c(i,n)}function c(t,e){return function(n,i){var s=t.exec(n);if(!s)return!1;for(var a=s[0],o=s.index,r={},c=i&&i.decode||decodeURIComponent,l=1;l<s.length;l++)if(void 0!==s[l]){var u=e[l-1];u.repeat?r[u.name]=s[l].split(u.delimiter).map((function(t){return c(t,u)})):r[u.name]=c(s[l],u)}return{path:a,index:o,params:r}}}function l(t,e){for(var n=new Array(t.length),i=0;i<t.length;i++)"object"===typeof t[i]&&(n[i]=new RegExp("^(?:"+t[i].pattern+")$",f(e)));return function(e,i){for(var s="",a=i&&i.encode||encodeURIComponent,o=!i||!1!==i.validate,r=0;r<t.length;r++){var c=t[r];if("string"!==typeof c){var l,u=e?e[c.name]:void 0;if(Array.isArray(u)){if(!c.repeat)throw new TypeError('Expected "'+c.name+'" to not repeat, but got array');if(0===u.length){if(c.optional)continue;throw new TypeError('Expected "'+c.name+'" to not be empty')}for(var d=0;d<u.length;d++){if(l=a(u[d],c),o&&!n[r].test(l))throw new TypeError('Expected all "'+c.name+'" to match "'+c.pattern+'"');s+=(0===d?c.prefix:c.delimiter)+l}}else if("string"!==typeof u&&"number"!==typeof u&&"boolean"!==typeof u){if(!c.optional)throw new TypeError('Expected "'+c.name+'" to be '+(c.repeat?"an array":"a string"))}else{if(l=a(String(u),c),o&&!n[r].test(l))throw new TypeError('Expected "'+c.name+'" to match "'+c.pattern+'", but got "'+l+'"');s+=c.prefix+l}}else s+=c}return s}}function u(t){return t.replace(/([.+*?=^!:${}()[\]|/\\])/g,"\\$1")}function d(t){return t.replace(/([=!:$/()])/g,"\\$1")}function f(t){return t&&t.sensitive?"":"i"}function p(t,e){if(!e)return t;var n=t.source.match(/\((?!\?)/g);if(n)for(var i=0;i<n.length;i++)e.push({name:i,prefix:null,delimiter:null,optional:!1,repeat:!1,pattern:null});return t}function h(t,e,n){for(var i=[],s=0;s<t.length;s++)i.push(g(t[s],e,n).source);return new RegExp("(?:"+i.join("|")+")",f(n))}function m(t,e,n){return b(s(t,n),e,n)}function b(t,e,i){i=i||{};for(var s=i.strict,a=!1!==i.start,o=!1!==i.end,r=i.delimiter||n,c=[].concat(i.endsWith||[]).map(u).concat("$").join("|"),l=a?"^":"",d=0;d<t.length;d++){var p=t[d];if("string"===typeof p)l+=u(p);else{var h=p.repeat?"(?:"+p.pattern+")(?:"+u(p.delimiter)+"(?:"+p.pattern+"))*":p.pattern;e&&e.push(p),p.optional?p.prefix?l+="(?:"+u(p.prefix)+"("+h+"))?":l+="("+h+")?":l+=u(p.prefix)+"("+h+")"}}if(o)s||(l+="(?:"+u(r)+")?"),l+="$"===c?"$":"(?="+c+")";else{var m=t[t.length-1],b="string"===typeof m?m[m.length-1]===r:void 0===m;s||(l+="(?:"+u(r)+"(?="+c+"))?"),b||(l+="(?="+u(r)+"|"+c+")")}return new RegExp(l,f(i))}function g(t,e,n){return t instanceof RegExp?p(t,e):Array.isArray(t)?h(t,e,n):m(t,e,n)}},c0eb:function(t,e,n){"use strict";var i=n("c5ec"),s=n.n(i);window.$=s.a,window.jQuery=s.a,e["a"]=s.a},d58a:function(t,e,n){"use strict";var i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("pre",{staticStyle:{border:"none",background:"none","white-space":"pre-wrap","word-wrap":"break-word",padding:"10px 20px"}},[t._v(t._s("$ "+t.row.input)+"\n"),n("br"),t._v("\n"+t._s(t.row.output)+"\n  ")])},s=[],a=n("73c8"),o={name:"OutputExpandFormatter",extends:a["a"]},r=o,c=n("2877"),l=Object(c["a"])(r,i,s,!1,null,"55cdfbb2",null),u=l.exports;n.d(e,"a",(function(){return u}))},d952:function(t,e,n){"use strict";n.d(e,"g",(function(){return s})),n.d(e,"h",(function(){return a})),n.d(e,"e",(function(){return o})),n.d(e,"f",(function(){return r})),n.d(e,"c",(function(){return c})),n.d(e,"d",(function(){return l})),n.d(e,"a",(function(){return d})),n.d(e,"b",(function(){return f}));var i=n("b775");function s(t){return Object(i["c"])({url:"/api/v1/terminal/tasks/kill-session/",method:"post",data:t})}function a(t){return Object(i["c"])({url:"/api/v1/terminal/tasks/toggle-lock-session/",method:"post",data:t})}function o(){return Object(i["c"])({url:"/api/v1/terminal/command-storages/",method:"get"})}function r(){return Object(i["c"])({url:"/api/v1/terminal/replay-storages/",method:"get"})}function c(t){return Object(i["c"])({url:"/api/v1/terminal/command-storages/".concat(t,"/test-connective/"),method:"get"})}function l(t){return Object(i["c"])({url:"/api/v1/terminal/replay-storages/".concat(t,"/test-connective/"),method:"get"})}function u(t){return Object(i["c"])({url:t,method:"patch",data:{is_default:!0}})}function d(t){return u("/api/v1/terminal/command-storages/".concat(t,"/"))}function f(t){return u("/api/v1/terminal/replay-storages/".concat(t,"/"))}},e323:function(t,e,n){"use strict";var i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"content"},[t.hasButton?n("el-button",{staticClass:"proto-setting",attrs:{disabled:!t.canSetting,icon:t.icon,size:"small",type:"primary"},on:{click:t.onSetting}}):t._e(),t._v(" "),n("Dialog",{attrs:{"show-cancel":!1,"show-confirm":!1,title:t.title,visible:t.isVisible,width:"60%"},on:{"update:visible":function(e){t.isVisible=e},close:t.onDialogClose}},[n("AutoDataForm",t._g(t._b({ref:"autoDataForm",staticClass:"data-form",attrs:{form:t.form},on:{submit:t.onSubmit}},"AutoDataForm",t.config,!1),t.$listeners))],1)],1)},s=[],a=(n("1c01"),n("58b2"),n("8e6e"),n("f3e2"),n("d25f"),n("bd86")),o=n("768b"),r=(n("ffc1"),n("6762"),n("2fdb"),n("ac6a"),n("456d"),n("96cf"),n("3b8d")),c=n("9039"),l=n("c75f"),u=n("f823");function d(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,i)}return n}function f(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?d(Object(n),!0).forEach((function(e){Object(a["a"])(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):d(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var p={components:{Dialog:c["a"],AutoDataForm:l["a"]},props:{value:{type:[String,Object],default:function(){return{}}},title:{type:String,default:function(){return this.$t("PushParams")}},btnText:{type:String,default:function(){return""}},icon:{type:String,default:"el-icon-setting"},url:{type:String,default:"/api/v1/assets/platform-automation-methods/"},method:{type:String,default:""},pushAccountParams:{type:Object,default:function(){return{}}},visible:{type:Boolean,default:!1},hasButton:{type:Boolean,default:!0}},data:function(){return{isVisible:this.visible,canSetting:!0,form:this.value,remoteMeta:{},config:{url:this.url,hasSaveContinue:!1,hasButtons:!0,hasReset:!1,fields:[],method:"get"},preFieldsMeta:{change_secret_by_ssh:{commands:{helpTextAsTip:!1}}}}},watch:{visible:function(t){this.isVisible=t},method:function(t,e){t!==e&&this.getUrlMeta()}},mounted:function(){this.getUrlMeta()},methods:{getUrlMeta:function(){var t=Object(r["a"])(regeneratorRuntime.mark((function t(){var e;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,this.$store.dispatch("common/getUrlMeta",{url:this.url});case 2:e=t.sent,this.remoteMeta=e.actions[this.config.method.toUpperCase()]||{},this.onCanSetting()&&this.setFormConfig();case 5:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),onCanSetting:function(){var t=Object.keys(this.remoteMeta);return this.canSetting=t.includes(this.method)&&this.$hasPerm("assets.change_platform"),this.$emit("canSetting",this.canSetting),this.canSetting},setFormConfig:function(){var t=[],e={},n=this.method,i=this.remoteMeta[n];t=[[i.label,[n]]],e[n]={fields:[],fieldsMeta:{}};var s=this.pushAccountParams[n];if(Object.keys((null===i||void 0===i?void 0:i.children)||{}).length>0)for(var a=0,r=Object.entries(i.children);a<r.length;a++){var c=Object(o["a"])(r[a],2),l=c[0],d=c[1],p="el-input",h={};switch(null===d||void 0===d?void 0:d.type){case"list":p=u["b"];break;case"boolean":p=u["j"];break;case"text":h["text"]="textarea";break}s&&(d.default=s[l]||d.default);var m=f(f({},d),{},{component:p,el:h});e[n].fields.push(l),e[n].fieldsMeta[l]=m}var b=this.preFieldsMeta[n];if(b)for(var g=0,v=Object.entries(b);g<v.length;g++)for(var w=Object(o["a"])(v[g],2),y=w[0],_=w[1],x=0,j=Object.entries(_);x<j.length;x++){var $=Object(o["a"])(j[x],2),O=$[0],S=$[1];e[n]["fieldsMeta"][y][O]=S}this.config.fields=t,this.config.fieldsMeta=e},onSetting:function(){this.isVisible=!0},onSubmit:function(t){this.$emit("input",t),this.isVisible=!1,this.$emit("update:visible",this.isVisible)},onDialogClose:function(){this.$emit("update:visible",this.isVisible)}}},h=p,m=(n("273b"),n("2877")),b=Object(m["a"])(h,i,s,!1,null,"2772642f",null);e["a"]=b.exports}}]);